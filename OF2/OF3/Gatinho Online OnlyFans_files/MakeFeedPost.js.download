(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["MakeFeedPost"],{"052a":function(e,t,i){"use strict";i("6762"),i("2fdb");t["a"]={methods:{closePipVideo:function(e){try{if(!document.pictureInPictureElement||!document.exitPictureInPicture||!e||!document.pictureInPictureElement.id.includes(e.id))return;document.pictureInPictureElement.pause&&document.pictureInPictureElement.pause(),document.exitPictureInPicture()}catch(t){}}}}},"23ad":function(e,t,i){!function(t,i){e.exports=i()}(0,(function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(t,i,s){var o=i.prototype,a=o.format;s.en.formats=e,o.format=function(t){void 0===t&&(t="YYYY-MM-DDTHH:mm:ssZ");var i=this.$locale().formats,s=function(t,i){return t.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,s,o){var a=o&&o.toUpperCase();return s||i[o]||e[o]||i[a].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,i){return t||i.slice(1)}))}))}(t,void 0===i?{}:i);return a.call(this,s)}}}))},"31b5":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"add-to-labels-btns"},[i("button",{staticClass:"g-btn m-add-to-lists labels m-default-font-weight m-no-uppercase m-reset-width",attrs:{type:"button","at-attr":"add_to_label",disabled:e.shouldNotBeEdit},on:{click:e.openPostsLabelsModal}},[i("span",{staticClass:"m-add-to-labels-icon m-with-round-hover m-size-sm-hover"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-post-cat"})])]),i("swiper",{ref:"swiper",staticClass:"m-slide-width-auto m-reset-center m-slide-flex-align",class:e.isPostCreateOrEditMode?"swiper-add-to-labels-container":"",attrs:{options:e.swiperOptions}},[i("swiper-slide",[i("button",{staticClass:"g-btn m-add-to-lists m-default-font-weight m-no-uppercase m-reset-width",class:{"m-gray-color":!e.isPostCreateOrEditMode},attrs:{type:"button","at-attr":"add_to_label",disabled:e.shouldNotBeEdit},on:{click:e.openPostsLabelsModal}},[i("span",{staticClass:"m-add-to-lists-text"},[e._v(" "+e._s(e.addedLabels.length?e.$t("message.add_label_not_empty_labels"):e.$t("message.add_label_empty_labels"))+" ")])])]),e._l(e.addedLabels,(function(t){return i("swiper-slide",{key:t.id},[i("router-link",{staticClass:"g-btn m-add-to-lists m-default-font-weight m-no-uppercase m-reset-width",class:{"m-gray-color":!e.isPostCreateOrEditMode},attrs:{to:e.labelRoute(t),disabled:e.shouldNotBeEdit}},[i("span",{staticClass:"m-add-to-lists-text"},[e._v(" "+e._s(e._f("encodeHtml")(t.name))+" ")])])],1)}))],2)],1)},o=[],a=(i("8e6e"),i("ac6a"),i("456d"),i("75fc")),r=(i("7514"),i("6762"),i("2fdb"),i("bd86")),n=(i("c5f6"),i("2ef0")),d=i("d634"),c=i("4ead");function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach((function(t){Object(r["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var h={name:"AddToLabelsBtns",mixins:[c["a"]],props:{post:{type:Object,required:!0},needUpdateSwiper:{type:Number,default:0},createPostMode:{type:Boolean,default:!1},editPostMode:{type:Boolean,default:!1},toggleLabelFunc:{type:Function,default:null},draftPostLabels:{type:Array,default:function(){return[]}}},data:function(){return{swiperOptions:{slidesPerView:"auto",watchOverflow:!0,spaceBetween:0,slideToClickedSlide:!0,threshold:5,mousewheel:!0},createPostLabels:[],editPostLabels:!1,draftLabelsMerged:!1}},computed:u(u(u({},Object(d["fb"])(["getPostLabel"])),Object(d["hb"])(["postLabelsIds"])),{},{addedLabels:function(){var e=this;return this.createPostMode?this.draftPostLabels&&this.draftPostLabels.length&&!this.draftLabelsMerged?this.draftPostLabels.map((function(t){return e.getPostLabel(t)})).filter((function(t){return!!t&&e.postLabelsIds.indexOf(t.id)>-1})):this.createPostLabels:this.editPostMode?this.editPostLabels||this.post.labelStates:this.post&&this.post.labelStates?this.post.labelStates:[]},shouldNotBeEdit:function(){return["MyQueue","SavedForLater"].includes(this.$route.name)},mode:function(){return this.createPostMode?"create":this.editPostMode?"edit":"default"},isPostCreateOrEditMode:function(){return["create","edit"].includes(this.mode)},swiper:function(){return Object(n["get"])(this,"$refs.swiper.$swiper")||null}}),watch:{draftPostLabels:{immediate:!0,handler:function(e,t){this.createPostMode&&!e.length&&t&&(this.createPostLabels=[])}}},methods:u(u({},Object(d["yc"])(["setModalUser"])),{},{openPostsLabelsModal:function(){var e=this;this.$nextTick((function(){e.$root.$emit("showAddLabelsToPostModal",{postId:e.post.id,addedLabels:e.addedLabels,mode:e.mode,toggleCallBack:e.toggleLabelForPostCreate})}))},toggleLabelForPostCreate:function(e){var t;"create"===this.mode&&(this.draftPostLabels&&this.draftPostLabels.length&&!this.draftLabelsMerged&&(this.createPostLabels=this.addedLabels,this.draftLabelsMerged=!0),t="createPostLabels"),"edit"===this.mode&&(!1===this.editPostLabels&&(this.editPostLabels=this.post.labelStates||[]),t="editPostLabels"),this[t].find((function(t){return t.id===e.id}))?this[t]=this[t].filter((function(t){return t.id!==e.id})):this[t]=[].concat(Object(a["a"])(this[t]),[e]),this.toggleLabelFunc&&this.toggleLabelFunc(this[t])},labelRoute:function(e){return{name:"PostLabel",params:{id:e.id}}}})},p=h,m=i("2877"),f=Object(m["a"])(p,s,o,!1,null,null,null);t["a"]=f.exports},"50d2":function(e,t,i){},5110:function(e,t,i){"use strict";i("c204")},"7ff5":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("b775"),o=function(e){return s["d"].get(e,{withCredentials:!1,responseType:"arraybuffer",headers:{"Cache-Control":"no-cache",Pragma:"no-cache",Expires:"0"}}).then((function(e){return e.data}))}},"998d":function(e,t,i){"use strict";function s(e,t){return!!e.canChat&&(!t.canNotSendReason||"only_friends"===t.canNotSendReason)}i.d(t,"a",(function(){return s}))},a9ee:function(e,t,i){"use strict";(function(i,s){var o,a;
/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */
function r(e,t){if(!e)throw"First parameter is required.";t=t||{type:"video"},t=new n(e,t);var i=this;function s(s){return t.disableLogs||console.log("RecordRTC version: ",i.version),s&&(t=new n(e,s)),t.disableLogs||console.log("started recording "+t.type+" stream."),g?(g.clearRecordedData(),g.record(),m("recording"),i.recordingDuration&&p(),i):(o((function(){i.recordingDuration&&p()})),i)}function o(i){i&&(t.initCallback=function(){i(),i=t.initCallback=null});var s=new d(e,t);g=new s(e,t),g.record(),m("recording"),t.disableLogs||console.log("Initialized recorderType:",g.constructor.name,"for output-type:",t.type)}function a(e){if(e=e||function(){},g){if("paused"===i.state)return i.resumeRecording(),void setTimeout((function(){a(e)}),1);"recording"===i.state||t.disableLogs||console.warn('Recording state should be: "recording", however current state is: ',i.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),"gif"!==t.type?g.stop(s):(g.stop(),s()),m("stopped")}else b();function s(s){if(g){Object.keys(g).forEach((function(e){"function"!==typeof g[e]&&(i[e]=g[e])}));var o=g.blob;if(!o){if(!s)throw"Recording failed.";g.blob=o=s}if(o&&!t.disableLogs&&console.log(o.type,"->",C(o.size)),e){var a;try{a=f.createObjectURL(o)}catch(r){}"function"===typeof e.call?e.call(i,a):e(a)}t.autoWriteToDisk&&h((function(e){var i={};i[t.type+"Blob"]=e,R.Store(i)}))}else"function"===typeof e.call?e.call(i,""):e("")}}function c(){g?"recording"===i.state?(m("paused"),g.pause(),t.disableLogs||console.log("Paused recording.")):t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",i.state):b()}function l(){g?"paused"===i.state?(m("recording"),g.resume(),t.disableLogs||console.log("Resumed recording.")):t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",i.state):b()}function u(e){postMessage((new FileReaderSync).readAsDataURL(e))}function h(e,i){if(!e)throw"Pass a callback function over getDataURL.";var s=i?i.blob:(g||{}).blob;if(!s)return t.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout((function(){h(e,i)}),1e3);if("undefined"===typeof Worker||navigator.mozGetUserMedia){var o=new FileReader;o.readAsDataURL(s),o.onload=function(t){e(t.target.result)}}else{var a=r(u);a.onmessage=function(t){e(t.data)},a.postMessage(s)}function r(e){try{var t=f.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(t);return f.revokeObjectURL(t),i}catch(s){}}}function p(e){e=e||0,"paused"!==i.state?"stopped"!==i.state&&(e>=i.recordingDuration?a(i.onRecordingStopped):(e+=1e3,setTimeout((function(){p(e)}),1e3))):setTimeout((function(){p(e)}),1e3)}function m(e){i&&(i.state=e,"function"===typeof i.onStateChanged.call?i.onStateChanged.call(i,e):i.onStateChanged(e))}var g,v='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function b(){!0!==t.disableLogs&&console.warn(v)}var w={startRecording:s,stopRecording:a,pauseRecording:c,resumeRecording:l,initRecorder:o,setRecordingDuration:function(e,t){if("undefined"===typeof e)throw"recordingDuration is required.";if("number"!==typeof e)throw"recordingDuration must be a number.";return i.recordingDuration=e,i.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){i.onRecordingStopped=e}}},clearRecordedData:function(){g?(g.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")):b()},getBlob:function(){if(g)return g.blob;b()},getDataURL:h,toURL:function(){if(g)return f.createObjectURL(g.blob);b()},getInternalRecorder:function(){return g},save:function(e){g?P(g.blob,e):b()},getFromDisk:function(e){g?r.getFromDisk(t.type,e):b()},setAdvertisementArray:function(e){t.advertisement=[];for(var i=e.length,s=0;s<i;s++)t.advertisement.push({duration:s,image:e[s]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"!==i.state||t.disableLogs||console.warn("Stop an active recorder."),g&&"function"===typeof g.clearRecordedData&&g.clearRecordedData(),g=null,m("inactive"),i.blob=null},onStateChanged:function(e){t.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function(){return i.state},destroy:function(){var e=t.disableLogs;t={disableLogs:!0},i.reset(),m("destroyed"),w=i=null,O.AudioContextConstructor&&(O.AudioContextConstructor.close(),O.AudioContextConstructor=null),t.disableLogs=e,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return i=w,w;for(var _ in w)this[_]=w[_];return i=this,w}
/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */
function n(e,t){return t.recorderType||t.type||(t.audio&&t.video?t.type="video":t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===I||t.recorderType===F||"undefined"!==typeof B&&t.recorderType===B?t.type="video":t.recorderType===A?t.type="gif":t.recorderType===T?t.type="audio":t.recorderType===L&&(S(e,"audio").length&&S(e,"video").length||!S(e,"audio").length&&S(e,"video").length?t.type="video":S(e,"audio").length&&!S(e,"video").length&&(t.type="audio"))),"undefined"!==typeof L&&"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0]),t.bitsPerSecond),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}
/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function d(e,t){var i;return(w||g||v)&&(i=T),"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!w&&(i=L),"video"===t.type&&(w||v)&&(i=I,"undefined"!==typeof B&&"undefined"!==typeof ReadableStream&&(i=B)),"gif"===t.type&&(i=A),"canvas"===t.type&&(i=F),D()&&i!==F&&i!==A&&"undefined"!==typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(S(e,"video").length||S(e,"audio").length)&&("audio"===t.type?"function"===typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(i=L):"function"===typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(i=L)),e instanceof Array&&e.length&&(i=E),t.recorderType&&(i=t.recorderType),!t.disableLogs&&i&&i.name&&console.log("Using recorderType:",i.name||i.constructor.name),!i&&_&&(i=L),i}
/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function c(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t,i=this.mediaType,s=this.mimeType||{audio:null,video:null,gif:null};if("function"!==typeof i.audio&&D()&&!S(e,"audio").length&&(i.audio=!1),"function"!==typeof i.video&&D()&&!S(e,"video").length&&(i.video=!1),"function"!==typeof i.gif&&D()&&!S(e,"video").length&&(i.gif=!1),!i.audio&&!i.video&&!i.gif)throw"MediaStream must have either audio or video tracks.";if(i.audio&&(t=null,"function"===typeof i.audio&&(t=i.audio),this.audioRecorder=new r(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:s.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),i.video||this.audioRecorder.startRecording()),i.video){t=null,"function"===typeof i.video&&(t=i.video);var o=e;if(D()&&i.audio&&"function"===typeof i.audio){var a=S(e,"video")[0];b?(o=new y,o.addTrack(a),t&&t===I&&(t=L)):(o=new y,o.addTrack(a))}this.videoRecorder=new r(o,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:s.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),i.audio||this.videoRecorder.startRecording()}if(i.audio&&i.video){var n=this,d=!0===D();(i.audio instanceof T&&i.video||!0!==i.audio&&!0!==i.video&&i.audio!==i.video)&&(d=!1),!0===d?(n.audioRecorder=null,n.videoRecorder.startRecording()):n.videoRecorder.initRecorder((function(){n.audioRecorder.initRecorder((function(){n.videoRecorder.startRecording(),n.audioRecorder.startRecording()}))}))}i.gif&&(t=null,"function"===typeof i.gif&&(t=i.gif),this.gifRecorder=new r(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:s.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording((function(t){e(t,"audio")})),this.videoRecorder&&this.videoRecorder.stopRecording((function(t){e(t,"video")})),this.gifRecorder&&this.gifRecorder.stopRecording((function(t){e(t,"gif")}))},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){function t(e,t){if("undefined"!==typeof Worker){var s=i((function(e){postMessage((new FileReaderSync).readAsDataURL(e))}));s.onmessage=function(e){t(e.data)},s.postMessage(e)}else{var o=new FileReader;o.readAsDataURL(e),o.onload=function(e){t(e.target.result)}}}function i(e){var t,i=f.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),s=new Worker(i);if("undefined"!==typeof f)t=f;else{if("undefined"===typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(i),s}this.getBlob((function(i){i.audio&&i.video?t(i.audio,(function(s){t(i.video,(function(t){e({audio:s,video:t})}))})):i.audio?t(i.audio,(function(t){e({audio:t})})):i.video&&t(i.video,(function(t){e({video:t})}))}))},this.writeToDisk=function(){r.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save("string"===typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"===typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"===typeof e.gif?e.gif:"")}}r.version="5.6.2",e.exports=r,o=[],a=function(){return r}.apply(t,o),void 0===a||(e.exports=a),r.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),R.Fetch((function(i,s){"all"!==e&&s===e+"Blob"&&t&&t(i),"all"===e&&t&&t(i,s.replace("Blob",""))}))},r.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),e=e||{},e.audio&&e.video&&e.gif?e.audio.getDataURL((function(t){e.video.getDataURL((function(i){e.gif.getDataURL((function(e){R.Store({audioBlob:t,videoBlob:i,gifBlob:e})}))}))})):e.audio&&e.video?e.audio.getDataURL((function(t){e.video.getDataURL((function(e){R.Store({audioBlob:t,videoBlob:e})}))})):e.audio&&e.gif?e.audio.getDataURL((function(t){e.gif.getDataURL((function(e){R.Store({audioBlob:t,gifBlob:e})}))})):e.video&&e.gif?e.video.getDataURL((function(t){e.gif.getDataURL((function(e){R.Store({videoBlob:t,gifBlob:e})}))})):e.audio?e.audio.getDataURL((function(e){R.Store({audioBlob:e})})):e.video?e.video.getDataURL((function(e){R.Store({videoBlob:e})})):e.gif&&e.gif.getDataURL((function(e){R.Store({gifBlob:e})}))},c.getFromDisk=r.getFromDisk,c.writeToDisk=r.writeToDisk,"undefined"!==typeof r&&(r.MRecordRTC=c);var l="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(e){e&&"undefined"===typeof window&&"undefined"!==typeof i&&(i.navigator={userAgent:l,getUserMedia:function(){}},i.console||(i.console={}),"undefined"!==typeof i.console.log&&"undefined"!==typeof i.console.error||(i.console.error=i.console.log=i.console.log||function(){console.log(arguments)}),"undefined"===typeof document&&(e.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"===typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"===typeof screen&&(e.screen={width:0,height:0}),"undefined"===typeof f&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=i)})("undefined"!==typeof i?i:null);var u=window.requestAnimationFrame;if("undefined"===typeof u)if("undefined"!==typeof webkitRequestAnimationFrame)u=webkitRequestAnimationFrame;else if("undefined"!==typeof mozRequestAnimationFrame)u=mozRequestAnimationFrame;else if("undefined"!==typeof msRequestAnimationFrame)u=msRequestAnimationFrame;else if("undefined"===typeof u){var h=0;u=function(e,t){var i=(new Date).getTime(),s=Math.max(0,16-(i-h)),o=setTimeout((function(){e(i+s)}),s);return h=i+s,o}}var p=window.cancelAnimationFrame;"undefined"===typeof p&&("undefined"!==typeof webkitCancelAnimationFrame?p=webkitCancelAnimationFrame:"undefined"!==typeof mozCancelAnimationFrame?p=mozCancelAnimationFrame:"undefined"!==typeof msCancelAnimationFrame?p=msCancelAnimationFrame:"undefined"===typeof p&&(p=function(e){clearTimeout(e)}));var m=window.AudioContext;"undefined"===typeof m&&("undefined"!==typeof webkitAudioContext&&(m=webkitAudioContext),"undefined"!==typeof mozAudioContext&&(m=mozAudioContext));var f=window.URL;"undefined"===typeof f&&"undefined"!==typeof webkitURL&&(f=webkitURL),"undefined"!==typeof navigator&&"undefined"===typeof navigator.getUserMedia&&("undefined"!==typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!==typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var g=-1!==navigator.userAgent.indexOf("Edge")&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),v=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),b=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),w=!v&&!g&&!!navigator.webkitGetUserMedia||k()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),_=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);_&&!w&&-1!==navigator.userAgent.indexOf("CriOS")&&(_=!1,w=!0);var y=window.MediaStream;function C(e){var t=1e3,i=["Bytes","KB","MB","GB","TB"];if(0===e)return"0 Bytes";var s=parseInt(Math.floor(Math.log(e)/Math.log(t)),10);return(e/Math.pow(t,s)).toPrecision(3)+" "+i[s]}function P(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(r){}var i=(e.type||"video/webm").split("/")[1];if(-1!==i.indexOf(";")&&(i=i.split(";")[0]),t&&-1!==t.indexOf(".")){var s=t.split(".");t=s[0],i=s[1]}var o=(t||Math.round(9999999999*Math.random())+888888888)+"."+i;if("undefined"!==typeof navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,o);if("undefined"!==typeof navigator.msSaveBlob)return navigator.msSaveBlob(e,o);var a=document.createElement("a");a.href=f.createObjectURL(e),a.download=o,a.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(a),"function"===typeof a.click?a.click():(a.target="_blank",a.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),f.revokeObjectURL(a.href)}function k(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof s||"object"!==typeof s.versions||!s.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}function S(e,t){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(t||"audio")})):[]}function x(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function M(e,t){if("undefined"===typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var i=new EBML.Reader,s=new EBML.Decoder,o=EBML.tools,a=new FileReader;a.onload=function(e){var a=s.decode(this.result);a.forEach((function(e){i.read(e)})),i.stop();var r=o.makeMetadataSeekable(i.metadatas,i.duration,i.cues),n=this.result.slice(i.metadataSize),d=new Blob([r,n],{type:"video/webm"});t(d)},a.readAsArrayBuffer(e)}"undefined"===typeof y&&"undefined"!==typeof webkitMediaStream&&(y=webkitMediaStream),"undefined"!==typeof y&&"undefined"===typeof y.prototype.stop&&(y.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))}),"undefined"!==typeof r&&(r.invokeSaveAsDialog=P,r.getTracks=S,r.getSeekableBlob=M,r.bytesToSize=C,r.isElectron=k);
/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var O={};function D(){if(b||_||g)return!0;navigator.appVersion;var e,t,i=navigator.userAgent,s=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10);return(w||v)&&(e=i.indexOf("Chrome"),s=i.substring(e+7)),-1!==(t=s.indexOf(";"))&&(s=s.substring(0,t)),-1!==(t=s.indexOf(" "))&&(s=s.substring(0,t)),o=parseInt(""+s,10),isNaN(o)&&(s=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),o>=49}
/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function L(e,t){var i=this;if("undefined"===typeof e)throw'First argument "MediaStream" is required.';if("undefined"===typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(t=t||{mimeType:"video/webm"},"audio"===t.type){var s;if(S(e,"video").length&&S(e,"audio").length)navigator.mozGetUserMedia?(s=new y,s.addTrack(S(e,"audio")[0])):s=new y(S(e,"audio")),e=s;t.mimeType&&-1!==t.mimeType.toString().toLowerCase().indexOf("audio")||(t.mimeType=w?"audio/webm":"audio/ogg"),t.mimeType&&"audio/ogg"!==t.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(t.mimeType="audio/ogg")}var o,a=[];function r(){i.timestamps.push((new Date).getTime()),"function"===typeof t.onTimeStamp&&t.onTimeStamp(i.timestamps[i.timestamps.length-1],i.timestamps)}function n(e){return o&&o.mimeType?o.mimeType:e.mimeType||"video/webm"}function d(){a=[],o=null,i.timestamps=[]}function c(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}this.getArrayOfBlobs=function(){return a},this.record=function(){i.blob=null,i.clearRecordedData(),i.timestamps=[],l=[],a=[];var s=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",s),o&&(o=null),w&&!D()&&(s="video/vp8"),"function"===typeof MediaRecorder.isTypeSupported&&s.mimeType&&(MediaRecorder.isTypeSupported(s.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",s.mimeType),s.mimeType="audio"===t.type?"audio/webm":"video/webm"));try{o=new MediaRecorder(e,s),t.mimeType=s.mimeType}catch(d){o=new MediaRecorder(e)}s.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in o&&!1===o.canRecordMimeType(s.mimeType)&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",s.mimeType)),o.ondataavailable=function(e){if(e.data&&l.push("ondataavailable: "+C(e.data.size)),"number"!==typeof t.timeSlice)!e.data||!e.data.size||e.data.size<100||i.blob?i.recordingCallback&&(i.recordingCallback(new Blob([],{type:n(s)})),i.recordingCallback=null):(i.blob=t.getNativeBlob?e.data:new Blob([e.data],{type:n(s)}),i.recordingCallback&&(i.recordingCallback(i.blob),i.recordingCallback=null));else if(e.data&&e.data.size&&(a.push(e.data),r(),"function"===typeof t.ondataavailable)){var o=t.getNativeBlob?e.data:new Blob([e.data],{type:n(s)});t.ondataavailable(o)}},o.onstart=function(){l.push("started")},o.onpause=function(){l.push("paused")},o.onresume=function(){l.push("resumed")},o.onstop=function(){l.push("stopped")},o.onerror=function(e){e&&(e.name||(e.name="UnknownError"),l.push("error: "+e),t.disableLogs||(-1!==e.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e):-1!==e.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",s.mimeType,") is not supported.",e):-1!==e.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",e):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),function(e){if(!i.manuallyStopped&&o&&"inactive"===o.state)return delete t.timeslice,void o.start(6e5);setTimeout(e,1e3)}(),"inactive"!==o.state&&"stopped"!==o.state&&o.stop())},"number"===typeof t.timeSlice?(r(),o.start(t.timeSlice)):o.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[],this.stop=function(e){e=e||function(){},i.manuallyStopped=!0,o&&(this.recordingCallback=e,"recording"===o.state&&o.stop(),"number"===typeof t.timeSlice&&setTimeout((function(){i.blob=new Blob(a,{type:n(t)}),i.recordingCallback(i.blob)}),100))},this.pause=function(){o&&"recording"===o.state&&o.pause()},this.resume=function(){o&&"paused"===o.state&&o.resume()},this.clearRecordedData=function(){o&&"recording"===o.state&&i.stop(d),d()},this.getInternalRecorder=function(){return o},this.blob=null,this.getState=function(){return o&&o.state||"inactive"};var l=[];this.getAllStates=function(){return l},"undefined"===typeof t.checkForInactiveTracks&&(t.checkForInactiveTracks=!1);i=this;(function e(){if(o&&!1!==t.checkForInactiveTracks)return!1===c()?(t.disableLogs||console.log("MediaStream seems stopped."),void i.stop()):void setTimeout(e,1e3)})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}
/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */
function T(e,t){if(!S(e,"audio").length)throw"Your stream has no audio tracks.";t=t||{};var i,s=this,o=[],a=[],n=!1,d=0,c=2,l=t.desiredSampRate;function u(){if(!1===t.checkForInactiveTracks)return!0;if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}function h(e,t){function i(e,t){var i,s=e.numberOfAudioChannels,o=e.leftBuffers.slice(0),a=e.rightBuffers.slice(0),r=e.sampleRate,n=e.internalInterleavedLength,d=e.desiredSampRate;function c(e,t,i){var s=Math.round(e.length*(t/i)),o=[],a=Number((e.length-1)/(s-1));o[0]=e[0];for(var r=1;r<s-1;r++){var n=r*a,d=Number(Math.floor(n)).toFixed(),c=Number(Math.ceil(n)).toFixed(),u=n-d;o[r]=l(e[d],e[c],u)}return o[s-1]=e[e.length-1],o}function l(e,t,i){return e+(t-e)*i}function u(e,t){for(var i=new Float64Array(t),s=0,o=e.length,a=0;a<o;a++){var r=e[a];i.set(r,s),s+=r.length}return i}function h(e,t){for(var i=e.length+t.length,s=new Float64Array(i),o=0,a=0;a<i;)s[a++]=e[o],s[a++]=t[o],o++;return s}function p(e,t,i){for(var s=i.length,o=0;o<s;o++)e.setUint8(t+o,i.charCodeAt(o))}2===s&&(o=u(o,n),a=u(a,n),d&&(o=c(o,d,r),a=c(a,d,r))),1===s&&(o=u(o,n),d&&(o=c(o,d,r))),d&&(r=d),2===s&&(i=h(o,a)),1===s&&(i=o);var m=i.length,f=44+2*m,g=new ArrayBuffer(f),v=new DataView(g);p(v,0,"RIFF"),v.setUint32(4,36+2*m,!0),p(v,8,"WAVE"),p(v,12,"fmt "),v.setUint32(16,16,!0),v.setUint16(20,1,!0),v.setUint16(22,s,!0),v.setUint32(24,r,!0),v.setUint32(28,r*s*2,!0),v.setUint16(32,2*s,!0),v.setUint16(34,16,!0),p(v,36,"data"),v.setUint32(40,2*m,!0);for(var b=m,w=44,_=1,y=0;y<b;y++)v.setInt16(w,i[y]*(32767*_),!0),w+=2;if(t)return t({buffer:g,view:v});postMessage({buffer:g,view:v})}if(e.noWorker)i(e,(function(e){t(e.buffer,e.view)}));else{var s=p(i);s.onmessage=function(e){t(e.data.buffer,e.data.view),f.revokeObjectURL(s.workerURL),s.terminate()},s.postMessage(e)}}function p(e){var t=f.createObjectURL(new Blob([e.toString(),";this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(t);return i.workerURL=t,i}!0===t.leftChannel&&(c=1),1===t.numberOfAudioChannels&&(c=1),(!c||c<1)&&(c=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+c),"undefined"===typeof t.checkForInactiveTracks&&(t.checkForInactiveTracks=!0),this.record=function(){if(!1===u())throw"Please make sure MediaStream is active.";y(),P=_=!1,n=!0,"undefined"!==typeof t.timeSlice&&M()},this.stop=function(e){e=e||function(){},n=!1,h({desiredSampRate:l,sampleRate:w,numberOfAudioChannels:c,internalInterleavedLength:d,leftBuffers:o,rightBuffers:1===c?[]:a,noWorker:t.noWorker},(function(t,i){s.blob=new Blob([i],{type:"audio/wav"}),s.buffer=new ArrayBuffer(i.buffer.byteLength),s.view=i,s.sampleRate=l||w,s.bufferSize=b,s.length=d,P=!1,e&&e(s.blob)}))},"undefined"===typeof r.Storage&&(r.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),r.Storage.AudioContextConstructor&&"closed"!==r.Storage.AudioContextConstructor.state||(r.Storage.AudioContextConstructor=new r.Storage.AudioContext);var m=r.Storage.AudioContextConstructor,g=m.createMediaStreamSource(e),v=[0,256,512,1024,2048,4096,8192,16384],b="undefined"===typeof t.bufferSize?4096:t.bufferSize;if(-1===v.indexOf(b)&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(v,null,"\t"))),m.createJavaScriptNode)i=m.createJavaScriptNode(b,c,c);else{if(!m.createScriptProcessor)throw"WebAudio API has no support on this browser.";i=m.createScriptProcessor(b,c,c)}g.connect(i),t.bufferSize||(b=i.bufferSize);var w="undefined"!==typeof t.sampleRate?t.sampleRate:m.sampleRate||44100;(w<22050||w>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var _=!1;function y(){o=[],a=[],d=0,P=!1,n=!1,_=!1,m=null,s.leftchannel=o,s.rightchannel=a,s.numberOfAudioChannels=c,s.desiredSampRate=l,s.sampleRate=w,s.recordingLength=d,x={left:[],right:[],recordingLength:0}}function C(){i&&(i.onaudioprocess=null,i.disconnect(),i=null),g&&(g.disconnect(),g=null),y()}this.pause=function(){_=!0},this.resume=function(){if(!1===u())throw"Please make sure MediaStream is active.";if(!n)return t.disableLogs||console.log("Seems recording has been restarted."),void this.record();_=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,n&&this.stop(C),C()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var P=!1;function k(e){if(!_)if(!1===u()&&(t.disableLogs||console.log("MediaStream seems stopped."),i.disconnect(),n=!1),n){P||(P=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var r=e.inputBuffer.getChannelData(0),l=new Float32Array(r);if(o.push(l),2===c){var h=e.inputBuffer.getChannelData(1),p=new Float32Array(h);a.push(p)}d+=b,s.recordingLength=d,"undefined"!==typeof t.timeSlice&&(x.recordingLength+=b,x.left.push(l),2===c&&x.right.push(p))}else g&&(g.disconnect(),g=null)}i.onaudioprocess=k,m.createMediaStreamDestination?i.connect(m.createMediaStreamDestination()):i.connect(m.destination),this.leftchannel=o,this.rightchannel=a,this.numberOfAudioChannels=c,this.desiredSampRate=l,this.sampleRate=w,s.recordingLength=d;var x={left:[],right:[],recordingLength:0};function M(){n&&"function"===typeof t.ondataavailable&&"undefined"!==typeof t.timeSlice&&(x.left.length?(h({desiredSampRate:l,sampleRate:w,numberOfAudioChannels:c,internalInterleavedLength:x.recordingLength,leftBuffers:x.left,rightBuffers:1===c?[]:x.right},(function(e,i){var s=new Blob([i],{type:"audio/wav"});t.ondataavailable(s),setTimeout(M,t.timeSlice)})),x={left:[],right:[],recordingLength:0}):setTimeout(M,t.timeSlice))}}
/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */
function F(e,t){if("undefined"===typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";t=t||{},t.frameInterval||(t.frameInterval=10);var i=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){e in document.createElement("canvas")&&(i=!0)}));var s,o,a,r=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,n=50,d=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(r&&d&&d[2]&&(n=parseInt(d[2],10)),r&&n<52&&(i=!1),t.useWhammyRecorder&&(i=!1),i)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),e instanceof HTMLCanvasElement)s=e;else{if(!(e instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";s=e.canvas}else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(a=!0,i&&!t.useWhammyRecorder){var e;"captureStream"in s?e=s.captureStream(25):"mozCaptureStream"in s?e=s.mozCaptureStream(25):"webkitCaptureStream"in s&&(e=s.webkitCaptureStream(25));try{var r=new y;r.addTrack(S(e,"video")[0]),e=r}catch(n){}if(!e)throw"captureStream API are NOT available.";o=new L(e,{mimeType:t.mimeType||"video/webm"}),o.record()}else m.frames=[],p=(new Date).getTime(),h();t.initCallback&&t.initCallback()},this.getWebPImages=function(i){if("canvas"===e.nodeName.toLowerCase()){var s=m.frames.length;m.frames.forEach((function(e,i){var o=s-i;t.disableLogs||console.log(o+"/"+s+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(o,s);var a=e.image.toDataURL("image/webp",1);m.frames[i].image=a})),t.disableLogs||console.log("Generating WebM"),i()}else i()},this.stop=function(e){a=!1;var s=this;i&&o?o.stop(e):this.getWebPImages((function(){m.compile((function(i){t.disableLogs||console.log("Recording finished!"),s.blob=i,s.blob.forEach&&(s.blob=new Blob([],{type:"video/webm"})),e&&e(s.blob),m.frames=[]}))}))};var c=!1;function l(){m.frames=[],a=!1,c=!1}function u(){var t=document.createElement("canvas"),i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.drawImage(e,0,0),t}function h(){if(c)return p=(new Date).getTime(),setTimeout(h,500);if("canvas"===e.nodeName.toLowerCase()){var i=(new Date).getTime()-p;return p=(new Date).getTime(),m.frames.push({image:u(),duration:i}),void(a&&setTimeout(h,t.frameInterval))}html2canvas(e,{grabMouse:"undefined"===typeof t.showMousePointer||t.showMousePointer,onrendered:function(e){var i=(new Date).getTime()-p;if(!i)return setTimeout(h,t.frameInterval);p=(new Date).getTime(),m.frames.push({image:e.toDataURL("image/webp",1),duration:i}),a&&setTimeout(h,t.frameInterval)}})}this.pause=function(){c=!0,o instanceof L&&o.pause()},this.resume=function(){c=!1,o instanceof L?o.resume():a||this.record()},this.clearRecordedData=function(){a&&this.stop(l),l()},this.name="CanvasRecorder",this.toString=function(){return this.name};var p=(new Date).getTime(),m=new $.Video(100)}
/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */
function I(e,t){function i(e){e="undefined"!==typeof e?e:10;var t=(new Date).getTime()-c;return t?r?(c=(new Date).getTime(),setTimeout(i,100)):(c=(new Date).getTime(),d.paused&&d.play(),h.drawImage(d,0,0,u.width,u.height),l.frames.push({duration:t,image:u.toDataURL("image/webp")}),void(a||setTimeout(i,e,e))):setTimeout(i,e,e)}function s(e){var t=-1,i=e.length;(function s(){t++,t!==i?setTimeout((function(){e.functionToLoop(s,t)}),1):e.callback()})()}function o(e,t,i,o,a){var r=document.createElement("canvas");r.width=u.width,r.height=u.height;var n=r.getContext("2d"),d=[],c=-1===t,l=t&&t>0&&t<=e.length?t:e.length,h={r:0,g:0,b:0},p=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),m=i&&i>=0&&i<=1?i:0,f=o&&o>=0&&o<=1?o:0,g=!1;s({length:l,functionToLoop:function(t,i){var s,o,a,r=function(){!g&&a-s<=a*f||(c&&(g=!0),d.push(e[i])),t()};if(g)r();else{var l=new Image;l.onload=function(){n.drawImage(l,0,0,u.width,u.height);var e=n.getImageData(0,0,u.width,u.height);s=0,o=e.data.length,a=e.data.length/4;for(var t=0;t<o;t+=4){var i={r:e.data[t],g:e.data[t+1],b:e.data[t+2]},d=Math.sqrt(Math.pow(i.r-h.r,2)+Math.pow(i.g-h.g,2)+Math.pow(i.b-h.b,2));d<=p*m&&s++}r()},l.src=e[i].image}},callback:function(){d=d.concat(e.slice(l)),d.length<=0&&d.push(e[e.length-1]),a(d)}})}t=t||{},t.frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),u.width=t.canvas.width||320,u.height=t.canvas.height||240,h=u.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(d=t.video.cloneNode(),t.initCallback&&t.initCallback()):(d=document.createElement("video"),x(e,d),d.onloadedmetadata=function(){t.initCallback&&t.initCallback()},d.width=t.video.width,d.height=t.video.height),d.muted=!0,d.play(),c=(new Date).getTime(),l=new $.Video,t.disableLogs||(console.log("canvas resolutions",u.width,"*",u.height),console.log("video width/height",d.width||u.width,"*",d.height||u.height)),i(t.frameInterval)};var a=!1;this.stop=function(e){e=e||function(){},a=!0;var i=this;setTimeout((function(){o(l.frames,-1,null,null,(function(s){l.frames=s,t.advertisement&&t.advertisement.length&&(l.frames=t.advertisement.concat(l.frames)),l.compile((function(t){i.blob=t,i.blob.forEach&&(i.blob=new Blob([],{type:"video/webm"})),e&&e(i.blob)}))}))}),10)};var r=!1;function n(){l.frames=[],a=!0,r=!1}this.pause=function(){r=!0},this.resume=function(){r=!1,a&&this.record()},this.clearRecordedData=function(){a||this.stop(n),n()},this.name="WhammyRecorder",this.toString=function(){return this.name};var d,c,l,u=document.createElement("canvas"),h=u.getContext("2d")}"undefined"!==typeof m?O.AudioContext=m:"undefined"!==typeof webkitAudioContext&&(O.AudioContext=webkitAudioContext),"undefined"!==typeof r&&(r.Storage=O),"undefined"!==typeof r&&(r.MediaStreamRecorder=L),"undefined"!==typeof r&&(r.StereoAudioRecorder=T),"undefined"!==typeof r&&(r.CanvasRecorder=F),"undefined"!==typeof r&&(r.WhammyRecorder=I);
/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */
var $=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){var t=f.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(t);return f.revokeObjectURL(t),i}function i(e){function t(e){var t=s(e);if(!t)return[];var o=3e4,a=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:h(t.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:t.width,id:176},{data:t.height,id:186}]}]}]}]}],r=0,d=0;while(r<e.length){var c=[],l=0;do{c.push(e[r]),l+=e[r].duration,r++}while(r<e.length&&l<o);var u=0,p={id:524531317,data:i(d,u,c)};a[1].data.push(p),d+=l}return n(a)}function i(e,t,i){return[{data:e,id:231}].concat(i.map((function(e){var i=d({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:i,id:163}})))}function s(e){if(e[0]){for(var t=e[0].width,i=e[0].height,s=e[0].duration,o=1;o<e.length;o++)s+=e[o].duration;return{duration:s,width:t,height:i}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}function o(e){var t=[];while(e>0)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function a(e){return new Uint8Array(e.split("").map((function(e){return e.charCodeAt(0)})))}function r(e){var t=[],i=e.length%8?new Array(9-e.length%8).join("0"):"";e=i+e;for(var s=0;s<e.length;s+=8)t.push(parseInt(e.substr(s,8),2));return new Uint8Array(t)}function n(e){for(var t=[],i=0;i<e.length;i++){var s=e[i].data;"object"===typeof s&&(s=n(s)),"number"===typeof s&&(s=r(s.toString(2))),"string"===typeof s&&(s=a(s));var d=s.size||s.byteLength||s.length,c=Math.ceil(Math.ceil(Math.log(d)/Math.log(2))/8),l=d.toString(2),u=new Array(7*c+7+1-l.length).join("0")+l,h=new Array(c).join("0")+"1"+u;t.push(o(e[i].id)),t.push(r(h)),t.push(s)}return new Blob(t,{type:"video/webm"})}function d(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),e.trackNum>127)throw"TrackNumber > 127 not supported";var i=[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame;return i}function c(e){for(var t,i,s,o=e.RIFF[0].WEBP[0],a=o.indexOf("*"),r=0,n=[];r<4;r++)n[r]=o.charCodeAt(a+3+r);return s=n[1]<<8|n[0],t=16383&s,s=n[3]<<8|n[2],i=16383&s,{width:t,height:i,data:o,riff:e}}function l(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}function u(e){var t=0,i={};while(t<e.length){var s=e.substr(t,4),o=l(e,t),a=e.substr(t+4+4,o);t+=8+o,i[s]=i[s]||[],"RIFF"===s||"LIST"===s?i[s].push(u(a)):i[s].push(a)}return i}function h(e){return[].slice.call(new Uint8Array(new Float64Array([e]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")}var p=new t(e.map((function(e){var t=c(u(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(p)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var s=t(i);s.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},s.postMessage(this.frames)},{Video:e}}();"undefined"!==typeof r&&(r.Whammy=$);
/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var R={init:function(){var e=this;if("undefined"!==typeof indexedDB&&"undefined"!==typeof indexedDB.open){var t,i=1,s=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),o=indexedDB.open(s,i);o.onerror=e.onError,o.onsuccess=function(){if(t=o.result,t.onerror=e.onError,t.setVersion)if(t.version!==i){var s=t.setVersion(i);s.onsuccess=function(){a(t),r()}}else r();else r()},o.onupgradeneeded=function(e){a(e.target.result)}}else console.error("IndexedDB API are not available in this browser.");function a(t){t.createObjectStore(e.dataStoreName)}function r(){var i=t.transaction([e.dataStoreName],"readwrite");function s(t){i.objectStore(e.dataStoreName).get(t).onsuccess=function(i){e.callback&&e.callback(i.target.result,t)}}e.videoBlob&&i.objectStore(e.dataStoreName).put(e.videoBlob,"videoBlob"),e.gifBlob&&i.objectStore(e.dataStoreName).put(e.gifBlob,"gifBlob"),e.audioBlob&&i.objectStore(e.dataStoreName).put(e.audioBlob,"audioBlob"),s("audioBlob"),s("videoBlob"),s("gifBlob")}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};
/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */
function A(e,t){if("undefined"===typeof GIFEncoder){var i=document.createElement("script");i.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(i)}t=t||{};var s=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){function e(i){if(!0!==f.clearedRecordedData){if(o)return setTimeout((function(){e(i)}),100);m=u(e),void 0===typeof l&&(l=i),i-l<90||(!s&&c.paused&&c.play(),s||n.drawImage(c,0,0,r.width,r.height),t.onGifPreview&&t.onGifPreview(r.toDataURL("image/png")),h.addFrame(n),l=i)}}"undefined"!==typeof GIFEncoder&&d?(s||(t.width||(t.width=c.offsetWidth||320),t.height||(t.height=c.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),r.width=t.canvas.width||320,r.height=t.canvas.height||240,c.width=t.video.width||320,c.height=t.video.height||240),h=new GIFEncoder,h.setRepeat(0),h.setDelay(t.frameRate||200),h.setQuality(t.quality||10),h.start(),"function"===typeof t.onGifRecordingStarted&&t.onGifRecordingStarted(),Date.now(),m=u(e),t.initCallback&&t.initCallback()):setTimeout(f.record,1e3)},this.stop=function(e){e=e||function(){},m&&p(m),Date.now(),this.blob=new Blob([new Uint8Array(h.stream().bin)],{type:"image/gif"}),e(this.blob),h.stream().bin=[]};var o=!1;function a(){h&&(h.stream().bin=[])}this.pause=function(){o=!0},this.resume=function(){o=!1},this.clearRecordedData=function(){f.clearedRecordedData=!0,a()},this.name="GifRecorder",this.toString=function(){return this.name};var r=document.createElement("canvas"),n=r.getContext("2d");s&&(e instanceof CanvasRenderingContext2D?(n=e,r=n.canvas):e instanceof HTMLCanvasElement&&(n=e.getContext("2d"),r=e));var d=!0;if(!s){var c=document.createElement("video");c.muted=!0,c.autoplay=!0,c.playsInline=!0,d=!1,c.onloadedmetadata=function(){d=!0},x(e,c),c.play()}var l,h,m=null,f=this}function j(e,t){var s="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(e){"undefined"===typeof r&&e&&"undefined"===typeof window&&"undefined"!==typeof i&&(i.navigator={userAgent:s,getUserMedia:function(){}},i.console||(i.console={}),"undefined"!==typeof i.console.log&&"undefined"!==typeof i.console.error||(i.console.error=i.console.log=i.console.log||function(){console.log(arguments)}),"undefined"===typeof document&&(e.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},e.HTMLVideoElement=function(){}),"undefined"===typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"===typeof screen&&(e.screen={width:0,height:0}),"undefined"===typeof u&&(e.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),e.window=i)})("undefined"!==typeof i?i:null),t=t||"multi-streams-mixer";var o=[],a=!1,n=document.createElement("canvas"),d=n.getContext("2d");n.style.opacity=0,n.style.position="absolute",n.style.zIndex=-1,n.style.top="-1000em",n.style.left="-1000em",n.className=t,(document.body||document.documentElement).appendChild(n),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var c=this,l=window.AudioContext;"undefined"===typeof l&&("undefined"!==typeof webkitAudioContext&&(l=webkitAudioContext),"undefined"!==typeof mozAudioContext&&(l=mozAudioContext));var u=window.URL;"undefined"===typeof u&&"undefined"!==typeof webkitURL&&(u=webkitURL),"undefined"!==typeof navigator&&"undefined"===typeof navigator.getUserMedia&&("undefined"!==typeof navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),"undefined"!==typeof navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var h=window.MediaStream;"undefined"===typeof h&&"undefined"!==typeof webkitMediaStream&&(h=webkitMediaStream),"undefined"!==typeof h&&"undefined"===typeof h.prototype.stop&&(h.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))});var p={};function m(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}function f(){if(!a){var e=o.length,t=!1,i=[];if(o.forEach((function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:i.push(e)})),t)n.width=t.stream.width,n.height=t.stream.height;else if(i.length){n.width=e>1?2*i[0].width:i[0].width;var s=1;3!==e&&4!==e||(s=2),5!==e&&6!==e||(s=3),7!==e&&8!==e||(s=4),9!==e&&10!==e||(s=5),n.height=i[0].height*s}else n.width=c.width||360,n.height=c.height||240;t&&t instanceof HTMLVideoElement&&g(t),i.forEach((function(e,t){g(e,t)})),setTimeout(f,c.frameInterval)}}function g(e,t){if(!a){var i=0,s=0,o=e.width,r=e.height;1===t&&(i=e.width),2===t&&(s=e.height),3===t&&(i=e.width,s=e.height),4===t&&(s=2*e.height),5===t&&(i=e.width,s=2*e.height),6===t&&(s=3*e.height),7===t&&(i=e.width,s=3*e.height),"undefined"!==typeof e.stream.left&&(i=e.stream.left),"undefined"!==typeof e.stream.top&&(s=e.stream.top),"undefined"!==typeof e.stream.width&&(o=e.stream.width),"undefined"!==typeof e.stream.height&&(r=e.stream.height),d.drawImage(e,i,s,o,r),"function"===typeof e.stream.onRender&&e.stream.onRender(d,i,s,o,r,t)}}function v(){a=!1;var t=b(),i=w();return i&&i.getTracks().filter((function(e){return"audio"===e.kind})).forEach((function(e){t.addTrack(e)})),e.forEach((function(e){e.fullcanvas&&!0})),t}function b(){var e;y(),"captureStream"in n?e=n.captureStream():"mozCaptureStream"in n?e=n.mozCaptureStream():c.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new h;return e.getTracks().filter((function(e){return"video"===e.kind})).forEach((function(e){t.addTrack(e)})),n.stream=t,t}function w(){p.AudioContextConstructor||(p.AudioContextConstructor=new p.AudioContext),c.audioContext=p.AudioContextConstructor,c.audioSources=[],!0===c.useGainNode&&(c.gainNode=c.audioContext.createGain(),c.gainNode.connect(c.audioContext.destination),c.gainNode.gain.value=0);var t=0;if(e.forEach((function(e){if(e.getTracks().filter((function(e){return"audio"===e.kind})).length){t++;var i=c.audioContext.createMediaStreamSource(e);!0===c.useGainNode&&i.connect(c.gainNode),c.audioSources.push(i)}})),t)return c.audioDestination=c.audioContext.createMediaStreamDestination(),c.audioSources.forEach((function(e){e.connect(c.audioDestination)})),c.audioDestination.stream}function _(e){var i=document.createElement("video");return m(e,i),i.className=t,i.muted=!0,i.volume=0,i.width=e.width||c.width||360,i.height=e.height||c.height||240,i.play(),i}function y(t){o=[],t=t||e,t.forEach((function(e){if(e.getTracks().filter((function(e){return"video"===e.kind})).length){var t=_(e);t.stream=e,o.push(t)}}))}"undefined"!==typeof l?p.AudioContext=l:"undefined"!==typeof webkitAudioContext&&(p.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){f()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),t.forEach((function(t){var i=new h;if(t.getTracks().filter((function(e){return"video"===e.kind})).length){var s=_(t);s.stream=t,o.push(s),i.addTrack(t.getTracks().filter((function(e){return"video"===e.kind}))[0])}if(t.getTracks().filter((function(e){return"audio"===e.kind})).length){var a=c.audioContext.createMediaStreamSource(t);c.audioDestination=c.audioContext.createMediaStreamDestination(),a.connect(c.audioDestination),i.addTrack(c.audioDestination.stream.getTracks().filter((function(e){return"audio"===e.kind}))[0])}e.push(i)}))},this.releaseStreams=function(){o=[],a=!0,c.gainNode&&(c.gainNode.disconnect(),c.gainNode=null),c.audioSources.length&&(c.audioSources.forEach((function(e){e.disconnect()})),c.audioSources=[]),c.audioDestination&&(c.audioDestination.disconnect(),c.audioDestination=null),c.audioContext&&c.audioContext.close(),c.audioContext=null,d.clearRect(0,0,n.width,n.height),n.stream&&(n.stream.stop(),n.stream=null)},this.resetVideoStreams=function(e){!e||e instanceof Array||(e=[e]),y(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=v}
/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */
function E(e,t){e=e||[];var i,s,o=this;function a(){var t=[];return e.forEach((function(e){S(e,"video").forEach((function(e){t.push(e)}))})),t}t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},t.frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){i=new j(e,t.elementClass||"multi-streams-mixer"),a().length&&(i.frameInterval=t.frameInterval||10,i.width=t.video.width||360,i.height=t.video.height||240,i.startDrawingFrames()),t.previewStream&&"function"===typeof t.previewStream&&t.previewStream(i.getMixedStream()),s=new L(i.getMixedStream(),t),s.record()},this.stop=function(e){s&&s.stop((function(t){o.blob=t,e(t),o.clearRecordedData()}))},this.pause=function(){s&&s.pause()},this.resume=function(){s&&s.resume()},this.clearRecordedData=function(){s&&(s.clearRecordedData(),s=null),i&&(i.releaseStreams(),i=null)},this.addStreams=function(o){if(!o)throw"First parameter is required.";o instanceof Array||(o=[o]),e.concat(o),s&&i&&(i.appendStreams(o),t.previewStream&&"function"===typeof t.previewStream&&t.previewStream(i.getMixedStream()))},this.resetVideoStreams=function(e){i&&(!e||e instanceof Array||(e=[e]),i.resetVideoStreams(e))},this.getMixer=function(){return i},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}
/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */
function U(e,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if("undefined"===typeof e)throw'First argument "MediaStream" is required.';var i=this;i.recordRTC=new r(e,t),this.startRecording=function(){return new Promise((function(e,t){try{i.recordRTC.startRecording(),e()}catch(s){t(s)}}))},this.stopRecording=function(){return new Promise((function(e,t){try{i.recordRTC.stopRecording((function(s){i.blob=i.recordRTC.getBlob(),i.blob&&i.blob.size?e(s):t("Empty blob.",i.blob)}))}catch(s){t(s)}}))},this.pauseRecording=function(){return new Promise((function(e,t){try{i.recordRTC.pauseRecording(),e()}catch(s){t(s)}}))},this.resumeRecording=function(){return new Promise((function(e,t){try{i.recordRTC.resumeRecording(),e()}catch(s){t(s)}}))},this.getDataURL=function(e){return new Promise((function(e,t){try{i.recordRTC.getDataURL((function(t){e(t)}))}catch(s){t(s)}}))},this.getBlob=function(){return new Promise((function(e,t){try{e(i.recordRTC.getBlob())}catch(s){t(s)}}))},this.getInternalRecorder=function(){return new Promise((function(e,t){try{e(i.recordRTC.getInternalRecorder())}catch(s){t(s)}}))},this.reset=function(){return new Promise((function(e,t){try{e(i.recordRTC.reset())}catch(s){t(s)}}))},this.destroy=function(){return new Promise((function(e,t){try{e(i.recordRTC.destroy())}catch(s){t(s)}}))},this.getState=function(){return new Promise((function(e,t){try{e(i.recordRTC.getState())}catch(s){t(s)}}))},this.blob=null,this.version="5.6.2"}
/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */
function B(e,t){var i,s,o;function a(){return new ReadableStream({start:function(s){var o=document.createElement("canvas"),a=document.createElement("video"),r=!0;a.srcObject=e,a.muted=!0,a.height=t.height,a.width=t.width,a.volume=0,a.onplaying=function(){o.width=t.width,o.height=t.height;var e=o.getContext("2d"),n=1e3/t.frameRate,d=setInterval((function(){if(i&&(clearInterval(d),s.close()),r&&(r=!1,t.onVideoProcessStarted&&t.onVideoProcessStarted()),e.drawImage(a,0,0),"closed"!==s._controlledReadableStream.state)try{s.enqueue(e.getImageData(0,0,t.width,t.height))}catch(o){}}),n)},a.play()}})}function r(e,n){if(!t.workerPath&&!n)return i=!1,void fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then((function(t){t.arrayBuffer().then((function(t){r(e,t)}))}));if(!t.workerPath&&n instanceof ArrayBuffer){var c=new Blob([n],{type:"text/javascript"});t.workerPath=f.createObjectURL(c)}t.workerPath||console.error("workerPath parameter is missing."),s=new Worker(t.workerPath),s.postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),s.addEventListener("message",(function(e){"READY"===e.data?(s.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:t.realtime}),a().pipeTo(new WritableStream({write:function(e){i?console.error("Got image, but recorder is finished!"):s.postMessage(e.data.buffer,[e.data.buffer])}}))):e.data&&(o||d.push(e.data))}))}function n(e){s?(s.addEventListener("message",(function(t){null===t.data&&(s.terminate(),s=null,e&&e())})),s.postMessage(null)):e&&e()}"undefined"!==typeof ReadableStream&&"undefined"!==typeof WritableStream||console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),t=t||{},t.width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,t.realtime=t.realtime||!0,this.record=function(){d=[],o=!1,this.blob=null,r(e),"function"===typeof t.initCallback&&t.initCallback()},this.pause=function(){o=!0},this.resume=function(){o=!1};var d=[];this.stop=function(e){i=!0;var t=this;n((function(){t.blob=new Blob(d,{type:"video/webm"}),e(t.blob)}))},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){d=[],o=!1,this.blob=null},this.blob=null}"undefined"!==typeof r&&(r.DiskStorage=R),"undefined"!==typeof r&&(r.GifRecorder=A),"undefined"===typeof r&&(e.exports=j,o=[],a=function(){return j}.apply(t,o),void 0===a||(e.exports=a)),"undefined"!==typeof r&&(r.MultiStreamRecorder=E),"undefined"!==typeof r&&(r.RecordRTCPromisesHandler=U),"undefined"!==typeof r&&(r.WebAssemblyRecorder=B)}).call(this,i("c8ba"),i("4362"))},aaf8:function(e,t,i){"use strict";i("dcad")},c204:function(e,t,i){},d1ae:function(e,t,i){"use strict";i("50d2")},dcad:function(e,t,i){},f108:function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"b-page-content"},[i("form",{ref:"dragUploadArea",staticClass:"b-create-post-form has-advanced-upload",attrs:{id:"make_post_form"},on:{submit:function(t){return t.preventDefault(),e.makePostSubmit(t)}}},[i("div",{ref:"makePost",staticClass:"b-make-post",class:{"m-with-paid-options":e.privatePost,"m-paid-text":e.lockDescription&&e.privatePost,"m-free-text":!e.lockDescription&&e.privatePost,"m-paid-poll":e.showPoll&&e.pollLocked&&e.privatePost,"m-free-poll":e.showPoll&&!e.pollLocked&&e.privatePost,"m-paid-media-active":e.paidMediaActive,"m-free-media-active":e.freeMediaActive,"m-media-on-center":e.mediaCentered,"m-paid-media-first-active":e.paidMediaFirstActive,"m-free-media-first-active":e.freeMediaFirstActive,"m-media-first-on-center":e.mediaFirstCentered,"m-paid-media-text":e.paidMediaText,"m-free-media-text":e.freeMediaText,"m-paid-media-audio":e.paidMediaAudio,"m-free-media-audio":e.freeMediaAudio,"m-free-audio":e.uploadedFilesAudio.length&&!e.audioLocked&&e.privatePost,"m-paid-audio":e.uploadedFilesAudio.length&&e.audioLocked&&e.privatePost,"m-chats-footer":e.isChat}},[e.defaultPollExpired>0||e.scheduleDate||e.saveForLater?i("div",{staticClass:"b-dropzone__previews b-make-post__schedule-expire-wrapper"},[e.defaultPollExpired>0?i("div",{staticClass:"b-dropzone__preview m-expire m-loaded b-post-piece g-pointer-cursor m-row",on:{click:e.openPostExpiration}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-clock"}),i("span",{staticClass:"b-post-piece__label"},[e._v(" "+e._s(e.$t("message.make_post_expire_preview_title"))+" ")]),i("span",{staticClass:"b-post-piece__value",domProps:{innerHTML:e._s(e.$t("message.make_post_expire_preview_value",{DAYS:e.pollExpired}))}}),i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.delete"),expression:"$t('message.delete')"}],staticClass:"b-dropzone__preview__delete g-btn m-rounded m-reset-width m-thumb-r-corner-pos m-btn-remove m-sm-icon-size",attrs:{type:"button"},on:{click:function(t){t.stopPropagation(),e.defaultPollExpired=0}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})])]):e._e(),e.scheduleDate||e.saveForLater?i("post-schedule-for-item",{attrs:{"schedule-date":e.scheduleDate,"save-for-later":e.saveForLater},on:{deleteScheduleForItem:e.deleteScheduleForItem},nativeOn:{click:function(t){return e.openScheduleDate(t)}}}):e._e()],1):e._e(),e.privatePost?i("div",{staticClass:"b-make-post__price-free-labels"},[i("div",{staticClass:"b-make-post__price-free-label m-free"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-price-free"}),e._v(" "+e._s(e.$t("message.make_post_free_preview_label"))+" ")]),i("div",{ref:"paidContentLabel",staticClass:"b-make-post__price-free-label m-paid",attrs:{"at-attr":"paid_msg_section"},on:{click:function(t){return t.preventDefault(),e.openModalPostPrice(t)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-price"}),e._v(" "+e._s(e.$t("message.make_post_price_to_view_label"))+" "),i("div",{staticClass:"b-make-post__price-free-label__price",attrs:{"at-attr":"msg_price"}},[e._v(" "+e._s(e.amountHumanShort(e.price))+" ")]),i("button",{staticClass:"b-dropzone__preview__delete g-btn m-rounded m-reset-width m-thumb-r-corner-pos m-btn-remove m-sm-icon-size",attrs:{type:"button",title:e.$t("message.delete"),"at-attr":"delete_msg_price"},on:{click:function(t){return t.stopPropagation(),e.deletePrice(t)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})])])]):e._e(),i("div",{staticClass:"b-make-post__main-wrapper"},[e.tipValue?i("div",{staticClass:"b-dropzone__preview m-tip b-post-piece m-row m-loaded"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-funds"}),e._v(" "+e._s(e.$t("message.tips_table_heading"))+" "),i("div",{staticClass:"b-post-piece__value"},[e._v(" "+e._s(e.$t("message.chat_message_on_tip_new",{SUMM:e.amountHumanShort(e.tipValue)}))+" ")]),i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.delete"),expression:"$t('message.delete')"}],staticClass:"b-dropzone__preview__delete g-btn m-rounded m-reset-width m-thumb-r-corner-pos m-btn-remove m-sm-icon-size",attrs:{type:"button"},on:{click:e.onDeleteTip}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})])]):e._e(),e.showPoll?i("polling",{attrs:{type:e.votingType,"voting-options":e.votingOptions,"voting-correct-index":e.votingCorrectIndex,"voting-duration":e.votingDuration,locked:e.pollLocked,"is-private-post":e.privatePost,disabled:e.pollControlDisabled,"disabled-toggle":e.isDisabledToggleLockPoll},on:{"update:votingOptions":function(t){e.votingOptions=t},"update:voting-options":function(t){e.votingOptions=t},"update:votingCorrectIndex":function(t){e.votingCorrectIndex=t},"update:voting-correct-index":function(t){e.votingCorrectIndex=t},"update:votingDuration":function(t){e.votingDuration=t},"update:voting-duration":function(t){e.votingDuration=t},"update:locked":function(t){e.pollLocked=t},hide:function(t){return e.showPollHandler(!1)}}}):e._e(),e.showFundraising?i("fundraising",{attrs:{options:e.fundraisingOptions,target:e.fundraisingTarget,min:e.authUser.tipsMin,max:e.fundraisingPresetMax,"has-errors":e.isFundrisingOptionsErrors},on:{"update:options":function(t){e.fundraisingOptions=t},"update:target":function(t){e.fundraisingTarget=t},"update:hasErrors":function(t){e.isFundrisingOptionsErrors=t},"update:has-errors":function(t){e.isFundrisingOptionsErrors=t},hide:function(t){return e.showFundraisingHandler(!1)},toggleFundingPanel:e.toggleFundingPanel}}):e._e(),e.uploadedFilesAudio.length?i("div",{staticClass:"b-make-post__media audio-post b-dropzone__previews b-paid-post-content",class:{"m-free-post":e.uploadedFilesAudio.length&&!e.audioLocked&&e.privatePost,"m-paid-post":e.uploadedFilesAudio.length&&e.audioLocked&&e.privatePost}},[e.audioLocked&&e.privatePost?i("button",{staticClass:"b-make-post__move-btn m-text m-left",attrs:{type:"button"},on:{click:e.toggleAudioLocked}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})]):e._e(),i("div",{staticClass:"b-paid-post-content__inside"},e._l(e.uploadedFilesAudio,(function(t,s){return i("upload-preview",{key:t.orderId,attrs:{file:t,index:s,post:e.post,"search-face":e.isAnyMoreThanOneFace},on:{deleteFile:e.onDeleteFile}})})),1),!e.audioLocked&&e.privatePost?i("button",{staticClass:"b-make-post__move-btn m-text m-right",attrs:{type:"button"},on:{click:e.toggleAudioLocked}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-right"})]):e._e()]):e._e(),e.uploadedFilesWithoutAudio.length?i("div",{ref:"postMedia",staticClass:"b-make-post__media files b-dropzone__previews m-native-custom-scrollbar m-scrollbar-x m-invisible-scrollbar b-paid-post-content m-exception-scrolling",on:{scroll:e.scrollPreviews}},[e.privatePost?[e.isMobile?i("div",{ref:"scrollbarFree",staticClass:"b-make-post__media-slider b-dropzone__previews-scroller m-custom-scrollbar m-free",class:{"m-draggable":e.isDraggingPreviews,"m-empty":!e.getFreeFilesWithoutAudio.length}},[i("div",{staticClass:"b-make-post__media-slider__inner m-native-custom-scrollbar m-scrollbar-x m-invisible-scrollbar"},[e.getFreeFilesWithoutAudio.length?[e.isDraggingPreviews?i("draggable",{ref:"draggable-container-free",staticClass:"b-make-post__media-photos b-photos",attrs:{handle:".js-handle"},model:{value:e.freeFilesWithoutAudioList,callback:function(t){e.freeFilesWithoutAudioList=t},expression:"freeFilesWithoutAudioList"}},e._l(e.freeFilesWithoutAudioList,(function(t,s){return i("div",{key:s,staticClass:"b-make-post__preview m-draggable"},[i("div",{staticClass:"b-dropzone__preview m-loaded"},[e.getThumb(t)?i("img",{staticClass:"b-dropzone__preview__media",attrs:{src:e.getThumb(t),alt:t.name}}):i("span",{staticClass:"b-dropzone__preview__name"},[e._v(" "+e._s(t.name)+" ")])]),i("button",{staticClass:"checkbox-item m-pos-left-top b-make-post__set-order-btn",class:{selected:e.getPreviewOrder(t.orderId)},attrs:{type:"button"},on:{click:function(i){return e.setPreviewOrder(t.orderId)}}},[i("div",{staticClass:"checkbox-item__inside"},[i("span",{staticClass:"b-input-ripple"}),i("span",{staticClass:"checkbox-item__num",domProps:{innerHTML:e._s(e.getPreviewOrder(t.orderId))}})])]),i("button",{staticClass:"b-make-post__preview__drag-icon js-handle",attrs:{type:"button"}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-drag"})])])})),0):i("div",{staticClass:"b-make-post__media-photos b-photos"},e._l(e.getFreeFilesWithoutAudio,(function(t,s){return i("upload-preview",{key:t.orderId,class:{"m-square":e.squarePreviews&&"photo"===t.mediaType},attrs:{file:t,index:s,post:e.post,"search-face":e.isAnyMoreThanOneFace,"show-editor":!1},on:{deleteFile:e.onDeleteFile,openPreview:e.openPreview,saveEditedImage:e.onSaveEditedImage,saveAsCopyEditedImage:e.saveAsCopyEditedImage,updateThumbId:function(i){return e.updateFileThumbId(t,i)}}})})),1)]:e._e(),!e.isDraggingPreviews&&e.getPrimaryFilesWithoutAudio.length?i("button",{staticClass:"b-make-post__sort-btns m-btn",attrs:{type:"button"},on:{click:e.enableDraggablePreviews}},[i("span",{staticClass:"b-make-post__sort-btn m-left"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})])]):e._e()],2)]):i("div",{staticClass:"b-make-post__media-slider m-free",class:{"m-draggable":e.isDraggingPreviews,"m-empty":!e.getFreeFilesWithoutAudio.length}},[i("swiper",{key:"private-"+e.swiperKey,ref:"scrollbarFree",staticClass:"b-dropzone__previews-scroller m-custom-scrollbar",attrs:{options:{slidesPerView:"auto",freeMode:!0,watchOverflow:!0,mousewheel:!0}}},[i("swiper-slide",[e.getFreeFilesWithoutAudio.length?[e.isDraggingPreviews?i("draggable",{ref:"draggable-container-free",staticClass:"b-make-post__media-photos b-photos",attrs:{handle:".js-handle",move:e.onPreviewMoveFree},model:{value:e.freeFilesWithoutAudioList,callback:function(t){e.freeFilesWithoutAudioList=t},expression:"freeFilesWithoutAudioList"}},e._l(e.freeFilesWithoutAudioList,(function(t,s){return i("div",{key:s,staticClass:"b-make-post__preview m-draggable"},[i("div",{staticClass:"b-dropzone__preview m-loaded"},[e.getThumb(t)?i("img",{staticClass:"b-dropzone__preview__media",attrs:{src:e.getThumb(t),alt:t.name}}):i("span",{staticClass:"b-dropzone__preview__name"},[e._v(" "+e._s(t.name)+" ")])]),i("button",{staticClass:"checkbox-item m-pos-left-top b-make-post__set-order-btn",class:{selected:e.getPreviewOrder(t.orderId)},attrs:{type:"button"},on:{click:function(i){return e.setPreviewOrder(t.orderId)}}},[i("div",{staticClass:"checkbox-item__inside"},[i("span",{staticClass:"b-input-ripple"}),i("span",{staticClass:"checkbox-item__num",domProps:{innerHTML:e._s(e.getPreviewOrder(t.orderId))}})])]),i("button",{staticClass:"b-make-post__preview__drag-icon swiper-no-swiping js-handle",attrs:{type:"button"}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-drag"})])])})),0):i("div",{staticClass:"b-make-post__media-photos b-photos"},e._l(e.getFreeFilesWithoutAudio,(function(t,s){return i("upload-preview",{key:t.orderId,class:{"m-square":e.squarePreviews&&"photo"===t.mediaType},attrs:{file:t,index:s,post:e.post,"search-face":e.isAnyMoreThanOneFace,"show-editor":!1},on:{deleteFile:e.onDeleteFile,openPreview:e.openPreview,saveEditedImage:e.onSaveEditedImage,saveAsCopyEditedImage:e.saveAsCopyEditedImage,updateThumbId:function(i){return e.updateFileThumbId(t,i)}}})})),1)]:e._e(),e.isDraggingPreviews||!e.getPrimaryFilesWithoutAudio.length||e.privatePost?e._e():i("button",{staticClass:"b-make-post__sort-btns m-btn",attrs:{type:"button"},on:{click:e.enableDraggablePreviews}},[e.getPrimaryFilesWithoutAudio.length?i("span",{staticClass:"b-make-post__sort-btn m-left"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})]):e._e(),i("span",{staticClass:"b-make-post__sort-btn m-right"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-right"})])])],2)],1),!e.isDraggingPreviews&&e.getPrimaryFilesWithoutAudio.length&&e.privatePost?i("button",{staticClass:"b-make-post__sort-btns m-btn",attrs:{type:"button"},on:{click:e.enableDraggablePreviews}},[i("span",{staticClass:"b-make-post__sort-btn m-left"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})])]):e._e()],1)]:e._e(),e.isMobile?i("div",{ref:"scrollbarPaid",staticClass:"b-make-post__media-slider b-dropzone__previews-scroller m-custom-scrollbar",class:{"m-draggable":e.isDraggingPreviews,"m-paid":e.privatePost,"m-empty":!e.getPrimaryFilesWithoutAudio.length}},[i("div",{staticClass:"b-make-post__media-slider__inner m-native-custom-scrollbar m-scrollbar-x m-invisible-scrollbar",class:{"m-tip":e.getPrimaryFilesWithoutAudio.length&&e.hasFileTypeTip}},[e.getPrimaryFilesWithoutAudio.length?[e.isDraggingPreviews?i("draggable",{ref:"draggable-container-paid",staticClass:"b-make-post__media-photos b-photos",attrs:{handle:".js-handle"},model:{value:e.uploadedFilesWithoutAudioList,callback:function(t){e.uploadedFilesWithoutAudioList=t},expression:"uploadedFilesWithoutAudioList"}},e._l(e.uploadedFilesWithoutAudioList,(function(t,s){return i("div",{key:s,staticClass:"b-make-post__preview m-draggable"},[i("div",{staticClass:"b-dropzone__preview m-loaded"},[e.getThumb(t)?i("img",{staticClass:"b-dropzone__preview__media",attrs:{src:e.getThumb(t),alt:t.name}}):i("span",{staticClass:"b-dropzone__preview__name"},[e._v(" "+e._s(t.name)+" ")])]),i("button",{staticClass:"checkbox-item m-pos-left-top b-make-post__set-order-btn",class:{selected:e.getPreviewOrder(t.orderId)},attrs:{type:"button"},on:{click:function(i){return e.setPreviewOrder(t.orderId)}}},[i("div",{staticClass:"checkbox-item__inside"},[i("span",{staticClass:"b-input-ripple"}),i("span",{staticClass:"checkbox-item__num",domProps:{innerHTML:e._s(e.getPreviewOrder(t.orderId))}})])]),i("button",{staticClass:"b-make-post__preview__drag-icon js-handle",attrs:{type:"button"}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-drag"})])])})),0):i("div",{staticClass:"b-make-post__media-photos b-photos"},e._l(e.getPrimaryFilesWithoutAudio,(function(t,s){return i("upload-preview",{key:t.orderId,class:{"m-square":e.squarePreviews&&"photo"===t.mediaType},attrs:{file:t,index:s,post:e.post,"search-face":e.isAnyMoreThanOneFace,"show-editor":e.isChat},on:{deleteFile:e.onDeleteFile,openPreview:e.openPreview,saveEditedImage:e.onSaveEditedImage,saveAsCopyEditedImage:e.saveAsCopyEditedImage,updateThumbId:function(i){return e.updateFileThumbId(t,i)}}})})),1)]:e._e(),e.fileUploadDisabled||!e.uploadedFilesWithoutAudio.length||e.isDraggingPreviews?e._e():i("button",{staticClass:"button-add-media",attrs:{type:"button"},on:{click:e.fileUploadChange}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-add"})]),!e.isDraggingPreviews&&(e.uploadedFilesWithoutAudio.length>1&&!e.privatePost||e.getFreeFilesWithoutAudio.length)?i("button",{staticClass:"b-make-post__sort-btns m-btn",attrs:{type:"button"},on:{click:e.enableDraggablePreviews}},[e.privatePost?e._e():i("span",{staticClass:"b-make-post__sort-btn m-left"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})]),!e.privatePost||e.getFreeFilesWithoutAudio.length?i("span",{staticClass:"b-make-post__sort-btn m-right"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-right"})]):e._e()]):e._e()],2)]):i("div",{staticClass:"b-make-post__media-slider",class:{"m-paid":e.privatePost,"m-draggable":e.isDraggingPreviews,"m-empty":!e.getPrimaryFilesWithoutAudio.length}},[!e.isDraggingPreviews&&e.privatePost&&e.getFreeFilesWithoutAudio.length?i("button",{staticClass:"b-make-post__sort-btns m-btn",attrs:{type:"button"},on:{click:e.enableDraggablePreviews}},[i("span",{staticClass:"b-make-post__sort-btn m-right"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-right"})])]):e._e(),i("swiper",{ref:"scrollbarPaid",staticClass:"b-dropzone__previews-scroller m-custom-scrollbar",attrs:{options:{slidesPerView:"auto",freeMode:!0,watchOverflow:!0,mousewheel:!0}}},[i("swiper-slide",[e.getPrimaryFilesWithoutAudio.length?[e.isDraggingPreviews?i("draggable",{ref:"draggable-container-paid",staticClass:"b-make-post__media-photos b-photos",attrs:{handle:".js-handle",move:e.onPreviewMovePaid},model:{value:e.uploadedFilesWithoutAudioList,callback:function(t){e.uploadedFilesWithoutAudioList=t},expression:"uploadedFilesWithoutAudioList"}},e._l(e.uploadedFilesWithoutAudioList,(function(t,s){return i("div",{key:s,staticClass:"b-make-post__preview m-draggable"},[i("div",{staticClass:"b-dropzone__preview m-loaded"},[e.getThumb(t)?i("img",{staticClass:"b-dropzone__preview__media",attrs:{src:e.getThumb(t),alt:t.name}}):i("span",{staticClass:"b-dropzone__preview__name"},[e._v(" "+e._s(t.name)+" ")])]),i("button",{staticClass:"checkbox-item m-pos-left-top b-make-post__set-order-btn",class:{selected:e.getPreviewOrder(t.orderId)},attrs:{type:"button"},on:{click:function(i){return e.setPreviewOrder(t.orderId)}}},[i("div",{staticClass:"checkbox-item__inside"},[i("span",{staticClass:"b-input-ripple"}),i("span",{staticClass:"checkbox-item__num",domProps:{innerHTML:e._s(e.getPreviewOrder(t.orderId))}})])]),i("button",{staticClass:"b-make-post__preview__drag-icon swiper-no-swiping js-handle",attrs:{type:"button"}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-drag"})])])})),0):i("div",{staticClass:"b-make-post__media-photos b-photos"},e._l(e.getPrimaryFilesWithoutAudio,(function(t,s){return i("upload-preview",{key:t.orderId,class:{"m-square":e.squarePreviews&&"photo"===t.mediaType},attrs:{file:t,index:e.getFreeFilesWithoutAudio.length+s,post:e.post,"search-face":e.isAnyMoreThanOneFace,"show-editor":e.isChat},on:{deleteFile:e.onDeleteFile,openPreview:e.openPreview,saveEditedImage:e.onSaveEditedImage,saveAsCopyEditedImage:e.saveAsCopyEditedImage,updateThumbId:function(i){return e.updateFileThumbId(t,i)}}})})),1)]:e._e(),e.fileUploadDisabled||!e.uploadedFilesWithoutAudio.length||e.isDraggingPreviews?e._e():i("button",{staticClass:"button-add-media",attrs:{type:"button"},on:{click:e.fileUploadChange}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-add"})]),!e.isDraggingPreviews&&e.uploadedFilesWithoutAudio.length>1&&!e.privatePost?i("button",{staticClass:"b-make-post__sort-btns m-btn",attrs:{type:"button"},on:{click:e.enableDraggablePreviews}},[i("span",{staticClass:"b-make-post__sort-btn m-left"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})]),i("span",{staticClass:"b-make-post__sort-btn m-right"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-right"})])]):e._e()],2)],1)],1),e.isDraggingPreviews?i("div",{staticClass:"b-make-post__sort-btns"},[i("button",{staticClass:"b-make-post__sort-btn m-dragging-btns",class:{"m-move-all":!e.previewsOrder.length&&e.paidMediaWithoutAudio.length},attrs:{type:"button",disabled:!e.previewsOrder.length&&!e.paidMediaWithoutAudio.length},on:{click:e.movePreviewsToBeginning}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})]),i("button",{staticClass:"b-make-post__sort-btn m-dragging-btns",class:{"m-move-all":!e.previewsOrder.length&&e.freeMediaWithoutAudio.length},attrs:{type:"button",disabled:!e.previewsOrder.length&&!e.freeMediaWithoutAudio.length},on:{click:e.movePreviewsToEnd}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-right"})]),i("button",{staticClass:"b-make-post__sort-done-btn",attrs:{type:"button"},on:{click:e.savePreviewsOrder}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-done"})])]):e._e()],2):e._e(),i("div",{staticClass:"b-make-post__wrapper b-paid-post-content m-textarea-post",class:{"m-paid-post":e.lockDescription&&e.privatePost,"m-free-post":!e.lockDescription&&e.privatePost}},[!e.lockDescription&&e.privatePost?i("button",{staticClass:"b-make-post__move-btn m-text m-right",attrs:{type:"button"},on:{click:e.toggleLockDescription}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-right"})]):e._e(),i("div",{staticClass:"b-make-post__textarea-price-wrapper b-paid-post-content__inside"},[e.lockDescription&&e.privatePost?i("button",{staticClass:"b-make-post__move-btn m-text m-left",attrs:{type:"button"},on:{click:e.toggleLockDescription}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})]):e._e(),i("div",{staticClass:"b-make-post__textarea-wrapper"},[i("input-o-f",{directives:[{name:"show",rawName:"v-show",value:!e.isForbiddenError,expression:"!isForbiddenError"}],ref:"textarea",staticClass:"m-no-border m-placeholder-full-lgray m-reset-bottom-gap b-make-post__text-input",class:{"size-collapse":e.hasAssets},attrs:{id:"new_post_text_input",type:"textarea",placeholder:e.makePostPlaceholder,disabled:e.postTextDisabled,rows:1,autogrow:"",maxlength:1e4},on:{click:e.textareaClick,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.onKeyDownEnter(t)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.makeSubmitMessageEnter(t)},input:e.typingMessage,focus:e.onFocus},model:{value:e.text,callback:function(t){e.text=t},expression:"text"}}),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isForbiddenError,expression:"isForbiddenError"}],staticClass:"b-make-post__text-input m-native-custom-scrollbar m-forbidden-text m-scrollbar-y",domProps:{innerHTML:e._s(e.textHighLight)},on:{click:e.resetForbiddenError}})],1)]),e.fakeMode&&e.authUser.isTwitterConnected&&e.authUser.twitterUsername&&!e.editPost?i("span",{staticClass:"g-btn__tweet m-with-round-hover g-btn m-icon m-icon-only m-sm-size m-gray"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.fakeTweetSend,expression:"fakeTweetSend"}],attrs:{id:"new_post_tweet_send_fake",type:"checkbox"},domProps:{checked:Array.isArray(e.fakeTweetSend)?e._i(e.fakeTweetSend,null)>-1:e.fakeTweetSend},on:{change:function(t){var i=e.fakeTweetSend,s=t.target,o=!!s.checked;if(Array.isArray(i)){var a=null,r=e._i(i,a);s.checked?r<0&&(e.fakeTweetSend=i.concat([a])):r>-1&&(e.fakeTweetSend=i.slice(0,r).concat(i.slice(r+1)))}else e.fakeTweetSend=o}}}),i("label",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.post_on_twitter"),expression:"$t('message.post_on_twitter')"}],attrs:{for:"new_post_tweet_send_fake"}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],class:e.fakeTweetSend?"icon-on-twitter":"icon-twitter"})])]):e._e()])],1),e.shouldShowAddToLabelsBtns?i("div",{staticClass:"b-make-post__add_labels"},[i("add-to-labels-btns",{attrs:{post:e.post||{},"create-post-mode":!e.post,"draft-post-labels":e.draftPostLabels,"edit-post-mode":!!e.post&&e.editPost,"toggle-label-func":e.addLabelsToPost}})],1):e._e(),e.isChat?e._e():i("div",{staticClass:"b-line-over-actions"}),i("div",{staticClass:"b-make-post__actions",class:{"m-more-gap":e.price,"m-native-custom-scrollbar m-scrollbar-x m-invisible-scrollbar":e.isMobile}},[e.onlyFriends?e._e():i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.post_add_media"),expression:"$t('message.post_add_media')"}],staticClass:"attach_file g-btn m-flat m-gray m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{id:"attach_file_photo",type:"button",disabled:e.fileUploadDisabled},on:{click:e.fileUploadChange}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-media"})]),e.withUser&&e.withUser.tipsEnabled&&e.isChat?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.send_a_tip_button_messages"),expression:"$t('message.send_a_tip_button_messages')"}],staticClass:"g-btn m-flat m-gray b-chat__send-tip-btn m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{type:"button","at-attr":"send_tip",disabled:e.disabledTipsBtn},on:{click:e.openTipPanel}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-funds"})]):e._e(),e.hasVideoMessageBtn?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.tooltip_record_video"),expression:"$t('message.tooltip_record_video')"}],ref:"videoMessageBtn",staticClass:"g-btn m-flat m-gray b-chat__video-record-btn js-chat__video-record-btn m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{type:"button",disabled:!e.canEditMedia,"data-state":""},on:{click:e.onRecordVideoClick}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-video"})]):e._e(),e.authUser.isPerformer&&!e.onlyFriends?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.post_record_voice"),expression:"$t('message.post_record_voice')"}],ref:"audioRecordBtn",staticClass:"g-btn m-flat m-gray m-with-round-hover m-size-md-hover m-default-icon-size m-no-uppercase m-reset-width",attrs:{id:"js-audioRecordBtn",type:"button",disabled:!e.canEditMedia||!!e.uploadedFilesAudio.length},on:{click:e.onRecordAudioClick}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-voice"})]):e._e(),!e.onlyFriends&&e.authUser.isPerformer?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.add_media_from_vault"),expression:"$t('message.add_media_from_vault')"}],staticClass:"g-btn m-flat m-gray m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{type:"button","at-attr":"add_vault_media",disabled:e.fileUploadDisabled},on:{click:e.openVaultModal}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-vault"})]):e._e(),e.fakeMode?[i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.tooltip_more"),expression:"$t('message.tooltip_more')"}],staticClass:"g-btn m-flat m-gray b-make-post__more-btn m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{type:"button"},on:{click:function(t){return e.openNewPostPage()}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-more"})]),e.authUser.canStreaming?i("router-link",{staticClass:"b-make-post__streaming-link g-btn m-flat m-btn-gaps",attrs:{to:{name:"Streaming"}}},[i("span",{staticClass:"g-btn__label"},[e._v(e._s(e.$t("message.make_post_streaming_button_title")))]),i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-live"})]):e._e()]:[e.isChat||e.isTemplate?e._e():i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.post_add_poll"),expression:"$t('message.post_add_poll')"}],staticClass:"g-btn m-flat m-gray b-make-post__voting-btn m-with-round-hover m-size-md-hover d-none d-sm-block m-default-icon-size m-reset-width",attrs:{type:"button",disabled:e.voteDisabled,"at-attr":"add_poll"},on:{click:function(t){return e.showPollHandler(!0,e.POLL)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-poll"})]),e.isChat||e.isTemplate?e._e():i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.post_add_quiz"),expression:"$t('message.post_add_quiz')"}],staticClass:"g-btn m-flat m-gray b-make-post__voting-btn m-with-round-hover m-size-md-hover d-none d-sm-block m-default-icon-size m-reset-width",attrs:{type:"button",disabled:e.voteDisabled||e.authUser.isDeleteInitiated,"at-attr":"add_quiz"},on:{click:function(t){return e.showPollHandler(!0,e.QUIZ)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-quiz"})]),!e.authUser.canMakeExpirePosts||e.isChat||e.isTemplate?e._e():i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.post_expiration_period"),expression:"$t('message.post_expiration_period')"}],staticClass:"g-btn m-flat m-gray b-make-post__expire-period-btn m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{type:"button",disabled:e.postExpirationDisabled},on:{click:e.openPostExpiration}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-clock"})]),e.isShowScheduleDate?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.isChat?e.$t("message.chat_scheduled"):e.$t("message.post_shedule"),expression:"isChat ? $t('message.chat_scheduled') : $t('message.post_shedule')"}],staticClass:"g-btn m-flat m-gray b-make-post__datepicker-btn m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{type:"button","at-attr":"scheduled_msg",disabled:e.scheduleDateDisabled},on:{click:e.openScheduleDate}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-schedule"})]):e._e(),!e.authUser.canCreateFundRaising||e.isChat||e.isTemplate?e._e():i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.post_set_fundraising_target_title"),expression:"$t('message.post_set_fundraising_target_title')"}],staticClass:"g-btn m-flat m-gray m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{disabled:e.fundraisingDisabled},on:{click:function(t){return t.preventDefault(),e.toggleFundingPanel(t)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-fundraising"})]),e.isShowPriceBtn&&!e.onlyFriends?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.priceBtnTooltip,expression:"priceBtnTooltip"}],staticClass:"g-btn m-flat m-gray m-with-round-hover m-size-md-hover m-default-icon-size m-reset-width",attrs:{"at-attr":"price_btn",disabled:e.isDisablePriceBtn},on:{click:function(t){return t.preventDefault(),e.openModalPostPrice(t)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-price"})]):e._e(),e.isChat||e.isTemplate?e._e():i("b-dropdown",{directives:[{name:"dropdown-autohide",rawName:"v-dropdown-autohide"}],staticClass:"b-post__tools__more m-not-width-limit m-size-lg m-center d-block d-sm-none",attrs:{right:"","toggle-class":"m-post-btn m-gray",variant:"link",offset:"4"},scopedSlots:e._u([{key:"button-content",fn:function(){return[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"},{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.tooltip_more"),expression:"$t('message.tooltip_more')"}],staticClass:"icon-more"})]},proxy:!0}],null,!1,3620457837)},[i("b-dropdown-item-button",{staticClass:"m-flex-item",attrs:{type:"button",disabled:e.voteDisabled},on:{click:function(t){return e.showPollHandler(!0,e.POLL)}}},[i("div",{staticClass:"b-dropdown__item-icon m-light-gray-color"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-poll"})]),i("span",{staticClass:"b-dropdown__item-text"},[e._v(" "+e._s(e.$t("message.post_poll"))+" ")])]),i("b-dropdown-item-button",{staticClass:"m-flex-item",attrs:{type:"button",disabled:e.voteDisabled||e.authUser.isDeleteInitiated},on:{click:function(t){return e.showPollHandler(!0,e.QUIZ)}}},[i("div",{staticClass:"b-dropdown__item-icon m-light-gray-color"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-quiz"})]),i("span",{staticClass:"b-dropdown__item-text"},[e._v(" "+e._s(e.$t("message.post_quiz"))+" ")])])],1)],e.isChat?i("button",{staticClass:"g-btn m-rounded b-chat__btn-submit",attrs:{type:"button","at-attr":"send_btn",disabled:e.disabledSubmit},on:{click:e.makeSubmitMessage}},[e._v(" "+e._s(e.getSubmitBtnText)+" ")]):e._e()],2),i("datetime",{ref:"scheduleDatepicker",staticClass:"b-make-post__datepicker-input custom-datepicker",attrs:{format:{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"},"use12-hour":"fr"!==e.$i18n.locale,"min-datetime":e.minDatetime,type:"datetime",title:e.isChat?e.$t("message.chat_scheduled"):e.$t("message.datepicker_popup_title"),"show-tabs":""},on:{close:e.closeScheduleDate},scopedSlots:e._u([{key:"button-cancel",fn:function(){return[i("button",{staticClass:"g-btn m-flat m-btn-gaps custom-datepicker-button-cancel",attrs:{type:"button"}},[e._v(" "+e._s(e.$t("message.cancel_button"))+" ")]),e.isChat?e._e():i("button",{staticClass:"g-btn m-flat m-btn-gaps custom-datepicker-button-save-later",attrs:{type:"button"},on:{click:e.setSaveForLater}},[e._v(" "+e._s(e.$t("message.save_for_later_button"))+" ")])]},proxy:!0},{key:"button-confirm",fn:function(t){var s=t.step;return[i("button",{staticClass:"g-btn m-flat m-btn-gaps",attrs:{type:"button"}},[e._v(" "+e._s("date"===s?e.$t("message.next_button"):e.$t("message.confirm_ok_button"))+" ")])]}}]),model:{value:e.scheduleDate,callback:function(t){e.scheduleDate=t},expression:"scheduleDate"}}),i("div",{staticClass:"b-dropzone__label"},[e._v(" "+e._s(e.$t("message.fileupload_drop_label"))+" ")])],1)]),e.makePostError?i("hint-reminder",{attrs:{type:"error",html:e.makePostError},on:{click:e.innerLinkToRouter}}):e._e(),"Chat"===e.$route.name?i("chat-info",{attrs:{chat:e.chat,"with-user":e.withUser,"tip-value":e.tipValue,text:e.text}}):e._e(),e.showMediaHint?i("hint-reminder",{attrs:{text:e.$t("message.do_not_forget_attachments"),"has-nav":"","has-video-rec-btn":e.hasVideoMessageBtn},on:{mediaUploadClick:e.fileUploadChange,videoRecClick:e.triggerRecVideo,voiceRecClick:e.toggleRecordPanel}}):e._e(),e.authUser.isDeleteInitiated&&e.editOrCreatePostPage?i("alert-o-f",{attrs:{text:e.$t("message.index_delete_initiated",{SETTINGS_URL:"/my/settings/account/delete"}),"full-width":""}}):e._e(),i("AudioInput",{directives:[{name:"show",rawName:"v-show",value:e.isShowRecordPanel,expression:"isShowRecordPanel"}],on:{closeRecordPanel:e.toggleRecordPanel,uploadAudio:e.uploadAudio}}),e.isShowPriceBtn?i("modal-post-price",{attrs:{"default-price":e.price,"set-price":e.setPrice,title:e.modalPriceTitle,"is-chat":e.isChat}}):e._e(),e.authUser.canCreateFundRaising?i("modal-post-funding",{attrs:{"toggle-funding-panel":e.toggleFundingPanel,"default-target":e.fundraisingTarget,"set-target":e.setTarget}}):e._e(),i("modal-post-period",{attrs:{title:e.$t("message.make_post_expire_popup_title"),name:"ModalPostExpiration",period:e.defaultPollExpired},on:{"update:period":function(t){e.defaultPollExpired=t}}}),!e.fakeMode&&e.authUser.isPerformer?i("modal-media-vault",{attrs:{"selected-limit":e.vaultLimit,ids:e.addedVaultMediaIds},on:{addVaultFiles:e.addVaultFiles}}):e._e(),!e.fakeMode&&e.authUser.isPerformer?i("media-vault-lists"):e._e(),e.showVideoMessage&&!e.fakeMode?i("videomessage",{attrs:{"open-video-record-on-load":e.openVideoRecordOnLoad},on:{uploadVideo:e.uploadVideo}}):e._e()],1)},o=[],a=(i("8e6e"),i("55dd"),i("75fc")),r=(i("6b54"),i("a481"),i("96cf"),i("3b8d")),n=(i("7514"),i("20d6"),i("ac6a"),i("456d"),i("6762"),i("2fdb"),i("bd86")),d=(i("c5f6"),i("2ef0")),c=i("9029"),l=i("5a0c"),u=i.n(l),h=i("23ad"),p=i.n(h),m=i("859b"),f=(i("d355"),i("b76a")),g=i.n(f),v=i("5892"),b=i("a836"),w=i("d634"),_=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-modal",{ref:e.name,attrs:{id:e.name,centered:"",size:"sm","body-class":"m-reset-body-padding-bottom"},on:{shown:e.onShowModalHandler},scopedSlots:e._u([{key:"modal-header",fn:function(){return[i("h4",{staticClass:"modal-title"},[e._v(" "+e._s(e.title)+" ")])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",attrs:{type:"button"},on:{click:function(t){e.show=!1}}},[e._v(" "+e._s(e.$t("message.cancel_button"))+" ")]),i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",attrs:{type:"button",disabled:e.periodValue>30},on:{click:e.saveChanges}},[e._v(" "+e._s(e.$t("message.save_button"))+" ")])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("input-o-f",{directives:[{name:"validate",rawName:"v-validate",value:"max_value:30",expression:"'max_value:30'"}],ref:"inputPeriod",staticClass:"m-gap-xms",class:{"m-placeholder-text-color":!e.inputFocusState},attrs:{type:"number",name:"periodValue",maxlength:3,autocomplete:!1,"suffix-value":e.inputSuffixValue,"help-text":e.errors.first("periodValue")?"":e.$t("message.select_below_or_enter_title"),placeholder:e.$t("message.no_limit_title"),error:e.errors.first("periodValue")&&e.errorText,"always-show-errors":""},on:{focus:e.onInputFocus,blur:e.onInputBlur,input:e.onInputChange},model:{value:e.periodValue,callback:function(t){e.periodValue=e._n(t)},expression:"periodValue"}}),i("div",{staticClass:"b-tabs__nav m-tab-rounded m-reset-mb m-single-current m-wrap"},[i("swiper",{ref:"daysPeriodSwiper",staticClass:"m-gaps-inside m-gaps-outside m-slide-width-auto",attrs:{options:e.swiperOptions}},e._l(e.periodDaysList,(function(t){return i("swiper-slide",{key:t.code},[i("button",{staticClass:"b-tabs__nav__item",class:{"m-current":e.isCurrentPeriod(t)},attrs:{type:"button"},on:{click:function(i){return i.preventDefault(),e.changePeriodValue(t.code)}}},[i("span",{staticClass:"b-tabs__nav__text"},[e._v(" "+e._s(t.name)+" ")])])])})),1)],1)],1)},y=[],C=i("13ca"),P=i("4ead"),k={name:"ModalPostPeriod",components:{InputOF:C["a"]},mixins:[P["a"]],props:{title:{type:String,default:""},period:{type:Number,default:0},name:{type:String,required:!0}},data:function(){return{show:!1,inputFocusState:!1,periodDays:[0,1,3,7,30],periodValue:0,swiperOptions:{slidesPerView:"auto",watchOverflow:!0,spaceBetween:8,watchSlidesVisibility:!0,mousewheel:!0,init:!1}}},computed:{periodDaysList:function(){var e=this;return this.periodDays.map((function(t){return{code:t,name:e.periodLabel(t)}}))},daysValue:function(){return this.periodLabel(this.periodValue)},errorText:function(){return"".concat(this.$t("message.max_price_label_without_currency",{MAX:30})," ").concat(this.$t("message.days"))},inputSuffixValue:function(){return 1===this.periodValue?this.$t("message.day"):this.periodValue>1?this.$t("message.days"):""}},watch:{period:{handler:function(e){this.changePeriodValue(e)},immediate:!0}},methods:{periodLabel:function(e){return e>0?this.$tc("message.count_day_plural_new",e,{COUNT:e}):this.$t("message.no_limit_title")},changePeriodValue:function(e){this.periodValue=0===e?void 0:e},saveChanges:function(){this.show=!1,this.$emit("update:period",this.periodValue)},onShowModalHandler:function(){this.$refs.daysPeriodSwiper.swiperInstance.init()},isCurrentPeriod:function(e){return!this.periodValue&&!e.code||this.periodValue===e.code},onInputFocus:function(){this.inputFocusState=!0},onInputBlur:function(){this.inputFocusState=!1},onInputChange:function(){var e=this;0===this.periodValue&&(this.$refs.inputPeriod.blur(),this.$nextTick((function(){e.periodValue=void 0})))}}},S=k,x=i("2877"),M=Object(x["a"])(S,_,y,!1,null,null,null),O=M.exports,D=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"b-dropzone__preview",class:{"m-loaded":e.isFileLoaded,"m-audio":"audio"===e.file.mediaType,"m-error":e.file.error}},[e.isMediaInCurrentlyProcessing?i("div",{staticClass:"post_media m-processing m-default-bg"},[i("div",{staticClass:"b-processing-content"},[i("spinner-loader",{staticClass:"b-spinner-processing"}),e._v(" "+e._s(e.$t("message.media_currently_processing"))+" ")],1)]):e._e(),e.file.error||e.getHasError?e._e():[e.file.url?["photo"===e.file.mediaType||"gif"===e.file.mediaType?i("a",{staticClass:"media-file m-default-bg m-media-el",attrs:{href:e.fileUrl},on:{click:function(t){return t.preventDefault(),e.openPreview(t)}}},[i("img",{staticClass:"b-dropzone__preview__media",attrs:{src:e.fileUrlPreview,alt:e.file.name,title:e.file.name},on:{error:e.getFileError}})]):e._e(),"video"===e.file.mediaType&&e.isFileLoaded&&"DELETE"===e.file.deleteType?[e.file.processId?e._e():i("a",{staticClass:"js-dropzone__video-lightbox-link",attrs:{href:e.uploadedVideoUrl},on:{click:function(t){return t.preventDefault(),e.openPreview(t)}}},[e.videoPoster?i("img",{staticClass:"b-dropzone__preview__media",attrs:{alt:e.file.name,title:e.file.name,src:e.videoPoster}}):e._e(),i("span",{staticClass:"b-dropzone__preview__play-btn"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-play"})])]),e.file.processId&&(e.file.size<e.previewFileLimit||e.file.thumbs&&e.file.thumbs.length)?i("span",{staticClass:"media-file m-default-bg m-video-el"},[i("video",{staticClass:"b-dropzone__preview__media m-video",attrs:{poster:e.videoPoster},on:{click:function(t){return t.preventDefault(),e.openPreview(t)}}},[i("source",{attrs:{type:e.file.type,src:e.file.url}})])]):e._e(),e.showChoosePreviewBtn?[i("button",{staticClass:"b-dropzone__preview__edit",attrs:{type:"button",title:"Preview"},on:{click:function(t){return e.chooseCover(e.fileId)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-edit"})]),i("cover-picker",{attrs:{id:e.fileId,thumbs:e.file.thumbs,"selected-index":e.file.thumbId},on:{save:e.updateThumbId}})]:e._e(),e.file.processId&&e.file.size>=e.previewFileLimit&&!e.file.thumbs?i("span",{staticClass:"b-dropzone__preview__name"},[e._v(" "+e._s(e.file.name)+" ")]):e._e(),e.showIconPlay?i("span",{staticClass:"b-dropzone__preview__play-btn"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-play"})]):e._e(),"video"===e.file.mediaType&&e.file.duration?i("div",{staticClass:"timestamp m-video-duration"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-video"}),i("span",[e._v(e._s(e.videoDuration(e.file.duration)))])]):e._e()]:e._e()]:e._e(),"tip"===e.file.mediaType||e.isFileLoaded?e._e():i("span",{staticClass:"b-dropzone__preview__progress-wrapper",attrs:{"at-attr":"image_loader"}},[i("span",{staticClass:"b-dropzone__preview__progress",style:{width:e.file.progress+"%"}})])],e.getHasError?i("div",{staticClass:"b-dropzone__preview__name"},[i("span",{staticClass:"b-dropzone__preview__error-icon"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-alert"})])]):e._e(),e.isShowPreviewName?i("span",{staticClass:"b-dropzone__preview__name"},[e._v(" "+e._s(e.file.name)+" ")]):e._e(),e.file.error?i("span",{staticClass:"b-dropzone__preview__error-icon"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-alert"})]):e._e(),"tip"!==e.file.mediaType&&e.canEditMedia?i("button",{staticClass:"b-dropzone__preview__delete g-btn m-rounded m-reset-width m-thumb-r-corner-pos m-btn-remove m-sm-icon-size",attrs:{type:"button",disabled:e.sendMessageLoading,title:e.$t("message.delete")},on:{click:function(t){return t.preventDefault(),e.deleteFile(e.file,e.index)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})]):e._e(),e.isShowImageEditor?i("button",{staticClass:"b-dropzone__preview__edit",attrs:{type:"button",title:"Edit new"},on:{click:e.openImageEditor}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-edit"})]):e._e(),e.file.error?e._e():["video"===e.file.mediaType&&e.file.size<e.previewFileLimit?i("span",{staticClass:"js-dropzone__video-lightbox-link media-file m-lightbox-el",on:{click:function(t){return t.preventDefault(),e.openPreview(t)}}},[i("video",{staticClass:"b-dropzone__preview__media m-video",attrs:{poster:e.videoPoster}},[e.file.thumbs&&e.file.thumbs.length?i("source",{attrs:{type:e.file.type,src:e.file.thumbs[0].url}}):e._e()]),e.showIconPlay?i("span",{staticClass:"b-dropzone__preview__play-btn"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-play"})]):e._e()]):e._e(),"audio"===e.file.mediaType?i("audio",{ref:"audio",staticClass:"g-hidden",attrs:{controlslist:"nodownload"}},[i("source",{attrs:{type:e.file.type,src:e.file.url}}),e.isFileUrlFromBlob?i("source",{attrs:{type:e.file.type,src:e.file.sourceUrl}}):e._e()]):e._e()]],2)},L=[],T=(i("f559"),i("7ff5")),F=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-modal",{ref:"coverPicker-"+e.id,attrs:{id:"coverPicker-"+e.id,scrollable:e.$mq.includes("sm"),centered:!e.$mq.includes("sm"),"dialog-class":{"story-highlights-dialog m-modal-lg-mob":!0},"modal-class":{"m-modal-mob-page":e.$mq.includes("sm")},"header-class":"m-border-header","footer-class":"m-border-footer","hide-footer":e.$mq.includes("sm"),"body-class":"m-reset-body-paddings","no-fade":e.isChats&&e.$mq.includes("sm"),"hide-backdrop":e.$mq.includes("sm")},on:{hide:e.closeModal},scopedSlots:e._u([{key:"modal-header",fn:function(){return[e.$mq.includes("sm")?i("button",{staticClass:"g-page__header__btn m-with-round-hover",on:{click:e.close}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close",attrs:{"extra-class":"m-aligned-top"}})]):e._e(),i("h4",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("message.choose_cover_picture"))+" ")]),e.$mq.includes("sm")?i("div",{staticClass:"modal-header__btns-group"},[i("button",{staticClass:"g-btn m-rounded m-sm",on:{click:e.save}},[e._v(" "+e._s(e.$t("message.save"))+" ")])]):e._e()]},proxy:!0},{key:"modal-footer",fn:function(){return[i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",on:{click:e.close}},[e._v(" "+e._s(e.$t("message.button_label_cancel"))+" ")]),i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",on:{click:e.save}},[e._v(" "+e._s(e.$t("message.save"))+" ")])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("div",{staticClass:"b-wrapper-highlights b-scrolled-modal-content m-native-custom-scrollbar m-invisible-scrollbar m-scrollbar-y"},[i("div",{staticClass:"b-photos"},e._l(e.thumbs,(function(t){return i("div",{key:t.id,staticClass:"b-photos__item m-square m-highlight m-checkbox-control m-default-bg",class:{selected:t.id===e.thumbId},on:{click:function(i){return e.selectCover(t.id)}}},[i("div",{staticClass:"checkbox-item m-pos-right-top"},[i("div",{staticClass:"checkbox-item__inside"},[i("span",{staticClass:"b-input-ripple"}),i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-done",attrs:{"extra-class":"m-aligned-top"}})])]),i("img",{staticClass:"b-photos__item__img",attrs:{src:t.url,alt:""}})])})),0)])])},I=[],$={props:{id:{type:[Number,String],required:!0},thumbs:{type:Array,required:!0},selectedIndex:{type:Number,default:1}},data:function(){return{show:!1,thumbId:1}},computed:{isChats:function(){return"Chat"===this.$route.name||"ChatsSend"===this.$route.name}},watch:{show:function(){this.show&&(this.thumbId=this.selectedIndex)}},methods:{close:function(){this.$refs["coverPicker-".concat(this.id)].hide()},save:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$emit("save",this.thumbId),this.$refs["coverPicker-".concat(this.id)].hide();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),selectCover:function(e){this.thumbId=e},closeModal:function(){document.documentElement.classList.remove("m-modal-in-chat-opened")}}},R=$,A=Object(x["a"])(R,F,I,!1,null,null,null),j=A.exports,E=i("e528"),U=i("ebdc"),B=i("06f2"),N={methods:{getVideoPoster:function(e){if(!e)return"";var t=e.thumbId,i=void 0===t?1:t,s=e.thumbs,o=void 0===s?[]:s,a=e.mediaType,r=e.sourceUrl,n=void 0===r?"":r;if(!o.length)return"gif"===a?n:"";var d=o.find((function(e){return e.id===i})),c=d?d.url:o[0].url;return c||""}}},V=i("052a"),z=i("9df8"),W=i("9d17"),q=i("fcd9");function H(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?H(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):H(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var G={name:"UploadPreview",components:{CoverPicker:j,SpinnerLoader:E["a"]},mixins:[B["a"],N,V["a"],z["b"]],props:{file:{type:Object,required:!0},index:{type:Number,required:!0},post:{type:Object,default:null},showEditor:{type:Boolean,default:!0},filesCount:{type:Number,default:1},searchFace:{type:Boolean,default:!1}},data:function(){return{fileUrlError:!1}},computed:Y(Y(Y(Y({},Object(w["n"])(["sendMessageLoading"])),Object(w["b"])(["authUser"])),Object(w["u"])(["currentPlayAudio","currentPlayVideo"])),{},{isShowPreviewName:function(){return this.file.error||(!this.file.url||"video"===this.file.mediaType&&this.file.size>=this.previewFileLimit&&!this.file.thumbs)&&"tip"!==this.file.mediaType},isShowImageEditor:function(){return"photo"===this.file.mediaType&&this.canEditMedia&&this.authUser.enabledImageEditorForChat&&this.showEditor&&this.isFileLoaded},isFileUrlFromBlob:function(){return!(!this.file.url||!this.file.url.startsWith("blob:http"))},isMediaInCurrentlyProcessing:function(){return!this.fileUrlPreview&&!this.fileUrl&&"tip"!==this.file.mediaType},videoPoster:function(){return this.getVideoPoster(this.file)},isFileLoaded:function(){return 100===this.file.progress},uploadedVideoUrl:function(){return this.file.videoUploadHost&&this.file.previewUrl?"https://".concat(this.file.videoUploadHost).concat(this.file.url):this.file.url},showIconPlay:function(){return!this.file.error&&!this.isMediaInCurrentlyProcessing},canEditMedia:function(){return!this.post||!1!==this.post.canEditMedia},fileUrlPreview:function(){return Object(d["get"])(this,"file.thumbs[0].url",this.fileUrl)},fileUrl:function(){return this.fileUrlError?this.file.sourceUrl:this.file.url},showChoosePreviewBtn:function(){return this.file.thumbs&&this.file.thumbs.length>1},getHasError:function(){var e=this;return this.post&&this.post.media&&!!this.post.media.find((function(t){return t.id===e.file.id&&t.hasError}))},canViewFileWithPhotoSwipe:function(){return["photo","gif","video"].includes(this.file.mediaType)&&this.isFileLoaded&&!!this.fileId},fileId:function(){return this.isFileLoaded?this.file.processId||this.file.id:void 0}}),mounted:function(){this.renderAudio(),this.$refs.audio&&(this.$root.$on("currentPlayAudio",this.onStartPlayerAudio),this.$root.$on("pausePlayerAudio",this.onPausePlayerAudio))},beforeDestroy:function(){this.resetPlayingMedia(),this.$root.$off("currentPlayAudio",this.onStartPlayerAudio),this.$root.$off("pausePlayerAudio",this.onPausePlayerAudio)},methods:Y(Y({},Object(w["t"])(["setCurrentPlayAudio","resetCurrentPlayAudio","resetCurrentPlayVideo"])),{},{deleteFile:function(e,t){this.$emit("deleteFile",{file:e,index:t})},getFileError:function(){this.fileUrlError=!0},openImageEditor:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(T["a"])(s.file.sourceUrl||s.file.url);case 2:return t=e.sent,i=Object(W["a"])(t),o=window.URL.createObjectURL(new Blob([i.result])),e.abrupt("return",Object(W["d"])({url:o,orientation:i.orientation,type:s.file.type||s.file.mediaType}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.prev=1,window.showPreloader(),!this.fileUrlError){e.next=11;break}return i=Object(d["cloneDeep"])(this.file),e.next=7,t();case 7:i.url=e.sent,this.imageEditor(i),e.next=15;break;case 11:return e.next=13,t();case 13:this.file.url=e.sent,this.imageEditor(this.file);case 15:e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](1),alert(this.$t("message.debug_alert_message")),console.log(e.t0);case 21:return e.prev=21,window.hidePreloader(),e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[1,17,21,24]])})));function t(){return e.apply(this,arguments)}return t}(),imageEditor:function(e){var t=this;this.$imageEditor.$installFile(e,{disableGifs:this.filesCount>1}).then((function(e){e.asCopy?t.saveAsCopyEditedImage(e.file):t.saveEditedImage(e.file,t.index)})).catch((function(){})).finally((function(){t.file.sourceUrl&&window.URL.revokeObjectURL(t.file.url)}))},updateThumbId:function(e){this.$emit("updateThumbId",e)},deleteTip:function(e){this.$emit("deleteTip",e)},saveEditedImage:function(e,t){this.$emit("saveEditedImage",e,t)},saveAsCopyEditedImage:function(e){this.$emit("saveAsCopyEditedImage",e)},renderAudio:function(){var e=this;this.$nextTick((function(){e.$refs.audio&&U["a"].init(e.$refs.audio)}))},openPreview:function(e){e.preventDefault(),e.stopPropagation(),this.canViewFileWithPhotoSwipe&&this.$emit("openPreview",this.index)},chooseCover:function(e){this.$mq.includes("sm")&&document.documentElement.classList.contains("p-personal-chats-chat")&&document.documentElement.classList.add("m-modal-in-chat-opened"),this.$root.$emit("bv::show::modal","coverPicker-".concat(e))},onStartPlayerAudio:function(e){this.$refs.audio&&this.$refs.audio.id===e.id&&(this.currentPlayAudio&&this.currentPlayAudio.id===e.id||this.setCurrentPlayAudio(e),this.currentPlayVideo&&this.$root.$emit("pausePlayerVideo",this.currentPlayVideo))},onPausePlayerAudio:function(e){this.$refs.audio&&this.$refs.audio.id===e.id&&(U["a"].pauseAudio(e),this.currentPlayAudio&&this.currentPlayAudio.id===e.id&&this.resetCurrentPlayAudio())},resetPlayingMedia:function(){this.$refs.audio&&this.currentPlayAudio&&this.$refs.audio.id===this.currentPlayAudio.id&&this.resetCurrentPlayAudio(),"video"===this.file.mediaType&&this.fileId&&this.currentPlayVideo&&this.currentPlayVideo.id.includes(this.fileId)&&(document.pictureInPictureEnabled&&this.closePipVideo(this.currentPlayVideo),this.resetCurrentPlayVideo())},videoDuration:function(e){return u.a.duration(e,"seconds").format(q["a"].getDurationFormat(e))}})},Q=G,K=Object(x["a"])(Q,D,L,!1,null,null,null),J=K.exports,Z=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.authUser.isPerformer&&e.isGetUserMediaAvailable?i("div",{ref:"audioMessagePanel",staticClass:"b-float-panel js-chat__audiorecord-panel",on:{click:function(t){return t.target!==t.currentTarget?null:e.closeRecord(t)}}},[i("div",{staticClass:"container"},[i("div",{staticClass:"g-page__header m-real-sticky m-nowrap js-message-header-default"},[i("button",{ref:"closeMessageAudioBtn",staticClass:"g-page__header__btn m-with-round-hover m-light",attrs:{type:"button"},on:{click:e.closeRecord}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-back"})]),i("h1",{staticClass:"g-page-title"},[e._v(" "+e._s(e.$t("message.chat_record_audio_title"))+" ")])]),i("div",{staticClass:"g-page__header m-real-sticky m-nowrap g-hidden js-message-header-recording"},[i("div",{staticClass:"b-float-panel__icon-recording"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-voice"})]),i("h1",{staticClass:"g-page-title"},[e._v(" "+e._s(e.$t("message.recording_audio_title"))+" ")]),i("div",{staticClass:"b-btns-group"},[i("button",{ref:"closeMessageAudioBtn",staticClass:"g-page__header__btn m-with-round-hover m-light",attrs:{type:"button"},on:{click:e.closeRecord}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})])])]),i("div",{staticClass:"b-float-panel__wrapper"},[i("div",{staticClass:"b-float-panel__timer js-chat__audio-record-timer"},[e._v(" 0:00 ")]),i("button",{ref:"audioStopRecordBtn",staticClass:"js-chat__audio-record-btn-rec b-float-panel__btn-record",attrs:{type:"button"}},[i("span",{staticClass:"js-chat__audio-record-state-stop b-float-panel__btn-record__stop"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-stop"})]),i("span",{staticClass:"js-chat__audio-record-state-rec b-float-panel__btn-record__save"}),i("span",{staticClass:"b-round-progress"},[i("svg",{staticClass:"svg-progress",attrs:{width:"60",height:"60",viewBox:"0 0 60 60"}},[i("circle",{staticClass:"progress__meter",attrs:{cx:"30",cy:"30",r:"28","stroke-width":"4"}}),i("circle",{staticClass:"progress__value",attrs:{cx:"30",cy:"30",r:"28","stroke-width":"4"}})])])]),i("b-dropdown",{staticClass:"b-volume-btn m-btn-round b-streaming__mic-select b-float-panel__wrapper-btn-voice",attrs:{left:"","toggle-class":"b-volume-btn__el b-float-panel__btn-voice m-with-round-hover m-size-extra-lg-hover b-streaming__mic-select__btn","menu-class":"m-list-switcher m-appearance-modal"},scopedSlots:e._u([{key:"button-content",fn:function(){return[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-voice"})]},proxy:!0}],null,!1,3637539279)},[i("div",{staticClass:"js-audio-menu"},[i("div",{staticClass:"dropdown-menu__header"},[e._v(" "+e._s(e.$t("message.title_microphone"))+" ")]),i("ul"),i("div",{staticClass:"empty-message m-light-text"},[e._v(" "+e._s(e.$t("message.no_options_available"))+" ")])])])],1)])]):e._e()},X=[],ee=i("a9ee"),te=i.n(ee),ie=i("d772"),se=i.n(ie),oe=i("ad97");function ae(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function re(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ae(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}u.a.extend(se.a);var ne={mixins:[oe["a"]],data:function(){return{mimeType:"audio/mpeg",recorderType:ee["MediaStreamRecorder"],btn:null,recStopBtn:null,closeBtn:null,audioMessagePanel:null,limit:1800,isRecording:!1,firstRun:null,audioDeviceId:"",USERID:null,state:"",recorder:null,hasBeforeunloadAudiorecorderEvent:!1,beforeEachAudiorecorderFunc:null,microphone:null}},computed:re(re({},Object(w["b"])(["authUser"])),{},{checkLeaveAudiorecorder:function(){return"recording"===this.state},checkLeaveTextAudiorecorder:function(){return this.$t("message.audiorecorder_leave_msg")},routerCheckLeaveComponent:function(){return["ChatsSend","Chat"].includes(this.$route.name)?"chat":""}}),mounted:function(){this.beforeEachAudiorecorderFunc=this.routerCheckLeave({conditionField:"checkLeaveAudiorecorder",textField:"checkLeaveTextAudiorecorder",component:this.routerCheckLeaveComponent}),this.beforeunloadCheckLeave({watchField:"checkLeaveAudiorecorder",conditionField:"checkLeaveAudiorecorder",eventField:"hasBeforeunloadAudiorecorderEvent",funcField:"handleBeforeUnloadAudiorecorder"}),this.$root.$once("removeAllBeforeUnloadListeners",this.removeListeners)},beforeDestroy:function(){document.body.classList.contains("open-panel")&&(document.body.classList.remove("open-panel"),this.enableMediaBtn()),this.$root.$off("removeAllBeforeUnloadListeners",this.removeListeners),this.beforeEachAudiorecorderFunc&&this.beforeEachAudiorecorderFunc(),this.hasBeforeunloadAudiorecorderEvent&&(window.removeEventListener("beforeunload",this.handleBeforeUnloadAudiorecorder),this.hasBeforeunloadAudiorecorderEvent=!1)},methods:{enableMediaBtn:function(){var e=document.getElementById("attach_file_photo");e&&e.removeAttribute("disabled")},handleBeforeUnloadAudiorecorder:function(e){if(this.hasBeforeunloadAudiorecorderEvent){var t=this.checkLeaveTextChat;return e=e||window.event,e&&(e.returnValue=t),t}},isMimeTypeSupported:function(e){return"undefined"!==typeof MediaRecorder&&"function"===typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported(e)},blobtoFile:function(e,t){var i="";switch(e.type){case"audio/ogg":i="ogg";break;case"audio/webm":i="webm";break;case"video/webm":case"video/mp4":i="mp4";break;case"audio/wav":i="wav";break;default:i="mp3";break}try{return new File([e],"".concat(t,".").concat(i),{type:e.type})}catch(o){var s=new Blob([e],{type:e.type});return s.name="".concat(t,".").concat(i),Sentry.captureException(o),s}},fillDevicesList:function(e){var t=!0,i=!0;e.forEach((function(e,s){var o,a,r="";if("videoinput"===e.kind)o=e.label?e.label.replace(/ *\([^)]*\) */g,""):"Camera ".concat(s),a=document.querySelectorAll(".js-video-menu ul"),t&&(t=!1,r="m-active");else{if("audioinput"!==e.kind)return;o=e.label?e.label.replace(/ *\([^)]*\) */g,""):"Microphone ".concat(s),a=document.querySelectorAll(".js-audio-menu ul"),i&&(i=!1,r="m-active")}var n=document.createElement("li"),d=document.createElement("a");d.dataset.id=s,d.classList.add("b-streaming__mic-select__option"),r&&d.classList.add(r),d.innerHTML='<span class="b-dropdown__icon"><svg aria-hidden="true" class="g-icon"><use xlink:href="#icon-done"></use></svg></span>'.concat(o),n.appendChild(d),a.forEach((function(e){e.appendChild(n)}))}))},updateRecordProgressBar:function(e,t,i){var s=2*Math.PI*28,o=i.querySelector(".progress__value"),a=Math.round(e/t*100);o.style.strokeDashoffset=s*(1-a/100),o.style.strokeDasharray=s},setChatSendBtnState:function(){var e=!1;if(e&&"true"===e.dataset.can_send){var t=document.querySelector(".js-chat__audio-record-btn");t&&"recording"===t.dataset.state?e.disabled=!0:document.querySelector(".b-dropzone__preview.m-tip")?e.disabled=!1:this.authUser.canChat&&(e.disabled=!(document.querySelector(".b-chat__message-input").value.trim().replace(/(\r\n|\n|\r)/gm,"").length&&document.querySelectorAll(".b-dropzone__preview").length===document.querySelectorAll(".b-dropzone__preview input").length||document.querySelectorAll(".b-dropzone__preview").length&&document.querySelectorAll(".b-dropzone__preview").length===document.querySelectorAll(".b-dropzone__preview input").length))}},showHidePanel:function(e){this.audioMessagePanel.classList.toggle("m-hidden",!e),document.body.classList.toggle("open-panel",e);var t=document.getElementById("attach_file_photo"),i=!this.audioMessagePanel.classList.contains("m-hidden");t&&(i?t.setAttribute("disabled",!0):t.removeAttribute("disabled"));var s=document.querySelector(".b-chat__footer");s&&s.classList.toggle("m-panel-shown",e)},audiorecorderInit:function(e){var t=this,i=e.btn,s=e.recStopBtn,o=e.closeBtn,a=e.userId,r=e.audioMessagePanel,n=e.firstRun,d=e.inputId,c=void 0===d?"file_upload_input":d,l=e.context;this.btn=document.getElementById(i),this.recStopBtn=s,this.closeBtn=o,this.audioMessagePanel=r,this.USERID=a,this.firstRun=n,this.audioDeviceId=!1,this.inputId=c,this.isPostContext="post"===l,!1===this.isMimeTypeSupported(this.mimeType)&&(this.mimeType="audio/ogg",!1===this.isMimeTypeSupported(this.mimeType)&&(this.mimeType="audio/wav",this.recorderType=ee["StereoAudioRecorder"])),this.btn&&this.btn.addEventListener("click",(function(){t.showHidePanel(!0),t.firstRun&&(t.firstRun=!1,navigator.mediaDevices.enumerateDevices().then((function(e){var i=document.querySelector(".js-chat__audiorecord-panel"),s=e.filter((function(e){return"default"!==e.deviceId&&!e.label.includes("default")})),o={allDevices:s,audioDevices:s.filter((function(e){return"audioinput"===e.kind}))};0===o.audioDevices.length&&(alert(t.$t("message.audiorecorder_no_mic")),i.querySelector(".b-streaming__mic-select__btn").disabled=!0,i.querySelector(".b-streaming__mic-select__btn .g-icon use").setAttribute("xlink:href","#icon-voice-off")),1===o.audioDevices.length&&(i.querySelector(".b-streaming__mic-select__btn").disabled=!0),o.audioDevices.length&&(t.audioDeviceId=o.audioDevices[0].deviceId,t.fillDevicesList(o.audioDevices),t.audioMessagePanel.querySelectorAll(".js-audio-menu .b-streaming__mic-select__option").forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var i=e.target;i.dataset.id&&o.audioDevices[i.dataset.id]&&(t.audioDeviceId=o.audioDevices[i.dataset.id].deviceId),document.querySelector(".js-audio-menu .m-active").classList.remove("m-active"),i.classList.add("m-active"),document.querySelector('[id^="js-video-message"]').click()}))})))})).catch((function(e){console.log("".concat(e.name,": ").concat(e.message)),Sentry.captureException(e)}))),t.audioMessagePanel.querySelector(".b-streaming__mic-select").classList.remove("g-hidden")})),this.recStopBtn&&this.recStopBtn.addEventListener("click",(function(){"recording"===t.state?t.stopRec():t.rec()})),this.closeBtn&&this.closeBtn.addEventListener("click",this.closeBtnHandler)},rec:function(){var e=this,t=!0;this.audioDeviceId&&(t={deviceId:{exact:this.audioDeviceId}}),navigator.mediaDevices.getUserMedia({audio:t}).then((function(t){e.microphone=t;var i=document.querySelector("#file_upload_input");i&&(i.disabled=!0),e.audioMessagePanel.querySelector(".b-streaming__mic-select").classList.add("g-hidden"),e.recStopBtn.querySelector(".js-chat__audio-record-state-stop").classList.remove("g-hidden"),e.recStopBtn.querySelector(".js-chat__audio-record-state-rec").classList.add("g-hidden"),e.audioMessagePanel.classList.add("m-record-start"),e.audioMessagePanel.querySelector(".js-message-header-default").classList.add("g-hidden"),e.audioMessagePanel.querySelector(".js-message-header-recording").classList.remove("g-hidden"),e.btn.dataset.state="recording",e.state="recording",e.setChatSendBtnState(),e.recorder=te()(e.microphone,{type:"audio",disableLogs:!0,mimeType:e.mimeType,recorderType:e.recorderType}),e.recorder.startRecording();var s=(new Date).getTime(),o=setInterval((function(){"recording"===e.state?(e.duration=Math.round(((new Date).getTime()-s)/1e3),e.updateRecordProgressBar(e.duration,e.limit,e.audioMessagePanel),e.duration&&(e.audioMessagePanel.querySelector(".js-chat__audio-record-timer").textContent=u.a.duration(e.duration,"seconds").format(q["a"].getDurationFormat(e.duration))),e.duration>=e.limit&&e.stopRec()):clearInterval(o)}),250)})).catch((function(t){e.btn.dataset.state="",e.state="",e.setChatSendBtnState(),alert(e.$t("message.audiomessage_mic_restricted_error")),"NotAllowedError"!==t.name&&Sentry.captureException(t)}))},stopRec:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.recorder.stopRecording(Object(r["a"])(regeneratorRuntime.mark((function i(){var s,o,a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:e.showHidePanel(!1),e.audioMessagePanel.querySelector(".progress__value").removeAttribute("style"),e.recStopBtn.querySelector(".js-chat__audio-record-state-stop").classList.add("g-hidden"),e.recStopBtn.querySelector(".js-chat__audio-record-state-rec").classList.remove("g-hidden"),e.audioMessagePanel.querySelector(".js-chat__audio-record-timer").textContent="0:00",e.audioMessagePanel.classList.remove("m-record-start"),e.audioMessagePanel.querySelector(".js-message-header-default").classList.remove("g-hidden"),e.audioMessagePanel.querySelector(".js-message-header-recording").classList.add("g-hidden"),e.btn.dataset.state=null,t&&(e.isPostContext||(e.btn.disabled=!0),s=e.recorder.getBlob(),o=e.blobtoFile(s,"audiorecord_".concat(e.USERID,"_").concat(u()().format("YYYYMMDDHHmmss"))),window.CustomEvent?a=new CustomEvent("selectFile",{detail:{file:o}}):(a=document.createEvent("CustomEvent"),a.initCustomEvent("selectFile",!0,!0,{file:o})),e.$emit("uploadAudio",{isModal:!1,fileType:"audio",data:a})),e.recorder.destroy(),e.recorder=null,e.microphone&&(e.microphone.stop(),e.microphone=null);case 13:case"end":return i.stop()}}),i)})))),this.state="recorded"},removeListeners:function(){window.removeEventListener("beforeunload",this.handleBeforeUnloadAudiorecorder)},closeBtnHandler:function(){this.showHidePanel(!1),"recording"===this.state&&this.stopRec(!1)}}};function de(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function ce(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?de(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):de(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var le={mixins:[ne],computed:ce(ce({},Object(w["b"])(["authUser"])),{},{isGetUserMediaAvailable:function(){return void 0!==navigator.mediaDevices&&null!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getUserMedia&&null!==navigator.mediaDevices.getUserMedia}}),mounted:function(){var e=this,t=document.getElementById("js-audioRecordBtn");t&&this.$refs.audioStopRecordBtn&&this.isGetUserMediaAvailable&&this.$nextTick((function(){e.audiorecorderInit({btn:"js-audioRecordBtn",recStopBtn:e.$refs.audioStopRecordBtn,closeBtn:e.$refs.closeMessageAudioBtn,audioMessagePanel:e.$refs.audioMessagePanel,userId:e.authUser.id,firstRun:!0,inputId:"file_upload_input",context:"post"})}))},beforeDestroy:function(){"recording"===this.state&&this.stopRec(!1)},methods:{closeRecord:function(){this.closeBtn&&this.closeBtnHandler(),this.enableMediaBtn(),this.$emit("closeRecordPanel")}}},ue=le,he=(i("d1ae"),Object(x["a"])(ue,Z,X,!1,null,"2c68632e",null)),pe=he.exports,me=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-modal",{ref:"ModalPostPrice",attrs:{id:"ModalPostPrice",centered:"",size:"sm","body-class":"m-price-stream m-reset-body-padding-bottom"},scopedSlots:e._u([{key:"modal-header",fn:function(){return[i("h4",{staticClass:"modal-title"},[e._v(" "+e._s(e.title||e.$t("message.post_set_price_title"))+" ")])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",attrs:{type:"button"},on:{click:e.cancel}},[e._v(" "+e._s(e.$t("message.cancel_button"))+" ")]),i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",attrs:{type:"button",disabled:e.messagePriceSetDisabled},on:{click:e.save}},[e._v(" "+e._s(e.$t("message.save_button"))+" ")])]},proxy:!0}])},[i("price-input",{attrs:{min:e.minPrice,max:e.maxPrice,placeholder:e.$t("message.post_message_price_field_placeholder"),label:e.$t("message.price"),"allow-free":"",required:""},model:{value:e.price,callback:function(t){e.price=t},expression:"price"}})],1)},fe=[],ge=i("fd85");function ve(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function be(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ve(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var we={components:{PriceInput:ge["a"]},props:{defaultPrice:{type:[Number,String],default:0},setPrice:{type:Function,required:!0},title:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:0},isChat:{type:Boolean,default:!1}},data:function(){return{price:"",focused:!1,focusTimeout:null}},computed:be(be({},Object(w["b"])(["authUser"])),{},{minPrice:function(){return this.min?this.min:this.isChat?this.authUser.messageMinPrice:this.authUser.postMinPrice},maxPrice:function(){return this.max?this.max:this.isChat?this.authUser.messageMaxPrice:this.authUser.postMaxPrice},messagePriceSetDisabled:function(){var e=+this.price;return!!e&&(e<this.minPrice||e>this.maxPrice)}}),watch:{defaultPrice:function(){this.price=this.defaultPrice}},mounted:function(){this.defaultPrice&&(this.price=this.defaultPrice)},methods:{save:function(){this.setPrice(this.price),this.hide()},cancel:function(){this.price="",this.hide()},hide:function(){this.$refs.ModalPostPrice&&this.$refs.ModalPostPrice.hide()}}},_e=we,ye=Object(x["a"])(_e,me,fe,!1,null,null,null),Ce=ye.exports,Pe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-modal",{ref:"ModalFunds",attrs:{id:"ModalFunds",centered:"",size:"sm","body-class":"m-reset-body-padding-bottom"},on:{show:e.onShow},scopedSlots:e._u([{key:"modal-header",fn:function(){return[i("h4",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("message.post_fundraising_target_title"))+" ")])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",attrs:{type:"button"},on:{click:e.close}},[e._v(" "+e._s(e.$t("message.cancel_button"))+" ")]),i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",attrs:{type:"button",disabled:!!e.messagePriceError},on:{click:e.setPostTarget}},[e._v(" "+e._s(e.$t("message.save_button"))+" ")])]},proxy:!0}])},[i("price-input",{staticClass:"m-gap-sm",attrs:{min:e.authUser.minFundRaisingTarget,max:e.authUser.maxFundRaisingTarget,autofocus:e.isAutofocus,label:e.$t("message.post_fundraising_target_field_placeholder"),required:"","allow-free":!1},model:{value:e.target,callback:function(t){e.target=t},expression:"target"}})],1)},ke=[];function Se(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function xe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Se(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Me={components:{PriceInput:ge["a"]},props:{defaultTarget:{type:Number,default:0},setTarget:{type:Function,required:!0}},data:function(){return{target:"",focused:!1,focusTimeout:null,isAutofocus:!0}},computed:xe(xe({},Object(w["b"])(["authUser"])),{},{messagePriceError:function(){if(this.target){if(this.target<this.authUser.minFundRaisingTarget)return this.$t("message.min_price_label",{MIN:this.authUser.minFundRaisingTarget});if(this.target>this.authUser.maxFundRaisingTarget)return this.$t("message.max_price_label",{MAX:this.authUser.maxFundRaisingTarget})}return""}}),watch:{defaultTarget:function(){this.target=this.defaultTarget}},methods:{setPostTarget:function(){this.setTarget(this.target),this.close()},focus:function(){clearTimeout(this.focusTimeout),this.focused=!0},blur:function(){var e=this;this.focusTimeout=setTimeout((function(){e.focused=!1}),150)},close:function(){this.isAutofocus=!1,this.$refs.ModalFunds.hide()},onShow:function(){this.isAutofocus=!0,this.target=this.defaultTarget||""}}},Oe=Me,De=Object(x["a"])(Oe,Pe,ke,!1,null,null,null),Le=De.exports,Te=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.shouldShowComponentContent?i("div",{staticClass:"b-services-chat-hints"},[e.isShowInfoForTipsMessages?i("hint-reminder",{attrs:{text:e.$t("message.please_add_a_tip_to_this"),tooltip:e.$t("message.send_messages_for_tips_popup")}}):e._e(),e.hasTipsForm?i("hint-reminder",{attrs:{text:e.$t("message.send_a_tip_button_messages"),"has-close-btn":""},on:{close:e.clearMessagesWithIsTopInfo}}):e._e()],1):e._e()},Fe=[],Ie=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"b-reminder-form",class:{"m-error":"error"===e.type}},[e.html?i("div",{domProps:{innerHTML:e._s(e.html)}}):[e.text?i("div",{staticClass:"b-reminder-form__text"},[e._v(" "+e._s(e.text)+" "),e.tooltip?i("span",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.tooltip,enabled:e.tooltipEnabled,classes:e.tooltipClasses,placement:e.tooltipPlacement},expression:"{\n          content: tooltip,\n          enabled: tooltipEnabled,\n          classes: tooltipClasses,\n          placement: tooltipPlacement,\n        }"}],class:e.tooltipIconClasses},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],class:e.tooltipIcon})]):e._e()]):e._e(),e.hasNav?i("div",{staticClass:"b-reminder-form__icons"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-media",on:{click:e.mediaUploadClick}}),e.hasVideoRecBtn?i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-video",on:{click:e.videoRecClick}}):e._e(),i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-voice",on:{click:e.voiceRecClick}})]):e._e(),e.hasCloseBtn?i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.close_button"),expression:"$t('message.close_button')"}],staticClass:"g-page__header__btn m-with-round-hover m-size-sm-hover",attrs:{type:"button"},on:{click:e.close}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})]):e._e()]],2)},$e=[],Re={name:"HintReminder",props:{type:{type:String,default:"hint"},html:{type:String,default:""},text:{type:String,default:""},tooltip:{type:String,default:""},tooltipIconClasses:{type:String,default:"g-icon-info"},tooltipIcon:{type:String,default:"icon-info"},tooltipClasses:{type:String,default:"m-tooltip-higher"},tooltipPlacement:{type:String,default:"top-end"},tooltipEnabled:{type:Boolean,default:!0},hasNav:{type:Boolean,default:!1},hasCloseBtn:{type:Boolean,default:!1},hasVideoRecBtn:{type:Boolean,default:!1}},methods:{close:function(){this.$emit("close")},mediaUploadClick:function(){this.$emit("mediaUploadClick")},videoRecClick:function(){this.$emit("videoRecClick")},voiceRecClick:function(){this.$emit("voiceRecClick")}}},Ae=Re,je=(i("5110"),Object(x["a"])(Ae,Ie,$e,!1,null,"f5c54c48",null)),Ee=je.exports,Ue=i("709f");function Be(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Ne(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Be(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Ve={name:"ChatInfo",components:{HintReminder:Ee},props:{tipValue:{type:[String,Number],default:0},withUser:{type:Object,default:function(){return{}}},text:{type:String,default:""},chat:{type:Object,default:function(){return{}}}},data:function(){return{isMessagesWithIsTopInfo:!1}},computed:Ne(Ne({},Object(w["b"])(["authUser"])),{},{hasTipsForm:function(){return this.isMessagesWithIsTopInfo&&!this.authUser.isPerformer&&this.withUser&&this.withUser.tipsEnabled},shouldShowComponentContent:function(){return this.isShowInfoForTipsMessages||this.hasTipsForm||!this.text.trim().length&&this.tipValue},isShowInfoForTipsMessages:function(){return"SettingsMessaging"!==this.$route.name&&"only_friends"===this.chat.canNotSendReason&&this.tipValue<this.tipsMin},tipsMin:function(){return this.authUser.isCreditsEnabled&&this.authUser.creditBalance>=1&&this.withUser&&this.withUser.canPayInternal?1:this.withUser?this.withUser.tipsMin:5}}),mounted:function(){(null===Ue["a"].getItem("isShowInfoTips")||Ue["a"].getItem("isShowInfoTips")<Date.now())&&(this.isMessagesWithIsTopInfo=!0)},methods:{clearMessagesWithIsTopInfo:function(){this.isMessagesWithIsTopInfo=!1,Ue["a"].setItem("isShowInfoTips",Date.now()+7776e6)}}},ze=Ve,We=Object(x["a"])(ze,Te,Fe,!1,null,null,null),qe=We.exports,He=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.user?i("b-modal",{attrs:{id:"ModalMediaVault",centered:"","header-class":"m-border-header","body-class":"m-reset-body-paddings-sides-v","footer-class":"m-border-footer","no-enforce-focus":""},on:{hide:e.hide,hidden:e.closeModal},scopedSlots:e._u([{key:"modal-header",fn:function(){return[i("h4",{staticClass:"modal-title",class:{"m-lowercase":e.selected.length}},[e._v(" "+e._s(e.title)+" ")]),i("div",{staticClass:"modal-header__btns-group"},[e.selected.length?i("button",{staticClass:"g-btn m-flat m-btn-gaps",on:{click:e.unselect}},[e._v(" "+e._s(e.$t("message.clear_selection"))+" ")]):e._e(),i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:e.$t("message.categories"),classes:"m-tooltip-higher"},expression:"{ content: $t('message.categories'), classes: 'm-tooltip-higher' }"}],staticClass:"g-btn m-with-round-hover m-icon m-icon-only m-default-color m-sm-size",on:{click:e.openCategoriesModal}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-collection",attrs:{"extra-class":"m-default-size"}})])])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("button",{staticClass:"g-btn m-flat m-btn-gaps m-uppercase m-reset-width",on:{click:e.close}},[e._v(" "+e._s(e.$t("message.button_label_cancel"))+" ")]),i("button",{staticClass:"g-btn m-flat m-btn-gaps m-uppercase m-reset-width",attrs:{type:"button",disabled:!e.selected.length},on:{click:e.send}},[e._v(" "+e._s(e.$t("message.add_button"))+" ")])]},proxy:!0}],null,!1,2326338086),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("div",{staticClass:"b-content-filter"},[i("div",{staticClass:"b-content-filter__title"},[e._v(" "+e._s(e.titleSort)+" ")]),i("div",{staticClass:"b-content-filter__group-btns",class:{"m-search-form-visible":e.isShowSearch}},[i("div",{staticClass:"b-content-filter__btn"},[i("form",{staticClass:"b-search-form b-form m-shorter",attrs:{action:""},on:{submit:function(t){return t.preventDefault(),e.searchSubmit(t)}}},[i("button",{staticClass:"g-page__header__btn m-with-round-hover",attrs:{type:"button"},on:{click:e.closeSearch}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"},{name:"tooltip",rawName:"v-tooltip",value:{content:e.$t("message.search_clear"),classes:"m-tooltip-higher"},expression:"{ content: $t('message.search_clear'), classes: 'm-tooltip-higher' }"}],staticClass:"icon-close"})]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.searchField,expression:"searchField"}],ref:"searchVaultModal",staticClass:"b-search-form__input form-control",attrs:{name:"search_vault_modal",placeholder:e.$t("message.search_placeholder"),type:"search",maxlength:100,autocomplete:"search-vault-modal",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},domProps:{value:e.searchField},on:{input:function(t){t.target.composing||(e.searchField=t.target.value)}}})]),i("button",{staticClass:"g-btn m-with-round-hover m-icon m-icon-only m-sm-size",class:{"m-gray m-lighter":!e.isShowSearch},attrs:{type:"button"},on:{click:e.submitSearch}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"},{name:"tooltip",rawName:"v-tooltip",value:{content:e.$t("message.search_media"),classes:"m-tooltip-higher"},expression:"{ content: $t('message.search_media'), classes: 'm-tooltip-higher' }"}],staticClass:"icon-search"})])]),i("div",{staticClass:"b-content-filter__btn"},[i("media-vault-filter")],1)])]),i("media-vault-nav",{class:{"m-bottom-bordered m-mb-16":!e.firstLoading},attrs:{"selected-lists":e.selectIdList,"vault-lists":e.getVaultListsFilledByIds,"has-more":e.hasMoreListMainFilled,"is-loading":e.isLoadingMediaListsFilled,focused:e.navFocused,search:e.search,"swiper-classes":"m-gaps-inside m-gaps-outside"},on:{"update:focused":function(t){e.navFocused=t},setSelectType:e.setSelectType,loadMore:e.loadMoreVaultLists}}),e.firstLoading?e._e():i("vault-media-type-filters",{attrs:{"has-media-by-types":e.hasMediaByTypes},on:{setMediaTypeFilter:e.setMediaTypeFilter},model:{value:e.mediaTypeFilter,callback:function(t){e.mediaTypeFilter=t},expression:"mediaTypeFilter"}}),i("div",{staticClass:"b-feed-content b-scrolled-modal-content m-modal-height-fix",class:{"m-empty-content":e.firstLoading,"empty-message show":!e.hasPosts&&!e.hasMore&&!e.isLoadingMedia,"m-native-custom-scrollbar m-invisible-scrollbar m-scrollbar-y":e.hasPosts||e.hasMore||e.isLoadingMedia}},[e.getPosts.length?i("div",{staticClass:"b-photos"},e._l(e.getPosts,(function(t,s){return i("div",{key:t.id,staticClass:"b-photos__item m-square m-highlight m-checkbox-control m-opacity-all m-col-3 g-pointer-cursor",class:{selected:e.isSelected(t.id),"m-default-bg":!t.thumb}},[i("div",{staticClass:"timestamp"},[i("utils-time",{attrs:{date:t.createdAt,type:"timeline"}})],1),e.hasVideoDuration(t)?i("div",{staticClass:"timestamp m-video-duration"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-video"}),i("span",[e._v(e._s(e.videoDuration(t.source.duration)))])]):e._e(),i("div",{staticClass:"checkbox-item m-pos-right-top",on:{click:function(i){return e.select(t)}}},[i("div",{staticClass:"checkbox-item__inside"},[i("span",{staticClass:"b-input-ripple"}),i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-done",attrs:{"extra-class":"m-aligned-top"}})])]),i("img",{staticClass:"b-photos__item__img",attrs:{src:t.thumb,alt:""},on:{click:function(t){return e.clickOnMedia(s)}}}),"video|gif".includes(t.type)?i("span",{staticClass:"b-photos__item__play-btn",on:{click:function(t){return e.clickOnMedia(s)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-play"})]):e._e()])})),0):e._e(),e.firstLoading?i("spinner-loader",{staticClass:"b-spinner-processing text-center m-loader-vault m-light-icon"}):e.hasPosts||e.hasMore||e.isLoadingMedia?e._e():[e._v(" "+e._s(e.$t("message.nothing_found_message"))+" ")],e.hasMore?i("infinite-loading",{attrs:{identifier:e.infiniteId},on:{infinite:e.infiniteHandler}},[i("div",{staticClass:"b-posts_preloader_container show_more_container",attrs:{slot:"spinner"},slot:"spinner"},[i("spinner-loader")],1),i("div",{attrs:{slot:"no-more"},slot:"no-more"}),i("div",{attrs:{slot:"no-results"},slot:"no-results"})]):e._e()],2)],1):e._e()},Ye=[],Ge=(i("5df3"),i("f400"),i("e166")),Qe=i.n(Ge),Ke=i("33a44"),Je=i("5329"),Ze=i("af96"),Xe=i("0453"),et=i("e057"),tt=i("5888"),it=i("88f4");function st(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function ot(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?st(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):st(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}u.a.extend(se.a);var at={name:"ModalMediaVault",components:{SpinnerLoader:E["a"],UtilsTime:Ke["a"],MediaVaultFilter:Je["a"],InfiniteLoading:Qe.a,MediaVaultNav:Ze["a"],VaultMediaTypeFilters:Xe["a"]},mixins:[et["a"],tt["a"]],props:{selectedLimit:{type:Number,required:!0},ids:{type:Array,default:function(){return[]}}},data:function(){return{selected:[],show:!1,isShowSearch:!1,searchField:"",swiperOptions:{slidesPerView:"auto",watchOverflow:!0,spaceBetween:8,mousewheel:!0,threshold:5},hasMore:!1,infiniteId:+new Date,offset:0,listOffset:0,limit:24,firstLoading:!0,mediaTypeFilter:"",navFocused:!1,search:""}},computed:ot(ot(ot(ot(ot({},Object(w["tc"])(["user"])),Object(w["b"])(["isAuth"])),Object(w["P"])(["vaultLists","vaultFilter","vaultOrder","isLoadingMedia","hasMoreListMainFilled","isLoadingMediaListsFilled","vaultListLimit","mediaCounts","selectIdList"])),Object(w["N"])(["posts","hasPosts","getVaultListsFilledByIds","currentVaultList"])),{},{titleSort:function(){switch(this.vaultFilter){case"most-liked":return this.$t("message.sort_most_liked_label");case"highest-tips":return this.$t("message.sort_highest_tips_label");default:return this.$t("message.chart_sort_by_recent_label")}},isChats:function(){return"Chat"===this.$route.name||"ChatsSend"===this.$route.name},getPosts:function(){var e=this,t=this.posts.filter((function(t){return!e.ids.includes(t.id)})).reduce((function(e,t){if(t.full){var i=new URL(t.full).pathname;e.set(i,t)}return e}),new Map);return Object(a["a"])(t.values())},isEmptyList:function(){return!!this.currentVaultList.id&&!this.currentVaultList.hasMedia},hasMediaByTypes:function(){var e,t=this.currentVaultList.id?!!this.currentVaultList.photosCount:this.mediaCounts.hasPhoto,i=this.currentVaultList.id?!!this.currentVaultList.gifsCount:this.mediaCounts.hasGif,s=this.currentVaultList.id?!!this.currentVaultList.videosCount:this.mediaCounts.hasVideo;return e={},Object(n["a"])(e,it["b"],t),Object(n["a"])(e,it["a"],i),Object(n["a"])(e,it["c"],s),e},title:function(){return this.selected.length?"".concat(this.selected.length," ").concat(this.$t("message.selected")):this.$t("message.page_vault_title")}}),watch:{show:function(e){var t=document.getElementById("ModalMediaVault___BV_modal_outer_");this.resetSort(),e?(this.reset(),t&&(t.style.zIndex="1038"),this.resetPosts(),this.fetchPostsByType(),this.fetchVaultLists({view:"list",filled:1})):(t&&(t.style.zIndex="1040"),this.$root.$off("closePhotoSwipe",this.hidePhotoSwipe))},vaultFilter:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchPostsByType();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),vaultOrder:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchPostsByType();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),searchField:{handler:Object(d["debounce"])((function(e,t){if(e!==t)return 0===e.length&&t.length>0?(this.search="",void this.fetchPostsByType()):void(e.length<3||(this.search=e,this.searchSubmit()))}),500)}},created:function(){this.$root.$on("changeSelectedList",this.setSelectType)},beforeDestroy:function(){this.$root.$off("changeSelectedList",this.setSelectType)},methods:ot(ot(ot({},Object(w["O"])(["setVaultFilter","setVaultOrder","setSelectIdList","resetPosts"])),Object(w["M"])(["fetchMediaVaultByType","resetMediaVault","fetchVaultLists"])),{},{openCategoriesModal:function(){this.$root.$emit("bv::show::modal","MediaVaultLists")},loadMoreVaultLists:function(){this.listOffset+=this.vaultListLimit;var e={view:"list",offset:this.listOffset,filled:1};this.fetchVaultLists(e)},reset:function(){this.resetMediaVault(),this.unselect()},isSelected:function(e){return this.selected.find((function(t){return t.id===e}))},unselect:function(){this.selected=[]},send:function(){this.$emit("addVaultFiles",{vaultFiles:this.selected}),this.close()},fetchPostsByType:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,s,o=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],i=this.selectIdList[0],t||(this.offset=0,this.hasMore=!1),e.next=5,this.fetchMediaVaultByType({limit:this.limit,offset:this.offset,more:t,query:this.searchField||void 0,list:i,field:this.vaultFilter,sort:this.vaultOrder,type:this.mediaTypeFilter||void 0});case 5:s=e.sent,this.offset+=this.limit,this.hasMore=s.hasMore,this.firstLoading=!1;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),infiniteHandler:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isLoadingMedia){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.fetchPostsByType(!0);case 4:this.hasMore?t.loaded():t.complete();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),clickOnMedia:function(e){this.showPhotoSwipe({index:e,mainClass:"m-".concat(this.postType)})},select:function(e){var t=this.selected.find((function(t){return t.id===e.id}));t?this.selected=this.selected.filter((function(t){return t.id!==e.id})):this.selected.length<this.selectedLimit&&(this.selected=[].concat(Object(a["a"])(this.selected),[e]))},close:function(){this.show=!1},toggleSearch:function(){var e=this;this.isShowSearch=!this.isShowSearch,this.isShowSearch&&this.$nextTick((function(){e.$nextTick((function(){e.$refs.searchVaultModal.focus()}))}))},closeSearch:function(){this.searchField.length&&(this.searchField=""),this.toggleSearch()},searchSubmit:function(){this.searchField.length&&this.fetchPostsByType()},closeModal:function(){this.isShowSearch=!1,this.offset=0,this.hasMore=!1,this.resetSort(),this.selected=[],this.searchField="",this.mediaTypeFilter="",this.setSelectIdList([]),this.firstLoading=!0,document.documentElement.classList.contains("m-modal-in-chat-opened")&&document.documentElement.classList.remove("m-modal-in-chat-opened")},setSelectType:function(e){this.firstLoading=!0;var t=!e||this.selectIdList.includes(e)?[]:[e];this.setSelectIdList(t),this.mediaTypeFilter&&!this.hasMediaByTypes[this.mediaTypeFilter]&&(this.mediaTypeFilter=""),this.fetchPostsByType()},resetSort:function(){this.setVaultFilter("recent"),this.setVaultOrder("desc")},hasVideoDuration:function(e){return!("video"!==e.type||!e.source||!e.source.duration)},videoDuration:function(e){return u.a.duration(e,"seconds").format(q["a"].getDurationFormat(e))},setMediaTypeFilter:function(){this.fetchPostsByType()},hide:function(e){this.navFocused&&"backdrop"===e.trigger&&e.preventDefault()},submitSearch:function(){this.isShowSearch?this.searchSubmit():this.toggleSearch()}})},rt=at,nt=Object(x["a"])(rt,He,Ye,!1,null,null,null),dt=nt.exports,ct=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"b-dropzone__previews b-make-post__voting-wrapper b-paid-post-content",class:{"m-disabled":e.disabled,"m-paid-post":e.locked&&e.isPrivatePost,"m-free-post":!e.locked&&e.isPrivatePost}},[e.locked&&e.isPrivatePost?i("button",{staticClass:"b-make-post__move-btn m-text m-left",attrs:{type:"button",disabled:e.disabled||e.disabledToggle},on:{click:e.togglePollLocked}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-left"})]):e._e(),i("div",{staticClass:"b-make-post__voting b-dropzone__preview m-loaded b-paid-post-content__inside"},[i("div",{staticClass:"b-post-piece g-pointer-cursor",on:{click:e.onOpenPollDuration}},[e.isQuiz?i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-quiz"}):i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-poll"}),i("span",{staticClass:"b-post-piece__label"},[e.isQuiz?[e._v(e._s(e.$t("message.make_post_quiz_title")))]:[e._v(e._s(e.$t("message.make_post_poll_duration_title")))]],2),i("span",{staticClass:"b-post-piece__value",domProps:{innerHTML:e._s(e.votingDurationText)}}),i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.delete"),expression:"$t('message.delete')"}],staticClass:"b-dropzone__preview__delete g-btn m-rounded m-reset-width m-thumb-r-corner-pos m-btn-remove m-sm-icon-size",attrs:{type:"button",disabled:e.disabled},on:{click:function(t){return t.stopPropagation(),e.onPollHide(t)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})])]),i("div",{staticClass:"b-make-post__voting__body"},[i("draggable",{staticClass:"new_vote_options m-draggable",attrs:{handle:".vote-input__btn.m-drag-btn",disabled:e.disabled},model:{value:e.options,callback:function(t){e.options=t},expression:"options"}},e._l(e.options,(function(t,s){return i("div",{key:s,staticClass:"vote-input m-field",class:{"m-right-answer":s===e.votingCorrectIndex&&e.isQuiz}},[i("input-o-f",{attrs:{value:t,placeholder:e.$t("message.enter_option_"+(s<=1?s+1:"another")),maxlength:150,disabled:e.disabled,wrapperClasses:e.isQuiz?"vote-input__quiz":""},on:{keyup:function(t){return e.onVotingOptionChanged(s,t)},focus:function(t){return e.checkVotingCorrectOnFocus(s)}}}),e.isQuiz?i("button",{staticClass:"g-btn m-with-round-hover m-icon m-icon-only m-xs-size",class:{"m-gray m-lighter":s!==e.votingCorrectIndex,"m-white":s===e.votingCorrectIndex},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.onVoteCorrectOptionChanged(s)}}},[i("span",{staticClass:"b-input-radio__label",class:{"m-active":s===e.votingCorrectIndex}},[i("span",{staticClass:"b-input-ripple"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-done"})])])]):e._e(),i("div",{staticClass:"vote-input__group-btns"},[i("button",{staticClass:"vote-input__btn delete-vote-option m-with-round-hover m-size-sm-hover",attrs:{type:"button",disabled:e.disabled||e.minimalVotingOptionsReached},on:{click:function(t){return e.removeVoteOption(s)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})]),i("button",{staticClass:"vote-input__btn m-drag-btn",attrs:{type:"button"}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-drag"})])])],1)})),0),e.votingOptions.length<20?i("button",{staticClass:"g-btn m-flat new_vote_add_option m-reset-width m-no-uppercase m-link",attrs:{type:"button",disabled:e.disabled},on:{click:e.addVoteOption}},[e._v(" "+e._s(e.$t("message.makke_post_poll_add_option_button"))+" ")]):e._e()],1)]),!e.locked&&e.isPrivatePost?i("button",{staticClass:"b-make-post__move-btn m-text m-right",attrs:{type:"button",disabled:e.disabled||e.disabledToggle},on:{click:e.togglePollLocked}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-right"})]):e._e(),i("modal-post-period",{attrs:{title:e.isQuiz?e.$t("message.make_post_quiz_duration_title"):e.$t("message.make_post_poll_duration_title"),period:e.localVotingDuration,name:"ModalPollDuration"},on:{"update:period":function(t){e.localVotingDuration=t}}})],1)},lt=[],ut={components:{draggable:g.a,ModalPostPeriod:O,InputOF:C["a"]},props:{locked:{type:Boolean},disabled:{type:Boolean},disabledToggle:Boolean,isPrivatePost:{type:Boolean},votingOptions:{type:Array,default:function(){return["",""]}},votingDuration:{type:[Number,String],default:7},votingCorrectIndex:{type:Number,default:-1},type:{type:Number,default:1}},data:function(){return{orderDisabled:!1}},computed:{isQuiz:function(){return 2===this.type},minimalVotingOptionsReached:function(){return this.votingOptions.length<=2},localVotingDuration:{get:function(){return this.votingDuration},set:function(e){this.$emit("update:votingDuration",e)}},votingDurationText:function(){return this.votingDuration>0?this.$tc("message.count_day_plural_new",this.votingDuration,{COUNT:this.votingDuration}):this.$t("message.no_limit_days_with_first_letter")},options:{get:function(){return this.votingOptions},set:function(e){var t=this.votingOptions[this.votingCorrectIndex],i=e.findIndex((function(e){return e===t}));this.$emit("update:votingOptions",e),this.onVoteCorrectOptionChanged(i)}}},methods:{checkVotingCorrectOnFocus:function(e){-1===this.votingCorrectIndex&&this.onVoteCorrectOptionChanged(e)},onVotingOptionChanged:function(e,t){var i=Object(a["a"])(this.votingOptions);i[e]=t.target.value,this.$emit("update:votingOptions",i)},addVoteOption:function(){this.disabled||this.votingOptions.length>=20||this.$emit("update:votingOptions",[].concat(Object(a["a"])(this.votingOptions),[""]))},removeVoteOption:function(e){if(!this.disabled&&!this.minimalVotingOptionsReached){var t=Object(a["a"])(this.votingOptions);t.splice(e,1),this.$emit("update:votingOptions",t),this.votingCorrectIndex===e&&this.$emit("update:voting-correct-index",0)}},onOpenPollDuration:function(){this.$root.$emit("bv::show::modal","ModalPollDuration")},onPollHide:function(){this.$emit("update:votingOptions",["",""]),this.localVotingDuration=7,this.$emit("update:locked",!1),this.$emit("hide")},togglePollLocked:function(){this.$emit("update:locked",!this.locked)},onVoteCorrectOptionChanged:function(e){this.$emit("update:voting-correct-index",e)}}},ht=ut,pt=Object(x["a"])(ht,ct,lt,!1,null,null,null),mt=pt.exports,ft=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"b-dropzone__previews b-make-post__voting-wrapper b-paid-post-content"},[i("div",{staticClass:"b-make-post__voting b-dropzone__preview m-loaded b-paid-post-content__inside"},[i("div",{staticClass:"b-post-piece g-pointer-cursor",on:{click:e.toggleFundingPanel}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-fundraising"}),i("span",{staticClass:"b-post-piece__label"},[e._v(" "+e._s(e.$t("message.make_post_fundraising_title"))+" ")]),i("span",{staticClass:"b-post-piece__value"},[e._v(" "+e._s(e.$t("message.make_post_fundraising_target"))+" "+e._s(e.amountHumanShort(e.target))+" ")]),i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.delete"),expression:"$t('message.delete')"}],staticClass:"b-dropzone__preview__delete g-btn m-rounded m-reset-width m-thumb-r-corner-pos m-btn-remove m-sm-icon-size",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),e.onHide(t)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})])]),i("div",{staticClass:"b-make-post__voting__body"},[i("div",{staticClass:"new_vote_options"},e._l(e.options,(function(t,s){return i("div",{key:s,staticClass:"vote-input"},[i("price-input",{attrs:{value:t,placeholder:e.$t("message.enter_option"),step:.01,"allow-free":!1,autofocus:!1,"hide-prefix":!t,error:e.getFundrisingOptionError(s)},on:{input:function(t){e.onInput(t,s)}}}),i("div",{staticClass:"vote-input__group-btns"},[i("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:e.$t("message.uploaded_media_delete_btn_title"),expression:"$t('message.uploaded_media_delete_btn_title')"}],staticClass:"vote-input__btn delete-vote-option m-with-round-hover m-size-sm-hover",attrs:{type:"button",disabled:e.options.length<2},on:{click:function(t){return e.removeFundraisingOption(s)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})])])],1)})),0),e.options.length<4?i("button",{staticClass:"g-btn m-flat new_vote_add_option m-reset-width m-no-uppercase m-link",attrs:{type:"button"},on:{click:e.addOption}},[e._v(" "+e._s(e.$t("message.make_post_fundraising_add_option_button"))+" ")]):e._e()])])])},gt=[],vt={components:{PriceInput:ge["a"]},mixins:[z["b"]],props:{options:{type:Array,default:function(){return[5,""]}},target:{type:Number,required:!0},min:{type:Number,required:!0},max:{type:Number,required:!0},hasErrors:{type:Boolean,default:!1}},computed:{isFundrisingOptionsErrors:function(){var e=this;return this.options.some((function(t,i){return e.getFundrisingOptionError(i).length}))}},watch:{isFundrisingOptionsErrors:{handler:function(e){this.$emit("update:hasErrors",e)},immediate:!0}},methods:{onInput:function(e,t){var i=Object(a["a"])(this.options);i[t]=e,this.$emit("update:options",i)},addOption:function(){this.options.length>=4||this.$emit("update:options",[].concat(Object(a["a"])(this.options),[""]))},removeFundraisingOption:function(e){if(!(this.options.length<2)){var t=Object(a["a"])(this.options);t.splice(e,1),this.$emit("update:options",t)}},toggleFundingPanel:function(){this.$emit("toggleFundingPanel")},onHide:function(){this.$emit("update:options",[5,""]),this.$emit("update:hasErrors",!1),this.$emit("update:target",0),this.$emit("hide")},getFundrisingOptionError:function(e){var t=this;return""!==this.options[e]?this.options[e]>this.max?this.$t("message.max_price_label",{MAX:this.max}):this.options[e]<this.min?this.$t("message.min_price_label",{MIN:this.min}):void 0!==this.options.find((function(i,s){return s<e&&Number(i)===Number(t.options[e])}))?this.$t("message.option_exists"):"":""}}},bt=vt,wt=Object(x["a"])(bt,ft,gt,!1,null,null,null),_t=wt.exports,yt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"b-dropzone__preview m-schedule m-loaded b-post-piece g-pointer-cursor m-row"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-schedule"}),e._v(" "+e._s(e.$t("message.scheduled_for"))+" "),i("span",{staticClass:"b-post-piece__value"},[e.scheduleDate?i("utils-time",{attrs:{date:e.scheduleDate,type:"schedule"}}):e.saveForLater?[e._v(" "+e._s(e.$t("message.saved_for_later"))+" ")]:e._e()],2),i("button",{staticClass:"b-dropzone__preview__delete g-btn m-rounded m-reset-width m-thumb-r-corner-pos m-btn-remove m-sm-icon-size",attrs:{type:"button",title:e.$t("message.delete")},on:{click:function(t){return t.stopPropagation(),e.deleteScheduleForItem(t)}}},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close"})])])},Ct=[],Pt={name:"PostScheduleForItem",components:{UtilsTime:Ke["a"]},props:{scheduleDate:{validator:function(e){return"string"===typeof e||null===e},required:!0},saveForLater:{type:Boolean,required:!0}},methods:{deleteScheduleForItem:function(){this.$emit("deleteScheduleForItem")}}},kt=Pt,St=Object(x["a"])(kt,yt,Ct,!1,null,null,null),xt=St.exports,Mt=i("9307"),Ot=i("31b5"),Dt=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-modal",{attrs:{id:"MediaVaultLists",centered:"","header-class":"m-border-header","body-class":"m-reset-body-paddings","footer-class":"m-border-footer"},scopedSlots:e._u([{key:"modal-header",fn:function(){return[i("h4",{staticClass:"modal-title"},[e._v(" "+e._s(e.$t("message.categories"))+" ")])]},proxy:!0},{key:"modal-footer",fn:function(){return[i("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",attrs:{type:"button"},on:{click:function(t){return e.$root.$emit("bv::hide::modal","MediaVaultLists")}}},[e._v(" "+e._s(e.$t("message.button_done"))+" ")])]},proxy:!0}])},[i("div",{staticClass:"b-categories-vault-list m-native-custom-scrollbar m-invisible-scrollbar m-scrollbar-y"},[i("div",{staticClass:"b-users-lists__item m-border-full-width m-md-height b-input-radio__wrapper"},[i("div",{staticClass:"b-input-radio__container"},[i("input",{staticClass:"b-input-radio",attrs:{id:"all",type:"radio"},domProps:{checked:!e.selectIdList.length},on:{change:function(t){return e.setSelectType()}}}),i("label",{staticClass:"b-input-radio__text",attrs:{for:"all"}},[i("div",{staticClass:"b-users-lists__item__text"},[i("div",{staticClass:"b-users-lists__item__name"},[e._v(" "+e._s(e.$t("message.all_button"))+" ")])])]),i("span",{staticClass:"b-input-radio__label"},[i("span",{staticClass:"b-input-ripple"})])])]),e._l(e.getVaultListsFilledByIds,(function(t){return i("div",{key:t.id,staticClass:"b-users-lists__item m-border-full-width m-md-height b-input-radio__wrapper"},[i("div",{staticClass:"b-input-radio__container"},[i("input",{staticClass:"b-input-radio",attrs:{id:t.id,type:"radio"},domProps:{checked:e.selectIdList.includes(t.id)},on:{change:function(i){return e.setSelectType(t.id)}}}),i("label",{staticClass:"b-input-radio__text",attrs:{for:t.id}},[i("div",{staticClass:"b-users-lists__item__text"},[i("div",{staticClass:"b-users-lists__item__name"},[e._v(" "+e._s(e._f("encodeHtml")(t.name))+" ")]),i("div",{staticClass:"b-users-lists__item__count",attrs:{"at-attr":"media_count"}},[t.photosCount?i("span",{staticClass:"b-users-lists__item__count__el"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-image"}),e._v(" "+e._s(e.formatCount(t.photosCount))+" ")]):e._e(),t.videosCount?i("span",{staticClass:"b-users-lists__item__count__el"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-video"}),e._v(" "+e._s(e.formatCount(t.videosCount))+" ")]):e._e(),t.gifsCount?i("span",{staticClass:"b-users-lists__item__count__el"},[i("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-gif"}),e._v(" "+e._s(e.formatCount(t.gifsCount))+" ")]):e._e(),t.photosCount||t.videosCount||t.gifsCount?e._e():i("span",[e._v(" "+e._s(e.$t("message.empty_category"))+" ")])])])]),i("span",{staticClass:"b-input-radio__label"},[i("span",{staticClass:"b-input-ripple"})])])])}))],2),e.isNeedLoading?i("infinite-loading",{attrs:{identifier:e.infiniteId},on:{infinite:e.infiniteHandler},scopedSlots:e._u([{key:"spinner",fn:function(){return[i("div",{staticClass:"b-posts_preloader_container show_more_container"},[i("spinner-loader")],1)]},proxy:!0},{key:"no-more",fn:function(){return[i("div")]},proxy:!0},{key:"no-results",fn:function(){return[i("div")]},proxy:!0}],null,!1,1173538536)}):e._e()],1)},Lt=[],Tt=i("f1f7"),Ft=i("8975");function It(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function $t(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?It(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):It(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Rt={name:"MediaVaultLists",components:{InfiniteLoading:Qe.a,SpinnerLoader:E["a"]},filters:{encodeHtml:Ft["b"]},data:function(){return{infiniteId:+new Date,offset:0}},computed:$t($t($t({},Object(w["N"])(["getVaultListsFilledByIds"])),Object(w["P"])(["selectIdList","isLoadingMediaListsFilled","vaultListLimit","hasMoreListMainFilled"])),{},{isNeedLoading:function(){return!this.isLoadingMediaListsFilled&&this.getVaultListsFilledByIds.length>=this.vaultListLimit&&this.hasMoreListMainFilled}}),methods:$t($t({},Object(w["M"])(["fetchVaultLists"])),{},{formatCount:function(e){return Object(Tt["a"])(e)},setSelectType:function(e){this.$root.$emit("changeSelectedList",e)},infiniteHandler:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.offset+=this.vaultListLimit,i={view:"list",filled:1},this.offset&&(i.offset=this.offset),e.next=5,this.fetchVaultLists(i);case 5:s=e.sent,s?t.loaded():t.complete();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()})},At=Rt,jt=Object(x["a"])(At,Dt,Lt,!1,null,null,null),Et=jt.exports,Ut=i("1560"),Bt=i("ce23"),Nt=i("16d9"),Vt=i("25ac"),zt=i("ebf6"),Wt=i("09e4"),qt=i("30a2"),Ht=i("998d");function Yt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,s)}return i}function Gt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(i),!0).forEach((function(t){Object(n["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Yt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Qt=function(){return Promise.all([i.e("chunk-vendors"),i.e("chunk-60a4b00d"),i.e("chunk-15485d4d")]).then(i.bind(null,"1793"))},Kt=function(){return i.e("TributeJS").then(i.bind(null,"19e61"))};u.a.extend(p.a);var Jt={name:"MakeFeedPost",components:{ModalPostPeriod:O,Datetime:m["Datetime"],UploadPreview:J,AudioInput:pe,ModalPostPrice:Ce,ModalPostFunding:Le,draggable:g.a,Videomessage:Qt,ChatInfo:qe,HintReminder:Ee,ModalMediaVault:dt,Polling:mt,Fundraising:_t,PostScheduleForItem:xt,AlertOF:Mt["a"],InputOF:C["a"],AddToLabelsBtns:Ot["a"],MediaVaultLists:Et},mixins:[B["a"],Vt["a"],zt["a"],Nt["a"],oe["a"],Ut["a"],Bt["a"],tt["a"],N,z["b"],P["a"]],props:{place:{type:String,default:"feed"},editPost:{type:Boolean,default:!1},hideStreamBtn:{type:Boolean,default:!1},fakeMode:{type:Boolean,default:!1},post:{type:Object,default:function(){}},isChat:{type:Boolean,default:!1},withUser:{type:Object,default:void 0},chat:{type:Object,default:function(){}},usersIdsToSend:{type:[Array,String],default:function(){return[]}},userIds:{type:Array,default:function(){return[]}},listIds:{type:Array,default:function(){return[]}},excludeListIds:{type:Array,default:function(){return[]}},excludedUsersIds:{type:Array,default:function(){return[]}},userIdToSend:{type:Number,default:0},fundRaisingPostId:{type:Number,default:0},awards:{type:Array,default:function(){return[]}},sendToQueue:{type:Number,default:0},usersCount:{type:Number,default:0},postDonators:{type:Number,default:0},postBuyers:{type:Number,default:0},postLikeds:{type:Number,default:0},postVoters:{type:[Number,String],default:0},isTemplate:{type:Boolean,default:!1},template:{type:Object,default:function(){}},allDataSaved:{type:Boolean,default:!0},chatsSendList:{type:Array,default:function(){return[]}},scheduleQueueMessage:{type:Object,default:null},scheduledSubscribedOn:{type:String,default:""},swiperKey:{type:Number,default:0},submitDisabled:{type:Boolean,default:!0},isHideForm:{type:Boolean,default:!1}},data:function(){return{postUsage:!0,text:"",showPoll:!1,votingType:0,votingOptions:["",""],votingDuration:7,votingCorrectIndex:-1,defaultPollExpired:0,showFundraising:!1,fundraisingLocked:!1,fundraisingTarget:0,fundraisingOptions:[5,""],tweetSend:0,fakeTweetSend:0,scheduleDate:null,makePostError:"",isShowRecordPanel:!1,price:0,unlockedMedia:[],lockDescription:!1,saveForLater:!1,uploadedFilesWithoutAudioList:[],freeFilesWithoutAudioList:[],isDraggingPreviews:!1,squarePreviews:!1,previewsOrder:[],paidMediaWithoutAudio:[],freeMediaWithoutAudio:[],paidMediaActive:!1,freeMediaActive:!1,mediaCentered:!1,paidMediaFirstActive:!1,freeMediaFirstActive:!1,mediaFirstCentered:!1,paidMediaText:!1,freeMediaText:!1,paidMediaAudio:!1,freeMediaAudio:!1,pollLocked:!1,audioLocked:!1,hasBeforeunloadPostEvent:!1,beforeEachPostFunc:null,tipValue:"",showVideoMessage:!1,isEditScheduleMessages:!1,startEditScheduleMessagesData:null,textHighLight:"",isForbiddenError:!1,isSubmitting:!1,openVideoRecordOnLoad:!1,videoSourcesForPhotoSwipe:{},editPostPayloadData:{},beforeLeaveMakePostFunc:null,isScheduleDateInPastValue:!1,postLabels:[],draftExistOnLoad:!1,minDatetime:u()().add(10,"minutes").format(),isFundrisingOptionsErrors:!1,tribute:null,POLL:1,QUIZ:2}},computed:Gt(Gt(Gt(Gt(Gt(Gt(Gt({},Object(w["b"])(["authUser"])),Object(w["v"])(["userPostDraft","draftMessageById"])),Object(w["C"])(["goBackState","getInit"])),Object(w["n"])({usersTotal:"usersTotal",selectedUsersIdsCount:"selectedUsersIds",mobileVersion:"mobileVersion",messagesHasMore:"messagesHasMore"})),Object(w["l"])(["getMessage"])),Object(w["N"])(["getMediaId"])),{},{acceptFileExt:function(){return"".concat(this.acceptFilesExtByType(["audio","photo","video"]))},getSubmitBtnText:function(){return this.isEditScheduleMessages&&this.scheduleDate?this.$t("message.save_button"):this.scheduleDate?this.$t("message.schedule"):this.$t("message.button_label_send")},draftMessage:function(){if(this.$route.query.scheduleMessageId||this.$route.params.forwardMessageId)return null;var e=Object(d["get"])(this.$route.params,"chatId",!1);return this.draftMessageById(e||"queue")},editOrCreatePostPage:function(){return["PostsCreate","PostsEdit"].includes(this.$route.name)},shouldShowAddToLabelsBtns:function(){return this.editOrCreatePostPage&&this.authUser.isPerformer},isMobile:function(){return c["isMobile"]},hasDraft:function(){return Object.keys(this.userPostDraft).length},draftPostLabels:function(){return this.draftExistOnLoad&&"PostsCreate"===this.$route.name?this.postLabels:[]},showMediaHint:function(){return!(!this.privatePost||this.fakeMode)&&((!this.uploadedFilesAudio.length||!this.audioLocked)&&!this.getPrimaryFilesWithoutAudio.length)},hasAssets:function(){return this.uploadedFiles.length||this.scheduleDate||this.saveForLater||this.showPoll||this.showFundraising||this.defaultPollExpired>0},isAnyMoreThanOneFace:function(){return!this.uploadedFiles.filter((function(e){return e.faceCount>=2})).length},isPostActionDisabled:function(){return this.tipValue>0},privatePost:function(){return!!this.price},needLoadDraft:function(){return!this.isHideForm&&this.isChat&&this.draftMessage&&!this.scheduleQueueMessage},postDraft:function(){return this.userPostDraft&&Object.keys(this.userPostDraft).length?this.userPostDraft:null},disabledSubmit:function(){var e=!0;if(this.showPoll&&this.votingOptions.filter((function(e){return e.length})).length<2)return!0;var t=!this.text.trim().length;return e=!(!this.showFundraising||this.fundraisingOptions.filter((function(e){return Number(e)>0})).length&&!this.isFundrisingOptionsErrors&&!t)||(this.privatePost?!(!this.uploadedFiles.length||this.allUploaded)||!(!t&&this.lockDescription)&&(!(this.showPoll&&this.votingOptions.filter((function(e){return e.length})).length>1&&this.pollLocked&&!t)&&((!this.uploadedFilesAudio.length||!this.audioLocked)&&!this.getPrimaryFilesWithoutAudio.length)):this.uploadedFiles.length?!this.allUploaded:t),this.isEditScheduleItem?e=e||!this.userAddChangesToEditQueueMessageData:this.editPost&&(e=e||!this.userAddChangesToEditPost),"ChatsSend"!==this.$route.name||this.usersIdsToSend.length||this.getListsUsersCount||this.specificBulkMessage&&this.usersCount||(e=!0),"ChatsSend"===this.$route.name&&this.listIds.length&&this.uploadedFiles.length&&this.allUploaded&&t&&(e=!1),"Chat"===this.$route.name&&this.chat&&"only_friends"===this.chat.canNotSendReason&&this.tipValue<this.withUser.tipsMin&&(e=!0),this.editOrCreatePostPage||this.authUser.canChat||(e=!0),this.tipValue&&!t&&(e=!1),this.isSubmitting&&(e=!0),e},pollExpired:function(){return this.$tc("message.count_day_plural_new",this.defaultPollExpired,{COUNT:this.defaultPollExpired})},makePostPlaceholder:function(){return this.isChat||this.isTemplate?this.$t("message.chat_text_input_placeholder"):this.uploadedFiles.length?this.$t("message.make_post_alt_text_input_placeholder"):this.$t("message.make_post_text_input_placeholder_new")},itHasPost:function(){return!!this.post&&!!this.post.id},postTextDisabled:function(){return this.itHasPost?!this.post.canEditText:this.isSubmitting},canEditMedia:function(){return!this.post||!1!==this.post.canEditMedia},fileUploadDisabled:function(){return!this.authUser.isPerformer&&!this.isChat||!!this.itHasPost&&!this.post.canEditMedia},postExpirationDisabled:function(){return this.defaultPollExpired?!!this.defaultPollExpired:this.itHasPost?!this.post.canEditExpire:!!this.price},scheduleDateDisabled:function(){return!!this.isPostActionDisabled||(this.scheduleDate?!!this.scheduleDate:this.saveForLater?!!this.saveForLater:!!this.itHasPost&&!this.post.canEditSchedule)},voteDisabled:function(){return this.showPoll?this.showPoll:!!this.itHasPost&&!this.post.canEditVote},pollControlDisabled:function(){return!!this.itHasPost&&!this.post.canEditVote},fundraisingDisabled:function(){return!!this.privatePost||!!this.fundraisingTarget},uploadedFilesWithoutAudio:function(){return this.uploadedFilesWithoutAudioList=this.uploadedFiles.filter((function(e){return"audio"!==e.mediaType})),this.uploadedFiles.filter((function(e){return"audio"!==e.mediaType}))},uploadedFilesAudio:function(){return this.uploadedFiles.filter((function(e){return"audio"===e.mediaType}))},uploadedFilesPhoto:function(){return this.uploadedFiles.filter((function(e){return"photo"===e.mediaType}))},getFreeFilesWithoutAudio:function(){var e=this,t=[];return this.privatePost&&(this.freeMediaWithoutAudio=this.freeMediaWithoutAudio.filter((function(t){return e.uploadedFilesWithoutAudio.findIndex((function(e){return e.orderId===t||e.id===t}))>-1})),t=this.uploadedFilesWithoutAudio.filter((function(t){return e.freeMediaWithoutAudio.indexOf(t.orderId)>-1||e.freeMediaWithoutAudio.indexOf(t.id)>-1}))),this.freeFilesWithoutAudioList=t,t},getPrimaryFilesWithoutAudio:function(){var e=this,t=this.uploadedFilesWithoutAudio;return this.privatePost&&(t=this.uploadedFilesWithoutAudio.filter((function(t){return e.freeMediaWithoutAudio.indexOf(t.orderId)<0&&e.freeMediaWithoutAudio.indexOf(t.id)<0})),this.paidMediaWithoutAudio=t.map((function(e){return e.orderId}))),this.uploadedFilesWithoutAudioList=t,t},isEditScheduleItem:function(){return!!this.scheduleQueueMessage},currentScheduleQueueMessageData:function(){var e=this.prepareBaseMessagePayload();return this.prepareMultipleUserMessageData(e)},userAddChangesToEditQueueMessageData:function(){return!Object(d["isEqual"])(this.currentScheduleQueueMessageData,this.startEditScheduleMessagesData)},userAddChangesToEditPost:function(){return this.editPost&&!Object(d["isEqual"])(this.editPostPayloadData,this.getDataObject())},checkLeave:function(){if(this.isEditScheduleItem)return this.userAddChangesToEditQueueMessageData;if(!this.fakeMode){if(this.isChat)return this.checkLeaveConditionUploader;if(this.editPost)return this.userAddChangesToEditPost}return!1},checkLeaveTextPost:function(){return this.$t("message.post_leave_msg")},fundraisingPresetMax:function(){return Math.min(this.fundraisingTarget,this.authUser.tipsMax)},disabledTipsBtn:function(){return!!this.scheduleDate||!!this.price},getListsUsersCount:function(){return this.listIds.length?this.usersCount:0},isShowScheduleDate:function(){return this.authUser.isPerformer&&!this.onlyFriends&&"SettingsMessaging"!==this.$route.name},specificBulkMessage:function(){return!!(this.fundRaisingPostId||this.awards.length||this.sendToQueue||this.postDonators||this.postBuyers||this.postVoters||this.postLikeds)},isShowPriceBtn:function(){return!(!this.isChat&&"SettingsMessaging"!==this.$route.name||!this.authUser.canEarn)||this.authUser.canEarn&&0===this.authUser.subscribePrice},priceBtnTooltip:function(){return this.isChat||"SettingsMessaging"===this.$route.name?this.$t("message.tooltip_message_price"):this.$t("message.post_set_price_title")},modalPriceTitle:function(){return this.isChat||"SettingsMessaging"===this.$route.name?this.$t("message.chat_set_message_price_title"):""},onlyFriends:function(){return"Chat"===this.$route.name&&this.chat&&"only_friends"===this.chat.canNotSendReason},dataAvailability:function(){return!(!this.text||!this.text.trim().length)||!!this.uploadedFiles.length||!!this.uploadedFilesAudio.length||this.showPoll||this.showFundraising||!!this.defaultPollExpired||!!this.price},isMultilineTextarea:function(){return["Feed","PostsCreate","SettingsMessaging"].includes(this.$route.name)||["ChatsSend","Chat"].includes(this.$route.name)&&this.$mq.includes("sm")},isMultilineDisabled:function(){return["ChatsSend","Chat"].includes(this.$route.name)&&!this.$mq.includes("sm")},allDataSavedComputed:function(){var e=this;return this.isTemplate?Object(d["isEmpty"])(this.template)?!this.text.length&&!this.uploadedFiles.length:this.text===this.getTextEncode(this.template)&&this.price===this.template.price&&this.lockDescription===this.template.lockedText&&this.uploadedFiles.length===this.getMediaData(this.template.media).length&&!this.uploadedFiles.some((function(e){return!e.id}))&&JSON.stringify(this.uploadedFiles.map((function(e){return e.id})))===JSON.stringify(this.getMediaData(this.template.media).map((function(e){return e.id})))&&JSON.stringify(this.freeMediaWithoutAudio.map((function(e){return e.id})))===JSON.stringify(this.unlockedMedia.filter((function(t){return e.uploadedFilesWithoutAudio.findIndex((function(e){return e.id===t}))>-1})).map((function(e){return e.id})))&&this.audioLocked===(this.uploadedFilesAudio.length&&!this.unlockedMedia.includes(this.uploadedFilesAudio[0].id)):!(this.isChat&&!this.$route.params.chatId&&this.mobileVersion)||!this.checkLeave},getTextModalConfirm:function(){return this.isScheduleDateInPastValue?this.isChat?this.$t("message.confirm_send_message_right_now"):this.$t("message.confirm_post_right_now"):this.scheduleDate?this.$t("message.confirm_send_schedule_messages",{DATE:u()(this.scheduleDate).format("LLL")}):this.listIds.length&&this.usersTotal?this.$t("message.confirm_send_messages",{COUNT:this.usersTotal}):this.selectedUsersIdsCount?this.$t("message.confirm_send_messages",{COUNT:this.selectedUsersIdsCount}):this.$t("message.confirm_send_messages_common")},isIOS:function(){return c["isIOS"]},mediaFilesForPhotoSwipeCount:function(){return this.uploadedFilesWithoutAudio.filter((function(e){return"tip"!==e.mediaType&&100===e.progress})).length},hasFileTypeTip:function(){return!!this.uploadedFilesWithoutAudio.filter((function(e){return"tip"===e.mediaType})).length},vaultLimit:function(){return Object(d["get"])(this,"getInit.postMediaConfig.count.photo",40)-this.uploadedFiles.length},addedVaultMediaIds:function(){return this.uploadedFiles.filter((function(e){return e.id&&!e.processId})).map((function(e){return e.id}))},isMediaFirst:function(){return!(this.showPoll||this.uploadedFilesAudio.length)},hasPostLockedItem:function(){return this.pollLocked||this.audioLocked||this.lockDescription},hasPostItemExceptMedia:function(){return this.showPoll||this.uploadedFilesAudio.length||this.lockDescription},isSingleMessageWithUserIdToSend:function(){return!(!this.isChat||(1!==this.usersIdsToSend.length||this.listIds.length)&&!this.userIdToSend||this.scheduleDate)},isSingleMessageWithChatId:function(){return this.isChat&&!this.usersIdsToSend.length&&!this.getListsUsersCount&&!this.specificBulkMessage},isMultipleUserMessageOrBulk:function(){return!this.$route.params.chatId||this.usersIdsToSend.length>1||this.getListsUsersCount||this.specificBulkMessage||this.scheduleDate},uploadedFilesUrl:function(){var e=this;return this.uploadedFiles.reduce((function(t,i){return i.videoUploadHost&&i.previewUrl?t.concat({url:i.url,thumbId:i.thumbId,previewUrl:i.previewUrl,videoUploadHost:i.videoUploadHost}):i.progress<100?t:i.processId?t.concat({processId:i.processId,host:i.host,thumbId:i.thumbId,name:i.name}):i.id?"video"===i.mediaType&&"ChatsSend"!==e.$route.name?t.concat({id:i.id,thumbId:i.thumbId}):t.concat(i.id):t.concat(i.url)}),[])},hasVideoMessageBtn:function(){return this.authUser.isPerformer&&!this.onlyFriends&&!this.isIOS},isDisablePriceBtn:function(){return this.defaultPollExpired>0||this.privatePost||this.fundraisingTarget>0||this.isPostActionDisabled},canClearDraft:function(){return this.showPoll||!!this.defaultPollExpired||!!this.fundraisingTarget},isDisabledToggleLockPoll:function(){return!this.hasPaidMedia},hasPaidMedia:function(){var e=!(!this.uploadedFilesAudio.length||!this.audioLocked);return!!this.paidMediaWithoutAudio.length||e},hasMoreMessagesBottom:function(){var e=this.$route.params.chatId,t=this.messagesHasMore[e]||{},i=t.bottom;return!!i}}),watch:{post:{handler:function(e,t){if(!Object(d["isEqual"])(e,t)){var i=Object(d["get"])(t,"id",!1),s=Object(d["get"])(e,"id",!1);i&&s&&i===s&&this.userAddChangesToEditPost||(s?this.setPostData(e):(this.resetToDefault(),this.postDraft&&this.loadPostDraft()))}}},uploadedFiles:{handler:function(){var e=this;this.squarePreviews=this.uploadedFilesPhoto.length>1&&this.checkPreviewRatio(),this.privatePost&&this.$nextTick((function(){e.scrollPreviewsThrottled()}))},deep:!0,immediate:!0},privatePost:{handler:function(){var e=this;this.privatePost&&this.$nextTick((function(){e.scrollPreviewsThrottled()}))}},allDataSavedComputed:function(e){this.$emit("update:allDataSaved",e)},scheduleDate:{handler:function(){this.$emit("isScheduled",!!this.scheduleDate)}},saveForLater:{handler:function(){this.$emit("isScheduled",this.saveForLater)}},mediaFilesForPhotoSwipeCount:function(e,t){e!==t&&(this.videoSourcesForPhotoSwipe=this.getVideoSourcesForPhotoSwipe())},canClearDraft:function(e){this.$emit("onCanClearChange",e)},disabledSubmit:{handler:function(e){this.$emit("update:submitDisabled",e)},immediate:!0},pollLocked:function(){var e=this;this.privatePost&&this.$nextTick((function(){e.scrollPreviewsThrottled()}))},hasPaidMedia:function(e){e||(this.pollLocked=!0)}},created:function(){this.$root.$on("setScheduleData",this.setScheduleData),this.resetScheduledDraftPost(),this.resetPaidDraftPost()},mounted:function(){var e=this;this.isChat&&!this.$route.params.chatId&&this.mobileVersion&&this.$emit("update:allDataSaved",!0),this.isTemplate&&!Object(d["isEmpty"])(this.template)||(this.beforeunloadCheckLeave({watchField:"checkLeave",conditionField:"checkLeave",eventField:"hasBeforeunloadPostEvent",funcField:"handleBeforeUnloadPost"}),this.beforeLeaveMakePostFunc=this.routerCheckLeave({conditionField:"checkLeave",textField:"checkLeaveTextPost",component:this.isChat?"chat":"post"}));var t=Ue["a"].getItem("filesFromMediaFeed");this.$route.params.setFocus&&this.$refs.textarea.$el.querySelector("textarea").focus(),this.$route.params.fileUploadData&&this.handleInputFile({data:this.$route.params.fileUploadData,multiple:!0,validateParamsType:"photo"}),this.$route.params.tweetSend&&(this.fakeTweetSend=this.$route.params.tweetSend),!this.fakeMode&&this.$route.params.vaultFiles&&this.$route.params.post&&this.setMediaData(this.$route.params.vaultFiles),!this.fakeMode&&t&&(this.setMediaData(JSON.parse(t)),Ue["a"].removeItem("filesFromMediaFeed")),this.isTemplate&&!Object(d["isEmpty"])(this.template)&&(this.setDataFromStore(),this.setMediaData(this.template.media),this.setFreeLockMedia(this.template.previews)),this.isChat&&this.$route.params.vaultFiles&&this.setMediaData(this.$route.params.vaultFiles),this.isChat&&this.$route.query.scheduleMessageId&&this.$root.$on("updateScheduledMessage",(function(t){if(+t.id===+e.$route.query.scheduleMessageId){var i=e.getMediaData(t.media);e.uploadedFiles=e.uploadedFiles.map((function(e){return Gt(Gt({},e),e.id&&i.find((function(t){return+t.id===+e.id}))||{})}))}})),this.fakeMode||this.$route.params.vaultFiles||this.isTemplate||(this.needLoadDraft?(this.getMessageFromDraft(),this.removeChatFromDraft()):this.postDraft&&!this.isChat&&this.loadPostDraft()),this.editPost&&this.setPostData(this.post);var i=Object(d["get"])(this,"$route.params.scheduleDate"),s=Object(d["get"])(this,"$route.params.saveForLater");if(i&&(this.scheduleDate=i),s&&(this.saveForLater=s),this.isChat){this.scheduleQueueMessage&&(this.isEditScheduleMessages=!0,this.setDataSchedule(this.scheduleQueueMessage),this.$nextTick((function(){e.saveEditScheduleQueueMessageData()})));var o=Object(d["get"])(this,"$route.params.forwardMessageId");if(["ChatsSend","Chat"].includes(this.$route.name)&&o){var a=this.getMessage(o);a&&this.setDataSchedule(a)}}else this.editPost&&this.$nextTick((function(){e.editPostPayloadData=e.getDataObject()}));this.isTemplate||window.addEventListener("beforeunload",this.saveDraftOnUnload),this.scheduleDate=Object(d["get"])(this,"$route.params.scheduleDate",this.scheduleDate),this.saveForLater=Object(d["get"])(this,"$route.params.saveForLater",this.saveForLater),void 0!==this.$parent.tweetSend&&(this.$parent.tweetSend=this.fakeTweetSend),this.$root.$once("removeAllBeforeUnloadListeners",this.removeListeners),this.$root.$on("message::to::draft",this.saveDraft),this.$root.$on("message::from::draft",this.getMessageFromDraft),this.$refs.videoMessageBtn&&this.$nextTick((function(){e.showVideoMessage=!0,e.$route.params.openRecordVideo&&(e.openVideoRecordOnLoad=!0,document.documentElement.classList.add("p-personal-chats-chat"))})),this.$refs.audioRecordBtn&&this.$nextTick((function(){e.$route.params.openRecordAudio&&!e.uploadedFilesAudio.length&&e.toggleRecordPanel()}))},beforeDestroy:function(){this.$root.$off("closePhotoSwipe",this.hidePhotoSwipe),this.$root.$off("updateScheduledMessage"),this.$root.$off("setScheduleData",this.setScheduleData),document.body.classList.remove("open-panel"),this.removeListeners(),this.beforeLeaveMakePostFunc&&this.beforeLeaveMakePostFunc(),this.$root.$off("removeAllBeforeUnloadListeners",this.removeListeners),this.$root.$off("message::to::draft",this.saveDraft),this.$root.$off("message::from::draft",this.getMessageFromDraft),this.isChat||this.saveDraft(),this.isTemplate&&this.resetToDefault(),this.tribute&&this.tribute.destroy(),window.removeEventListener("beforeunload",this.saveDraftOnUnload)},methods:Gt(Gt(Gt(Gt(Gt(Gt(Gt(Gt({},Object(w["eb"])(["updateLabels","fetchPostLabels"])),Object(w["R"])(["preloaderShow"])),Object(w["jb"])(["setPost"])),Object(w["w"])(["setChatDraft","setPostDraft","removePostDraft","removeChatDraft"])),Object(w["k"])(["sendMessage","fetchChatsMessages"])),Object(w["Bb"])(["saveAutoMessage"])),Object(w["yc"])(["setModalUser"])),{},{setScheduleData:function(e){var t=e.saveForLater,i=void 0!==t&&t,s=e.scheduleDate,o=void 0===s?"":s;this.saveForLater=i,this.scheduleDate=o},addLabelsToPost:function(e){this.postLabels=e.map((function(e){var t=e.id;return t}))},isScheduleDateInPast:function(){return this.isScheduleDateInPastValue=!!this.scheduleDate&&u()(this.scheduleDate).isBefore(u()()),this.isScheduleDateInPastValue&&(this.scheduleDate=""),this.isScheduleDateInPastValue},submitPostMessage:function(){this.isChat?this.submitMessage():this.makePostSubmit()},addVaultFiles:function(e){var t=e.vaultFiles;this.setMediaData(t,!0)},updateFileThumbId:function(e,t){this.uploadedFiles=this.uploadedFiles.map((function(i){return e.processId&&e.processId===i.processId||e.id&&e.id===i.id?Gt(Gt({},i),{},{thumbId:t}):i}))},toggleLockDescription:function(){var e=this;this.lockDescription=!this.lockDescription,this.$nextTick((function(){e.scrollPreviewsThrottled()}))},openNewPostPage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i="function"===typeof t?t:function(){};this.$router.push({name:"PostsCreate",params:Gt(Gt({},e),{},{tweetSend:this.fakeTweetSend,noReload:!0})},i)},fileUploadChange:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t={accept:this.acceptFileExt,multiple:!0,validateParamsType:"photo"},!this.fakeMode){e.next=14;break}return e.prev=2,e.next=5,this.$uploader.perform(t);case 5:i=e.sent,this.openNewPostPage({fileUploadData:i}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),alert(e.t0);case 12:e.next=15;break;case 14:this.handleInputFile(t);case 15:case"end":return e.stop()}}),e,this,[[2,9]])})));function t(){return e.apply(this,arguments)}return t}(),textareaClick:function(){this.fakeMode&&this.openNewPostPage({setFocus:!0})},showPollHandler:function(e,t){var i=this;this.showPoll=e,this.votingType=t,e&&(this.pollLocked=this.privatePost,this.votingCorrectIndex=-1),this.privatePost&&this.$nextTick((function(){i.scrollPreviewsThrottled()}))},showFundraisingHandler:function(e){var t=this;this.showFundraising=e,this.privatePost&&this.$nextTick((function(){t.scrollPreviewsThrottled()}))},openModalPostPrice:function(){this.$root.$emit("bv::show::modal","ModalPostPrice")},openPostExpiration:function(){this.$root.$emit("bv::show::modal","ModalPostExpiration")},openScheduleDate:function(){var e=this;this.minDatetime=u()().add(10,"minutes").format(),this.$nextTick((function(){e.$refs.scheduleDatepicker.isOpen=!0,window.disableBodyScroll(!0),e.$nextTick((function(){e.minDatetime=(new Date).toISOString()}))}))},closeScheduleDate:function(){window.enableBodyScroll(!0)},getDataObject:function(){var e={};if(this.text&&(e.text=this.text.replace(/[\r\n]{2,}/g,"\n\n")),this.postLabels.length&&(e.labelIds=this.postLabels),this.uploadedFilesUrl.length>0&&(e.mediaFiles=this.uploadedFilesUrl),this.scheduleDate&&(e.isScheduled=1,e.scheduledDate=this.scheduleDate),this.saveForLater&&(e.isScheduled=1,e.isPublishedWithPeriod=1),this.authUser.isTwitterConnected&&this.authUser.twitterUsername&&(e.tweetSend=this.tweetSend),this.price&&(e.price=this.price),e.preview=[],this.freeFilesWithoutAudioList&&(e.preview=this.freeFilesWithoutAudioList.map((function(e){return e.processId||e.id}))),!this.audioLocked&&this.uploadedFilesAudio.length&&e.preview.push(this.uploadedFilesAudio[0].processId||this.uploadedFilesAudio[0].id),this.defaultPollExpired>0&&(e.expireDays=this.defaultPollExpired),this.showPoll&&this.votingOptions.length&&(e.votingOptions=this.votingOptions.filter((function(e){return e.length})),e.votingType=this.votingType,this.votingDuration>0&&(e.votingDue=this.votingDuration),this.votingCorrectIndex>=0&&this.votingType===this.QUIZ&&(e.votingCorrectIndex=this.votingCorrectIndex),this.pollLocked||e.preview.push("poll")),this.showFundraising){var t=this.fundraisingOptions.filter((function(e){return Number(e)>0})).map((function(e){return Number(e)}));t.length&&(e.fundRaisingTipsPresets=t,e.fundRaisingTargetAmount=Number(this.fundraisingTarget))}return this.privatePost&&this.lockDescription&&(e.lockedText=this.lockDescription),e},modalConfirmShow:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,window.interact(this.getTextModalConfirm,{confirmText:this.$t("message.yes")});case 2:t=e.sent,t?this.submitPostMessage():this.openScheduleDate();case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),makePostSubmit:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.isScheduleDateInPast()){e.next=4;break}return e.next=3,this.modalConfirmShow();case 3:return e.abrupt("return");case 4:if(!this.isSubmitting){e.next=6;break}return e.abrupt("return");case 6:if(this.isSubmitting=!0,this.makePostError="",i=this.getDataObject(),e.prev=9,this.preloaderShow(!0),!this.itHasPost){e.next=17;break}return e.next=14,Object(v["g"])(this.post.id,i);case 14:t=e.sent,e.next=20;break;case 17:return e.next=19,Object(v["d"])(i);case 19:t=e.sent;case 20:e.next=29;break;case 22:return e.prev=22,e.t0=e["catch"](9),this.preloaderShow(!1),this.isSubmitting=!1,s=Object(d["get"])(e.t0,"data.error.message")||Object(d["get"])(e.t0,"data.errors.text[0]"),s&&(this.makePostError=s),e.abrupt("return");case 29:if(void 0!==this.alreadyConfirmLeave&&(this.alreadyConfirmLeave=!0),this.preloaderShow(!1),this.isSubmitting=!1,!this.scheduleDate&&!this.saveForLater){e.next=36;break}return this.saveForLater&&!this.scheduleDate?this.$router.replace({name:"SavedForLater",params:{postForLaterId:Object(d["get"])(t,"id")}}):this.$router.replace({name:"MyQueue",params:{scheduleEventId:Object(d["get"])(t,"id"),date:u()(Object(d["get"])(t,"postedAt")).format("YYYY-MM-DD")}}),this.resetToDefault(),e.abrupt("return");case 36:if(!t||!t.id){e.next=45;break}if(this.setPost(t),o=Object(d["get"])(t,"labelStates",!1),!o||!o.length){e.next=42;break}return e.next=42,this.updateLabels(o);case 42:this.clearDraft(),this.resetToDefault(),this.itHasPost&&this.goBackState.routeFrom&&"Post"===this.goBackState.routeFrom.name&&this.goBackState.routeFrom.params.postId===t.id?this.goBack({name:"Post",params:{userId:this.authUser.username,postId:t.id,noReload:!0}}):this.$router.replace({name:"Post",params:{userId:this.authUser.username,postId:t.id,noReload:!0,noLoadPostData:!0}});case 45:case"end":return e.stop()}}),e,this,[[9,22]])})));function t(){return e.apply(this,arguments)}return t}(),resetToDefault:function(){this.postLabels=[],this.uploadedFiles=[],this.showPoll=!1,this.votingType=0,this.votingOptions=["",""],this.votingDuration=7,this.votingCorrectIndex=-1,this.defaultPollExpired=0,this.scheduleDate=null,this.text="",this.postUsage=!0,this.tweetSend=0,this.fakeTweetSend=0,this.makePostError="",this.isShowRecordPanel=!1,this.price=0,this.unlockedMedia=[],this.lockDescription=!1,this.saveForLater=!1,this.pollLocked=!1,this.uploadedFilesWithoutAudioList=[],this.freeFilesWithoutAudioList=[],this.isDraggingPreviews=!1,this.squarePreviews=!1,this.previewsOrder=[],this.paidMediaWithoutAudio=[],this.freeMediaWithoutAudio=[],this.paidMediaActive=!1,this.freeMediaActive=!1,this.mediaCentered=!1,this.paidMediaFirstActive=!1,this.freeMediaFirstActive=!1,this.mediaFirstCentered=!1,this.paidMediaText=!1,this.freeMediaText=!1,this.paidMediaAudio=!1,this.freeMediaAudio=!1,this.audioLocked=!1,this.showFundraising=!1,this.fundraisingTarget=0,this.fundraisingOptions=[5,""],this.tipValue="",this.isPhotoSwipeOpen=!1,this.photoSwipeOptions={index:0},this.videoSourcesForPhotoSwipe={},this.draftExistOnLoad=!1,this.$root.$emit("clearLabelsForNewPost")},deleteScheduleForItem:function(){this.scheduleDate=null,this.saveForLater=!1},clearInput:function(e){e.target.value=""},mediaSource:function(e){return e.source||e.full?e.source?e.source.source:e.full:e.video&&e.video.mp4?e.video.mp4:e.src},setPostData:function(e){var t=this;this.resetToDefault(),void 0!==e.rawText?e.rawText.trim().length&&(this.text=Object(Ft["b"])(e.rawText)):e.text.trim().length&&(this.text=Object(Ft["b"])(e.text)),this.uploadedFiles=e.media.map((function(e){var i;if(t.post.isMediaReady)i=e.type;else{var s=t.mediaSource(e),o=t.fileType(s);i=Object(qt["a"])(t.mediaConfig.ext,o)}var a="audio"===i?e.full:e.preview,r=Gt(Gt({},e),{},{mediaType:i,progress:100,deleteType:"DELETE",url:a,orderId:Math.random().toString(36).substr(2,9)});if("video"===i){r.videoPreview=!0;var n=Object(d["get"])(e,"files.preview.options",[]),c=Object(d["get"])(e,"files.preview.url",void 0);if(n.length){var l=n.find((function(e){return e.selected}))||n[0];r.thumbs=n,r.thumbId=l.id}else c&&(r.thumbs=[{id:1,selected:!0,url:c}],r.thumbId=1)}return e.source&&(e.source.width&&(r.width=e.source.width),e.source.height&&(r.height=e.source.height)),r})),this.post.canEditSchedule&&(this.post.isPublishedWithPeriod?this.setSaveForLater():this.scheduleDate=this.post.postedAt);var i=u()().startOf("day"),s=u()(this.post.postedAt).startOf("day");if(this.post.expiredAt){var o=u()(this.post.expiredAt).startOf("day");this.defaultPollExpired=o.diff(s,"days")}if(this.post.voting&&this.post.voting.options){this.showPoll=!0,this.votingOptions=this.post.voting.options.map((function(e){return e.name}));var r=u()(this.post.voting.finishedAt).startOf("day");this.votingDuration=r.diff(i>s?i:s,"days"),this.votingType=this.post.votingType,this.votingCorrectIndex=this.post.voting.options.findIndex((function(e){return e.isCorrect})),this.pollLocked=!this.post.preview.includes("poll")}this.post.fundRaising&&(this.showFundraising=!0,this.fundraisingOptions=Object(a["a"])(this.post.fundRaising.presets),this.fundraisingTarget=this.post.fundRaising.target),this.post.price>0&&(this.price=this.post.price),this.post.lockedText&&(this.lockDescription=this.post.lockedText),this.setFreeLockMedia(this.post.preview);var n=Object(d["get"])(this.post,"labelStates",[]);this.postLabels=n.map((function(e){var t=e.id;return t})),this.privatePost&&this.$nextTick((function(){t.scrollPreviewsThrottled()}))},getMediaData:function(e,t){var i=e.map((function(e){var t=e.type,i="audio"===t?e.src:e.preview,s=e.source&&e.source.duration?e.source.duration:0,o=Gt(Gt({},e),{},{duration:s,mediaType:t,progress:100,deleteType:"DELETE",sourceUrl:i,url:i,orderId:Math.random().toString(36).substr(2,9)});if("video"===t){o.videoPreview=!0;var a=Object(d["get"])(e,"files.preview.options",[]),r=Object(d["get"])(e,"files.preview.url",void 0);if(a.length){var n=a.find((function(e){return e.selected}))||a[0];o.thumbs=a,o.thumbId=n.id}else r?(o.thumbs=[{id:1,selected:!0,url:r}],o.thumbId=1):e.thumb&&(o.thumbs=[{id:1,selected:!0,url:e.thumb}])}return e.source&&(e.source.width&&(o.width=e.source.width),e.source.height&&(o.height=e.source.height)),o}));if(t){var s=[].concat(Object(a["a"])(this.uploadedFiles),Object(a["a"])(i)).reduce((function(e,t){return t.id?e.ids.includes(t.id)?e:{ids:[].concat(Object(a["a"])(e.ids),[t.id]),files:[].concat(Object(a["a"])(e.files),[t])}:Gt(Gt({},e),{},{files:[].concat(Object(a["a"])(e.files),[t])})}),{ids:[],files:[]});return s.files}return i},setMediaData:function(e,t){this.uploadedFiles=this.getMediaData(e,t)},setFreeLockMedia:function(e){var t=this;null!==e&&void 0!==e?void 0!==e.length?this.unlockedMedia=e:this.unlockedMedia=[e]:this.unlockedMedia=[],this.freeMediaWithoutAudio=this.uploadedFilesWithoutAudio.filter((function(e){return t.unlockedMedia.includes(e.id)})).map((function(e){return e.orderId})),this.paidMediaWithoutAudio=this.uploadedFilesWithoutAudio.filter((function(e){return t.unlockedMedia.indexOf(e.id)<0})).map((function(e){return e.id})),this.audioLocked=this.uploadedFilesAudio.length&&!this.unlockedMedia.includes(this.uploadedFilesAudio[0].id)},toggleFundingPanel:function(){this.$root.$emit("bv::show::modal","ModalFunds")},onRecordAudioClick:function(){this.fakeMode?this.openNewPostPage({openRecordAudio:!0}):this.toggleRecordPanel()},toggleRecordPanel:function(){this.isShowRecordPanel?enableBodyScroll():disableBodyScroll(),this.isShowRecordPanel=!this.isShowRecordPanel,document.body.classList.toggle("open-panel",this.isShowRecordPanel)},uploadVideo:function(e){this.handleInputFile(e)},uploadAudio:function(e){this.fakeMode?this.openNewPostPage({fileUploadData:e.data}):this.handleInputFile(e)},setPrice:function(e){var t=this;this.price=+e,this.privatePost&&(this.paidMediaWithoutAudio=this.uploadedFilesWithoutAudio.map((function(e){return e.orderId})),this.$nextTick((function(){t.scrollPreviewsThrottled()}))),this.showPoll&&(this.pollLocked=this.privatePost),this.draftMessage||(this.audioLocked=this.privatePost)},deletePrice:function(){this.savePreviewsOrder(),this.price=0},setTarget:function(e){this.fundraisingTarget=+e,this.showFundraisingHandler(!!+e)},saveDraftOnUnload:function(){this.saveDraft()},prepareDraftMessage:function(){var e=this,t=["text","lockDescription","uploadedFiles","paidMediaWithoutAudio","freeMediaWithoutAudio","price","audioLocked","defaultPollExpired","showPoll","votingOptions","votingDuration","votingType","votingCorrectIndex","pollLocked","scheduleDate","tipValue","scheduledSubscribedOn"],i={};return this.isMultipleUserMessageOrBulk&&(t=t.concat(["listIds","excludeListIds","awards","excludedUsersIds","fundRaisingPostId","userIds","sendToQueue","postDonators","postBuyers","postLikeds","postVoters"])),t.forEach((function(t){i[t]=e[t]})),i},prepareDraftPost:function(){var e=this,t=["text","uploadedFiles","audioLocked","paidMediaWithoutAudio","freeMediaWithoutAudio","scheduleDate","saveForLater","tweetSend","price","defaultPollExpired","showPoll","votingOptions","votingDuration","votingType","votingCorrectIndex","pollLocked","showFundraising","fundraisingOptions","fundraisingTarget","lockDescription","postLabels"],i={};return t.forEach((function(t){i[t]=e[t]})),i},getMessageFromDraft:function(){var e=this;this.needLoadDraft&&this.draftMessage&&(Object.keys(this.draftMessage).forEach((function(t){e.chatsSendList.includes(t)||(e[t]=e.draftMessage[t])})),this.draftMessage.price&&this.setPrice(this.price))},loadPostDraft:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getPostFromDraft();case 2:this.draftExistOnLoad=!0,this.$emit("onDraftPostLoaded"),this.clearDraft();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getPostFromDraft:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=JSON.parse(Ue["a"].getItem("draft")||"{}"),i=Object(d["get"])(t,"draft.postDraft.".concat(this.authUser.id)),!this.$route.params.postId&&i&&Object.keys(this.userPostDraft).forEach((function(e){s[e]=s.userPostDraft[e]})),!this.userPostDraft.postLabels){e.next=6;break}return e.next=6,this.fetchPostLabels({offset:this.offset,labelsIds:this.userPostDraft.postLabels});case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),prepareBaseMessagePayload:function(){var e={text:this.text.replace(/[\r\n]{2,}/g,"\n\n"),lockedText:this.lockDescription,mediaFiles:this.uploadedFilesUrl,price:this.price,previews:[]};return this.scheduleDate&&(e.isScheduled=1,e.scheduledDate=this.scheduleDate),this.freeFilesWithoutAudioList&&(e.previews=this.freeFilesWithoutAudioList.map((function(e){return e.processId||e.id}))),!this.audioLocked&&this.uploadedFilesAudio.length&&e.previews.push(this.uploadedFilesAudio[0].processId||this.uploadedFilesAudio[0].id),e},saveEditScheduleQueueMessageData:function(){var e=this.prepareBaseMessagePayload();this.startEditScheduleMessagesData=this.prepareMultipleUserMessageData(e)},saveDraft:function(e){if(!(this.isSubmitting||this.isTemplate||this.fakeMode||this.editPost)){var t=this.uploadedFiles.filter((function(e){return 100===e.progress||"tip"===e.mediaType}));if(this.isChat){if(!this.scheduleQueueMessage&&Object(Ht["a"])(this.authUser,this.chat)&&!this.withUser.isRestricted){var i=e||Number(this.chat.withUser)||"queue";i&&(this.dataAvailability?this.setChatDraft(Gt(Gt({},this.prepareDraftMessage()),{},{chatId:i,uploadedFiles:t})):this.draftMessage&&(this.resetToDefault(),this.removeChatFromDraft()))}}else this.dataAvailability?this.setPostDraft({draft:Gt(Gt({},this.prepareDraftPost()),{},{userId:this.authUser.id,uploadedFiles:t}),userId:this.authUser.id}):this.postDraft&&this.clearDraft()}},clearDraft:function(){this.postDraft&&!this.editPost&&this.removePostDraft(this.authUser.id)},clearDraftAndReset:function(){this.resetToDefault(),this.clearDraft()},setSaveForLater:function(){this.scheduleDate=null,this.saveForLater=!0},checkPreviewRatio:function(){var e=this.uploadedFilesPhoto[0],t=e.width,i=e.height;return this.uploadedFilesPhoto.some((function(e,s){return!!(s&&e.width&&e.height&&t&&i)&&(e.width/e.height).toFixed(2)!==(t/i).toFixed(2)}))},enableDraggablePreviews:function(){var e=this;this.isDraggingPreviews=!0,this.privatePost&&this.$nextTick((function(){e.scrollPreviewsThrottled()}))},setPreviewOrder:function(e){var t=this.previewsOrder.indexOf(e);t>-1?this.previewsOrder.splice(t,1):this.previewsOrder.push(e)},getPreviewOrder:function(e){var t=this.previewsOrder.indexOf(e);return t>-1?t+1:""},sortByNumber:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.sort((function(e,s){var o=t.previewsOrder.indexOf(e.orderId),a=t.previewsOrder.indexOf(s.orderId);return o<0&&a<0?0:o<0?i?1:-1:a<0?i?-1:1:o-a})),this.previewsOrder=[]},movePreviewsToBeginning:function(){var e=this;this.privatePost?(this.previewsOrder.length?(this.paidMediaWithoutAudio=this.paidMediaWithoutAudio.filter((function(t){return e.previewsOrder.indexOf(t)<0})),this.freeMediaWithoutAudio=this.freeMediaWithoutAudio.filter((function(t){return e.previewsOrder.indexOf(t)<0})).concat(this.previewsOrder),this.$nextTick((function(){e.sortByNumber(e.freeFilesWithoutAudioList,!0)}))):this.paidMediaWithoutAudio.length&&(this.freeMediaWithoutAudio=this.freeMediaWithoutAudio.concat(this.paidMediaWithoutAudio),this.paidMediaWithoutAudio=[]),this.$nextTick((function(){e.scrollPreviewsThrottled()}))):this.previewsOrder.length&&this.sortByNumber(this.uploadedFilesWithoutAudioList,!0)},movePreviewsToEnd:function(){var e=this;this.privatePost?(this.previewsOrder.length?(this.freeMediaWithoutAudio=this.freeMediaWithoutAudio.filter((function(t){return e.previewsOrder.indexOf(t)<0})),this.paidMediaWithoutAudio=this.paidMediaWithoutAudio.filter((function(t){return e.previewsOrder.indexOf(t)<0})).concat(this.previewsOrder),this.$nextTick((function(){e.sortByNumber(e.uploadedFilesWithoutAudioList,!0)}))):this.freeMediaWithoutAudio.length&&(this.paidMediaWithoutAudio=this.paidMediaWithoutAudio.concat(this.freeMediaWithoutAudio),this.freeMediaWithoutAudio=[]),this.$nextTick((function(){e.scrollPreviewsThrottled()}))):this.previewsOrder.length&&this.sortByNumber(this.uploadedFilesWithoutAudioList)},savePreviewsOrder:function(){var e=this;this.previewsOrder.length&&this.movePreviewsToBeginning(),this.uploadedFiles=this.freeFilesWithoutAudioList.concat(this.uploadedFilesWithoutAudioList,this.uploadedFilesAudio),this.isDraggingPreviews=!1,this.previewsOrder=[],this.privatePost&&this.$nextTick((function(){e.scrollPreviewsThrottled()}))},onPreviewMoveFree:function(e){var t=this.$refs["draggable-container-free"].$el.querySelectorAll(".b-make-post__preview")[e.draggedContext.futureIndex].getBoundingClientRect().left-this.$refs.scrollbarFree.$el.getBoundingClientRect().left,i=this.$refs.scrollbarFree.$el.getBoundingClientRect().right-this.$refs["draggable-container-free"].$el.querySelectorAll(".b-make-post__preview")[e.draggedContext.futureIndex].getBoundingClientRect().right;t<0?this.$refs.scrollbarFree.$swiper.translateTo(this.$refs.scrollbarFree.$swiper.getTranslate()-t+20,500):i<0&&this.$refs.scrollbarFree.$swiper.translateTo(this.$refs.scrollbarFree.$swiper.getTranslate()+i-20,500)},onPreviewMovePaid:function(e){var t=this.$refs["draggable-container-paid"].$el.querySelectorAll(".b-make-post__preview")[e.draggedContext.futureIndex].getBoundingClientRect().left-this.$refs.scrollbarPaid.$el.getBoundingClientRect().left,i=this.$refs.scrollbarPaid.$el.getBoundingClientRect().right-this.$refs["draggable-container-paid"].$el.querySelectorAll(".b-make-post__preview")[e.draggedContext.futureIndex].getBoundingClientRect().right;t<0?this.$refs.scrollbarPaid.$swiper.translateTo(this.$refs.scrollbarPaid.$swiper.getTranslate()-t+20,500):i<0&&this.$refs.scrollbarPaid.$swiper.translateTo(this.$refs.scrollbarPaid.$swiper.getTranslate()+i-20,500)},scrollPreviewsThrottled:function(){var e=this;setTimeout((function(){if(e.mediaCentered=!1,e.freeMediaActive=!1,e.paidMediaActive=!1,e.paidMediaFirstActive=!1,e.freeMediaFirstActive=!1,e.mediaFirstCentered=!1,e.paidMediaAudio=!1,e.freeMediaAudio=!1,e.paidMediaText=!1,e.freeMediaText=!1,e.privatePost)try{var t=e.$refs.makePost.offsetWidth,i=e.$refs.paidContentLabel.offsetLeft,s=i+48,o=e.hasPostItemExceptMedia?e.hasPostLockedItem?30:t-72:i;if(o+=48,e.uploadedFilesWithoutAudio.length){var a=e.isMobile?e.$refs.scrollbarPaid:e.$refs.scrollbarPaid.$el,r=a.offsetLeft-e.$refs.postMedia.scrollLeft;Math.abs(o-r)<8?e.mediaCentered=!0:o<r?e.freeMediaActive=!0:e.paidMediaActive=!0,e.isMediaFirst&&(Math.abs(s-r)<8?e.mediaFirstCentered=!0:s<r?e.freeMediaFirstActive=!0:e.paidMediaFirstActive=!0),e.uploadedFilesAudio.length&&(e.audioLocked&&r<24?e.paidMediaAudio=!0:!e.audioLocked&&r>t-24&&(e.freeMediaAudio=!0)),e.lockDescription&&r<24?e.paidMediaText=!0:!e.lockDescription&&r>t-24&&(e.freeMediaText=!0)}}catch(n){}}),100)},scrollPreviews:Object(d["throttle"])((function(){this.scrollPreviewsThrottled()}),250),getThumb:function(e){var t=Object(d["get"])(e,"thumbs",[]),i=e.thumbId;!i&&t.length&&(i=t[0].id);var s=t.find((function(e){return e.id===i})),o=s?s.url:"";return o||("photo"===e.mediaType||"gif"===e.mediaType||"video"===e.mediaType&&e.processId?e.url:void 0)},openPreview:function(e){this.showPhotoSwipe({index:e})},toggleAudioLocked:function(){var e=this;this.audioLocked=!this.audioLocked,this.$nextTick((function(){e.scrollPreviewsThrottled()}))},handleBeforeUnloadPost:function(e){if(this.hasBeforeunloadPostEvent){var t=this.checkLeaveTextPost;return e=e||window.event,e&&(e.returnValue=t),t}return""},removeListeners:function(){this.hasBeforeunloadPostEvent&&(window.removeEventListener("beforeunload",this.handleBeforeUnloadPost),this.hasBeforeunloadPostEvent=!1)},prepareMultipleUserMessageData:function(e){return this.userIds.length&&(e.userIds=this.userIds),this.getListsUsersCount?(this.listIds.includes("recent")&&(e.recent=1),this.listIds.length&&(e.userLists=this.listIds.filter((function(e){return"recent"!==e}))),this.excludeListIds.length&&(e.excludedLists=[].concat(Object(a["a"])(this.excludeListIds.includes("recent")?["last24h"]:[]),Object(a["a"])(this.excludeListIds.filter((function(e){return e===Number(e)}))))),this.excludedUsersIds.length&&(e.excludeUserIds=this.excludedUsersIds)):this.fundRaisingPostId?(e.fundRaisingPostId=this.fundRaisingPostId,this.excludedUsersIds.length&&(e.excludeUserIds=this.excludedUsersIds)):this.awards.length?(e.awards=this.awards.join("/"),this.excludedUsersIds.length&&(e.excludeUserIds=this.excludedUsersIds)):this.sendToQueue?(e.queueBuyers=[this.sendToQueue],this.excludedUsersIds.length&&(e.excludeUserIds=this.excludedUsersIds)):this.postDonators?(e.postDonators=this.postDonators,this.excludedUsersIds.length&&(e.excludeUserIds=this.excludedUsersIds)):this.postBuyers?(e.postBuyers=this.postBuyers,this.excludedUsersIds.length&&(e.excludeUserIds=this.excludedUsersIds)):this.postLikeds?(e.postLikeds=this.postLikeds,this.excludedUsersIds.length&&(e.excludeUserIds=this.excludedUsersIds)):this.postVoters?(e.postVoters=this.postVoters,this.excludedUsersIds.length&&(e.excludeUserIds=this.excludedUsersIds)):this.userIds.length&&this.scheduleDate&&(e.userIds=this.userIds),this.scheduledSubscribedOn&&(e.scheduledSubscribedOn=u()(this.scheduledSubscribedOn).subtract(1,"days").toISOString()),e},submitMessage:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,i,s,o,a,r,n,c,l,h,p=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.disabledSubmit&&this.authUser.canChat){e.next=2;break}return e.abrupt("return");case 2:if(this.isSubmitting=!0,!this.tipValue){e.next=20;break}return window.doTips=function(){},e.next=7,this.makePayments({paymentType:"tip",amount:this.tipValue,text:this.text,userId:this.$route.params.chatId,vatData:this.withUser&&!!this.withUser.vat&&{vat:this.withUser.vat},tipSource:"chat",mediaFiles:this.uploadedFilesUrl},(function(){p.submitMessage()}));case 7:if(t=e.sent,!t||!t.success){e.next=18;break}return e.prev=9,e.next=12,this.fetchChatsMessages({userId:this.$route.params.chatId,lastId:this.chat.messages[this.chat.messages.length-1],more:!0,before:!1});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](9),Sentry.captureException(e.t0);case 17:this.resetToDefault();case 18:return this.isSubmitting=!1,e.abrupt("return");case 20:if(i=this.prepareBaseMessagePayload(),!this.isTemplate){e.next=35;break}return e.prev=22,e.next=25,this.saveAutoMessage(i);case 25:e.next=32;break;case 27:return e.prev=27,e.t1=e["catch"](22),Object(Wt["b"])(e.t1),this.isSubmitting=!1,e.abrupt("return");case 32:return this.resetToDefault(),this.removeChatFromDraft(),e.abrupt("return");case 35:if(!this.isSingleMessageWithUserIdToSend){e.next=51;break}if(s=this.userIdToSend||this.usersIdsToSend[0],!s){e.next=49;break}return e.next=40,this.sendMessage({id:s,data:i});case 40:if(o=e.sent,void 0!==this.alreadyConfirmLeave&&(this.alreadyConfirmLeave=!0),!o){e.next=47;break}this.removeChatFromDraft(),this.$router.replace({name:"Chat",params:{chatId:s}}),e.next=49;break;case 47:return this.isSubmitting=!1,e.abrupt("return");case 49:e.next=114;break;case 51:if(!this.isSingleMessageWithChatId){e.next=88;break}if(a=this.$route.params.chatId,r=!!Object(d["get"])(this.$route,"query"),!this.scheduleDate){e.next=75;break}if(i.userIds=[a],r&&this.getFilterData(i),e.prev=57,!this.isEditScheduleMessages){e.next=65;break}return e.next=61,Object(b["x"])(i,this.scheduleQueueMessage.id);case 61:n=e.sent,n&&void 0!==n.pending&&(this.removeChatFromDraft(),this.removeListeners(),this.$router.replace({name:"MyQueue",params:{scheduleEventId:Object(d["get"])(n,"id"),date:u()(this.scheduleDate).format("YYYY-MM-DD")}})),e.next=68;break;case 65:return e.next=67,Object(b["z"])(i);case 67:this.removeChatFromDraft();case 68:e.next=75;break;case 70:return e.prev=70,e.t2=e["catch"](57),Object(Wt["b"])(e.t2),this.isSubmitting=!1,e.abrupt("return");case 75:if(!a||this.scheduleDate){e.next=86;break}return e.next=78,this.sendMessage({id:a,data:i});case 78:if(c=e.sent,400!==c.status||!Object(d["get"])(c,"data.errors.textHighLight[0]")){e.next=84;break}return this.textHighLight=c.data.errors.textHighLight[0],this.isForbiddenError=!0,this.isSubmitting=!1,e.abrupt("return");case 84:this.resetToDefault(),this.removeChatFromDraft();case 86:e.next=114;break;case 88:if(!this.isMultipleUserMessageOrBulk){e.next=113;break}if(this.prepareMultipleUserMessageData(i),h=!!Object(d["get"])(this.$route,"query"),h&&this.getFilterData(i),e.prev=92,!this.isEditScheduleMessages){e.next=99;break}return e.next=96,Object(b["x"])(i,this.scheduleQueueMessage.id);case 96:l=e.sent,e.next=102;break;case 99:return e.next=101,Object(b["z"])(i);case 101:l=e.sent;case 102:e.next=109;break;case 104:return e.prev=104,e.t3=e["catch"](92),Object(Wt["b"])(e.t3),this.isSubmitting=!1,e.abrupt("return");case 109:void 0!==this.alreadyConfirmLeave&&(this.alreadyConfirmLeave=!0),l&&void 0!==l.pending&&(this.removeChatFromDraft(),this.removeListeners(),this.scheduleDate?this.$router.push({name:"MyQueue",params:{scheduleEventId:Object(d["get"])(l,"id"),date:u()(this.scheduleDate).format("YYYY-MM-DD")}}):this.$router.push({name:"Chats"})),e.next=114;break;case 113:alert(this.$t("message.please_select_the_recipient"));case 114:this.isSubmitting=!1,this.resetToDefault(),this.removeChatFromDraft();case 117:case"end":return e.stop()}}),e,this,[[9,14],[22,27],[57,70],[92,104]])})));function t(){return e.apply(this,arguments)}return t}(),removeChatFromDraft:function(){this.draftMessage&&!this.$route.query.scheduleMessageId&&this.removeChatDraft(this.draftMessage.chatId||"queue")},openVaultModal:function(){var e=this;this.fakeMode?this.openNewPostPage({},(function(){e.$nextTick((function(){setTimeout((function(){e.$root.$emit("bv::show::modal","ModalMediaVault")}),0),e.$mq.includes("sm")&&document.documentElement.classList.contains("p-personal-chats-chat")&&document.documentElement.classList.add("m-modal-in-chat-opened")}))})):(this.$root.$emit("bv::show::modal","ModalMediaVault"),this.$mq.includes("sm")&&document.documentElement.classList.contains("p-personal-chats-chat")&&document.documentElement.classList.add("m-modal-in-chat-opened"))},openTipPanel:function(){var e=this,t=Object(d["get"])(this.withUser,"id",!1);this.setModalUser({userId:t});var i=this.doSetTip;this.$nextTick((function(){e.$root.$emit("bv::show::modal:chat:tips",i)}))},doSetTip:function(e){this.tipValue=e},onDeleteTip:function(){this.tipValue=""},clearTipValue:function(){this.tipValue=""},triggerRecVideo:function(){this.$refs.videoMessageBtn.click()},onRecordVideoClick:function(){this.fakeMode?this.openNewPostPage({openRecordVideo:!0}):document.documentElement.classList.add("p-personal-chats-chat")},makeSubmitMessage:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.hasMoreMessagesBottom){e.next=3;break}return e.next=3,this.fetchChatsMessages({userId:this.$route.params.chatId});case 3:if(!this.isTemplate||Object(d["isEmpty"])(this.template)){e.next=7;break}return e.next=6,this.submitMessage();case 6:return e.abrupt("return");case 7:if(!(this.isScheduleDateInPast()||this.selectedUsersIdsCount>1||!this.selectedUsersIdsCount&&this.listIds.length)||"ChatsSend"!==this.$route.name){e.next=12;break}return e.next=10,this.modalConfirmShow();case 10:e.next=14;break;case 12:return e.next=14,this.submitMessage();case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onKeyDownEnter:function(e){e&&"keydown"===e.type&&this.isMultilineDisabled&&e.preventDefault()},makeSubmitMessageEnter:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t||"keyup"!==t.type||!this.isMultilineDisabled){e.next=5;break}return t.preventDefault(),e.next=4,this.makeSubmitMessage();case 4:this.$nextTick((function(){i.$refs.textarea&&i.$refs.textarea.$el.querySelector("textarea").focus()}));case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setDataSchedule:function(e){var t=this;this.setMediaData(e.media),this.text=this.getTextEncode(e),this.price=e.price||"",this.scheduleDate=e.scheduledAt||"",this.lockDescription=e.lockedText,null!==e.previews&&void 0!==e.previews?void 0!==e.previews.length?this.unlockedMedia=e.previews:this.unlockedMedia=[e.previews]:this.unlockedMedia=[],this.freeMediaWithoutAudio=this.uploadedFilesWithoutAudio.filter((function(e){return t.unlockedMedia.includes(e.id)})).map((function(e){return e.orderId}))},setDataFromStore:function(){this.text=this.getTextEncode(this.template),this.price=this.template.price,this.lockDescription=this.template.lockedText},getFilterData:function(e){var t=this.$route.query,i=t.total_spent,s=t.tips,o=t.duration,a=t.inactive,r=t.recommenders,n=t.signed_up_before,d=t.signed_up_after;return s&&(e["filter[tips]"]=s),i&&(e["filter[total_spent]"]=i),o&&(e["filter[duration]"]=o),a&&(e["filter[inactive]"]=a),r&&(e["filter[recommenders]"]=r),n&&(e["filter[signed_up_before]"]=n),d&&(e["filter[signed_up_after]"]=d),this.scheduledSubscribedOn&&(e["filter[recent]"]=1),e},getTextEncode:function(e){if(void 0!==e.rawText){if(e.rawText.trim().length)return Object(Ft["c"])(e.rawText)}else if(e.text.trim().length)return Object(Ft["c"])(e.text);return""},resetForbiddenError:function(){this.isForbiddenError=!1},typingMessage:Object(d["throttle"])((function(){if(this.isChat&&this.text.length)try{this.$socket.sendObj({act:"typing",typing_to:this.chat.withUser})}catch(e){}}),3e3,{trailing:!1}),getVideoSourcesForPhotoSwipe:function(){var e=this;return this.uploadedFilesWithoutAudio.reduce((function(t,i){if(!["video","gif"].includes(i.mediaType)||100!==i.progress)return t;var s;if(i.id){var o=e.getMediaId(i.id);o&&(s=Gt({},o.source))}if(i.processId){var a=i.height,r=void 0===a?0:a,c=i.width,l=void 0===c?0:c,u=i.sourceUrl;s={height:r,width:l,source:u}}var h=i.id||i.processId;if(!s){var p=Object(d["get"])(e,"videoSourcesForPhotoSwipe.".concat(h,".source"));s=Gt({},p)}Object.keys(s).length||(s=Gt({},i.source));var m=e.getVideoPoster(i),f=Gt(Gt({id:h},s?{source:s}:{}),{},{preview:m,type:i.mediaType});return Gt(Gt({},t),{},Object(n["a"])({},h,f))}),{})},resetScheduledDraftPost:function(){if(this.userPostDraft.scheduleDate&&u()(this.userPostDraft.scheduleDate)-u()()<0){var e=Gt({},this.userPostDraft);e.scheduleDate=null,this.setPostDraft({draft:e,userId:e.userId})}},resetPaidDraftPost:function(){if(this.authUser.subscribePrice){var e=Gt({},this.userPostDraft);e.price=0,this.setPostDraft({draft:e,userId:e.userId})}},onFocus:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.authUser.isPerformer||this.fakeMode||this.tribute){e.next=9;break}return e.prev=1,e.next=4,Kt();case 4:this.tribute=e.sent.default(this.$refs.textarea.$el.querySelector("textarea")),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](1);case 9:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}()})},Zt=Jt,Xt=(i("aaf8"),Object(x["a"])(Zt,s,o,!1,null,"12245796",null));t["default"]=Xt.exports},fd85:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"b-price-input g-input__wrapper",class:{"m-placeholder-free":e.placeholder&&e.allowFree,"m-error-row":e.messagePriceError}},[i("input-o-f",{staticClass:"m-reset-bottom-gap",attrs:{id:e.inputId,value:e.value,inputmode:"decimal",placeholder:e.placeholder,label:e.label,hint:e.hintMessage,error:e.messagePriceError,autocomplete:"price-input",autofocus:e.autofocus,prefix:e.hidePrefix?"":e.currencySymbol,"number-only":"","allow-free":e.allowFree,"hide-optional":e.hideOptional,disabled:e.disabled,readonly:e.readonly,required:e.required},on:{input:e.onInput,change:e.onChange},scopedSlots:e._u([{key:"customInfoSlot",fn:function(){return[e._t("customInfoSlot")]},proxy:!0}],null,!0)})],1)},o=[],a=(i("c5f6"),i("2ef0")),r=i("13ca"),n=i("b37e"),d={name:"PriceInput",components:{InputOF:r["a"]},props:{value:{type:[Number,String],default:0},min:{type:Number,default:0},max:{type:Number,default:1e3,validator:function(e){return e>0}},placeholder:{type:String,required:!1},label:{type:String,required:!1},allowFree:{type:Boolean,default:!0},precision:{type:Number,default:2},currency:{type:String,default:"usd"},autofocus:{type:Boolean,default:!0},hideOptional:{type:Boolean,default:!1},hidePrefix:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},isValid:{type:Boolean,default:!0},error:{type:String,default:""}},computed:{inputId:function(){return Object(a["uniqueId"])("priceInput_")},currencySymbol:function(){return n["a"].getSymbol(this.currency)},hintMessage:function(){return this.allowFree?this.$t("message.min_price_label_without_currency_or_free",{MIN:"".concat(this.currencySymbol).concat(this.min," ").concat(this.currency.toUpperCase())}):this.$t("message.min_price_label_without_currency",{MIN:"".concat(this.currencySymbol).concat(this.min," ").concat(this.currency.toUpperCase())})},messagePriceError:function(){if(this.error)return this.error;if(this.value){if(this.allowFree&&0===Number(this.value))return"";if(this.value<this.min)return this.allowFree?this.$t("message.min_price_label_without_currency_or_free",{MIN:"".concat(this.currencySymbol).concat(this.min," ").concat(this.currency.toUpperCase())}):this.$t("message.min_price_label_without_currency",{MIN:"".concat(this.currencySymbol).concat(this.min," ").concat(this.currency.toUpperCase())});if(this.value>this.max)return this.$t("message.max_price_label_without_currency",{MAX:"".concat(this.currencySymbol).concat(this.max," ").concat(this.currency.toUpperCase())})}return""}},watch:{messagePriceError:function(e){this.$emit("update:isValid",!e.length)}},methods:{onInput:function(e){this.$emit("input",e)},onChange:function(e){this.$emit("input",e),this.$emit("change",e)}}},c=d,l=i("2877"),u=Object(l["a"])(c,s,o,!1,null,null,null);t["a"]=u.exports}}]);