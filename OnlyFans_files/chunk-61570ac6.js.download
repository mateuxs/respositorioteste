(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61570ac6"],{"0b88":function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"b-story-answer"},[s("div",{staticClass:"b-story-answer__header"},[s("avatar",{staticClass:"m-absolute",attrs:{"user-id":t.answer.userId,"is-link":!1,size:24,"disable-story-functionality":""}}),s("div",{staticClass:"b-username-row m-gap-clear"},[s("username-block",{attrs:{user:t.user,size:"md","is-link":""},on:{click:t.closeStory}})],1)],1),s("div",{staticClass:"b-story-answer__body",class:t.storyAnswerExtraClass},[s("div",{staticClass:"b-story-answer__body-inside",domProps:{textContent:t._s(t.answer.text)}})]),s("div",{staticClass:"b-story-answer__footer"},[s("button",{staticClass:"g-btn m-rounded m-block",on:{click:t.reply}},[t._v(" "+t._s(t.$t("message.comment_reply_button"))+" ")])])])},i=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),n=(s("c5f6"),s("2ef0")),o=s("d634"),c=s("b48d"),u=s("2ad1");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function d(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var h={name:"StoryAnswer",components:{Avatar:c["a"],UsernameBlock:u["a"]},props:{answer:{type:Object,required:!0},storyId:{type:Number,required:!0},closeStory:{type:Function,required:!0}},computed:d(d({},Object(o["tc"])(["getUser"])),{},{user:function(){return this.getUser(this.answer.userId)},storyAnswerExtraClass:function(){var t=Object(n["get"])(this,"answer.text.length",0);return t>50?"m-long":t>30&&t<=50?"m-so-long":""}}),methods:{reply:function(){this.$root.$emit("component::story::answerModel::show",d(d({},this.answer),{},{storyId:this.storyId}))}}},b=h,m=s("2877"),p=Object(m["a"])(b,r,i,!1,null,null,null);e["a"]=p.exports},"243b5":function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"b-viewer-row"},[s("div",{staticClass:"b-viewer-row__name",class:{"m-disabled":t.user.isStoryBlockedUser||t.user.isBlocked}},[s("a",{staticClass:"b-viewer-row__link",attrs:{href:"/"+t.user.username},on:{click:function(e){return e.preventDefault(),function(){return t.goToProfile(t.user.username)}()}}},[s("avatar",{staticClass:"m-absolute m-valign-center",attrs:{"user-id":t.user.id,"is-link":!1}}),s("span",{staticClass:"b-username-row m-width-limit"},[s("span",{staticClass:"b-username"},[s("span",{staticClass:"g-user-name"},[t._v(" "+t._s(t.user.username)+" ")])])])],1)]),s("div",{staticClass:"b-viewer-row__option"},[t.user.isStoryLiked?s("span",{staticClass:"stat-like-story"},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-liked"})]):t._e(),s("b-dropdown",{ref:"dropdown",attrs:{right:"","toggle-class":"m-not-width-limit",variant:"link",offset:"4"},scopedSlots:t._u([{key:"button-content",fn:function(){return[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-more"})]},proxy:!0}])},[s("b-dropdown-item-button",{staticClass:"m-align-center m-item-with-icon",on:{click:t.hideStoryHandler}},[t._v(" "+t._s(t.user.isStoryBlockedUser?t.$t("message.unhide_story_btn_title"):t.$t("message.hide_story_btn_title"))+" ")]),s("b-dropdown-item-button",{staticClass:"m-align-center m-item-with-icon",on:{click:t.blockUserHandler}},[t._v(" "+t._s(t.user.isBlocked?t.$t("message.unblock_user_btn_title"):t.$t("message.block_user_btn_title"))+" ")])],1)],1)])},i=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),n=(s("c5f6"),s("d634")),o=s("b48d"),c=s("e43a");function u(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function l(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?u(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var d={name:"StoryViewer",components:{Avatar:o["a"]},props:{viewer:{type:Number,required:!0},goToProfile:{type:Function,required:!0}},computed:l(l({},Object(n["tc"])(["getUser"])),{},{user:function(){return this.getUser(this.viewer)}}),methods:l(l(l({},Object(n["sc"])(["toggleHideStoryFromUser","toggleBlockUser"])),Object(n["Qb"])(["blockUser","unblockUser"])),{},{hideStoryHandler:function(){this.toggleHideStoryFromUser(this.viewer),this.$refs.dropdown.hide(!0)},blockUserHandler:function(){var t="StoryViewer_".concat(this.$route.name),e=this.user,s=!1;Object(c["a"])({user:e,isRestrict:s,block:t}),this.toggleBlockUser(this.viewer),this.$refs.dropdown.hide(!0)}})},h=d,b=s("2877"),m=Object(b["a"])(h,r,i,!1,null,null,null);e["a"]=m.exports},"340a":function(t,e,s){"use strict";s("377d")},"377d":function(t,e,s){},"483c":function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"b-users__item m-fans"},[s("div",{staticClass:"b-users__item__inner",class:{"m-bg-colored":t.isExpired||t.user.isBlocked,"m-expanded":t.isExpanded,"m-no-pointer":t.isBlockRestrictLoading}},[s("div",{staticClass:"b-fans__item__header"},[s("avatar",{staticClass:"m-absolute",attrs:{"user-id":t.user.id,size:50}}),s("div",{staticClass:"b-username-row"},[s("router-link",{staticClass:"b-username",attrs:{to:{name:"Profile",params:{userId:t.user.username}},custom:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.href,i=e.navigate;return[s(t.isProfile?"div":"a",t._b({tag:"component",on:{click:function(e){!t.isProfile&&i(e)}}},"component",t.isProfile?{}:{href:r},!1),[s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.enabled",value:{content:t.displayNameEncoded,classes:t.isModal?"m-tooltip-higher":""},expression:"{ content: displayNameEncoded, classes: isModal ? 'm-tooltip-higher': '' }",modifiers:{enabled:!0}}],staticClass:"g-user-name",class:{"m-muted":t.user.isRestricted,"m-verified":t.user.isVerified},attrs:{"at-attr":"custom_name"}},[t._v(" "+t._s(t.displayNameEncoded)+" "),t.user.isVerified?s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-verified",attrs:{"extra-class":"m-verified"}}):t._e()])])]}}])}),s("user-custom-name",{attrs:{"user-id":t.user.id,tooltip:{content:t.$t("message.edit"),classes:t.expanded?"m-tooltip-higher":""}}})],1),s("div",{staticClass:"b-username-row m-gap-clear"},[s("router-link",{staticClass:"g-user-realname__wrapper m-nowrap-text",attrs:{"at-attr":"user_link",to:{name:"Profile",params:{userId:t.user.username}},custom:""},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.href,i=e.navigate;return[s(t.isProfile?"div":"a",t._b({tag:"component",on:{click:function(e){!t.isProfile&&i(e)}}},"component",t.isProfile?{}:{href:r},!1),[t.user.displayName&&t.user.name!==""+t.userLoginPrefix+t.user.id?s("div",{directives:[{name:"tooltip",rawName:"v-tooltip.enabled",value:{content:t.nameEncoded,classes:t.isModal?"m-tooltip-higher":""},expression:"{ content: nameEncoded, classes: isModal ? 'm-tooltip-higher': '' }",modifiers:{enabled:!0}}],staticClass:"g-user-realname",attrs:{"at-attr":"real_name"}},[t._v(" "+t._s(t.nameEncoded)+" ")]):t._e(),s("div",{staticClass:"g-user-username"},[t._v(" @"+t._s(t.user.username)+" ")])])]}}])})],1),s("users-action",{staticClass:"m-hover-vertical m-btn-vertical-dots m-default-hover-color m-center m-reset-gaps m-gray",attrs:{user:t.user,"subscriber-item":t.subscriber,"is-subscriber-card":""}})],1),t.authUser.isPerformer&&t.isSubscriber?s("subscriber-note",{attrs:{"user-id":t.user.id}}):t._e(),t.user.isBlocked?t._e():s("add-to-lists-btns",{attrs:{user:t.user,"need-update-swiper":t.needUpdateSwiper}}),s("div",{staticClass:"b-tabs__nav m-tab-rounded m-single-current"},[s("swiper",{directives:[{name:"swiper-mousewheel",rawName:"v-swiper-mousewheel"}],ref:"swiper",staticClass:"m-gaps-inside",attrs:{options:t.swiperOptions}},[t.user.isBlocked?s("swiper-slide",[s("button",{staticClass:"b-tabs__nav__item",attrs:{type:"button","at-attr":"unblock",disabled:t.user.disabledBlock},on:{click:function(e){return e.preventDefault(),t.confirmBlockUser("SubscribersItem")}}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-block"}),s("span",{staticClass:"b-tabs__nav__text"},[t._v(t._s(t.$t("message.unblock_user_btn_title")))])])]):[t.canReceiveChatMessage?s("swiper-slide",[t.isCurrentChatPage?s("button",{staticClass:"b-tabs__nav__item",attrs:{type:"button"},on:{click:t.clickMessageButton}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-message"}),s("span",{staticClass:"b-tabs__nav__text"},[t._v(t._s(t.$t("message.message_button")))])]):s("router-link",{staticClass:"b-tabs__nav__item",attrs:{to:{name:"Chat",params:{chatId:t.user.id}}}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-message"}),s("span",{staticClass:"b-tabs__nav__text"},[t._v(t._s(t.$t("message.message_button")))])])],1):t._e(),t.subscribedBy||t.user.isRestricted?t._e():s("swiper-slide",[s("subscribe-btn",{staticClass:"b-tabs__nav__item",attrs:{id:t.user.id,short:""}})],1),t.canGivePersonalDiscount?s("swiper-slide",[s("button",{staticClass:"b-tabs__nav__item",attrs:{type:"button"},on:{click:t.openDiscountModal}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-discount"}),s("span",{staticClass:"b-tabs__nav__text"},[t._v(t._s(t.$t("message.user_discount_btn_label_short")))])])]):t._e(),t.user.canRestrict||t.user.isRestricted?s("swiper-slide",[s("button",{staticClass:"b-tabs__nav__item",class:{dark:!t.subscriber.isMuted},attrs:{type:"button","at-attr":"restrict",disabled:t.user.disabledRestrict},on:{click:function(e){return t.muteUser("SubscribersItem")}}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-mute"}),s("span",{staticClass:"b-tabs__nav__text"},[t._v(t._s(t.muteTitle))])])]):t._e(),s("swiper-slide",[s("user-note",{attrs:{"user-id":t.user.id}})],1)]],2)],1),s("ul",{staticClass:"b-tabs__nav m-tabs-default m-flex-width m-size-sm"},[t.listSubscription.length||t.listEarnings.length?[t.listSubscription.length?s("li",{staticClass:"b-tabs__nav__item",class:{"m-current":"subscription"===t.activeTab&&t.isSubscriber}},[s("button",{staticClass:"b-tabs__nav__link m-with-rectangle-hover m-tb-sm",attrs:{type:"button",disabled:!t.isSubscriber},on:{click:function(e){return t.setActiveTab("subscription")}}},[s("span",{staticClass:"b-tabs__nav__text"},[t._v(" "+t._s(t.$t("message.subscription_title"))+" ")])])]):t._e(),s("li",{staticClass:"b-tabs__nav__item",class:{"m-current":"earnings"===t.activeTab}},[s("button",{staticClass:"b-tabs__nav__link m-with-rectangle-hover m-tb-sm",attrs:{disabled:!t.listEarnings.length,type:"button"},on:{click:function(e){return t.setActiveTab("earnings")}}},[s("span",{staticClass:"b-tabs__nav__text"},[t._v(" "+t._s(t.$t("message.earnings_title"))+" ")])])])]:t._e(),s("li",{staticClass:"b-tabs__nav__item",class:{"m-current":"offer"===t.activeTab}},[s("button",{staticClass:"b-tabs__nav__link m-with-rectangle-hover m-tb-sm",attrs:{disabled:!t.promoOffers.length&&!t.subscriber.discountPercent,type:"button"},on:{click:function(e){return t.setActiveTab("offer")}}},[s("span",{staticClass:"b-tabs__nav__text"},[t._v(" "+t._s(t.$t("message.fans_tabs_offer_label"))+" ")])])])],2),t.isChartVisible?s("subscriber-history-chart",{attrs:{"user-id":t.user.id,"offer-id":t.offerId}}):t._e(),t.list.length?s("div",{staticClass:"b-fans__item__list m-native-custom-scrollbar m-scrollbar-y m-invisible-scrollbar",class:{"m-earnings-list":"earnings"===t.activeTab}},t._l(t.list,(function(e,r){return s("div",{key:r,staticClass:"b-fans__item__list__item",class:{"m-active":t.canBeOrdered(e)&&t.currentOrderField===e.orderField,"m-item-header":e.buttons&&e.buttons.length}},[s("span",{staticClass:"b-fans__item__list__label",class:{"m-orderable":t.canBeOrdered(e)},on:{click:function(s){t.canBeOrdered(e)&&t.setOrder(e.orderField)}}},[t._v(" "+t._s(e.label)+" "),t.canBeOrdered(e)&&t.currentOrderField===e.orderField?s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],class:"icon-arrow-"+("desc"===t.currentOrderDir?"down":"up")}):t._e()]),null!==e.value?s("span",{domProps:{innerHTML:t._s(e.value)}}):t._e(),e.buttons&&e.buttons.length?s("div",{staticClass:"b-fans__item__list__btns"},t._l(e.buttons,(function(e,r){var i=e.label,a=e.click;return s("button",{key:i+"-"+r,staticClass:"g-btn m-flat m-no-uppercase m-reset-width",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),a(t)}}},[t._v(" "+t._s(i)+" ")])})),0):t._e()])})),0):t._e(),t.expanded?t._e():s("div",{staticClass:"b-btn-collapse",class:{"m-disabled":t.isToggleCardDisabled}},[s("button",{staticClass:"g-btn-link",attrs:{type:"button",disabled:t.isToggleCardDisabled},on:{click:t.toggleCard}},[t.isExpanded?[t._v(" "+t._s(t.$t("message.collapse"))+" "),s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-up"})]:[t._v(" "+t._s(t.$t("message.view_more"))+" "),s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-arrow-down"})]],2)])],1)])},i=[],a=(s("8e6e"),s("96cf"),s("3b8d")),n=(s("6762"),s("2fdb"),s("a481"),s("ac6a"),s("456d"),s("bd86")),o=(s("c5f6"),s("5a0c")),c=s.n(o),u=s("d634"),l=s("a2fa"),d=s("fa8d"),h=s("9ef2"),b=s("b48d"),m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.user&&t.user.notice?s("div",{staticClass:"container"},[s("truncated-text",{ref:"note",staticClass:"b-fans__item__note",attrs:{text:t.notice,"visible-lines":2,"collapse-limit":3}})],1):t._e()},p=[],f=s("3ac5");function _(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function v(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?_(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):_(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var g={name:"SubscriberNote",components:{TruncatedText:f["a"]},props:{userId:{type:Number,required:!0}},computed:v(v({},Object(u["tc"])(["getUser"])),{},{user:function(){return this.getUser(this.userId)},notice:function(){return((this.user||{}).notice||"").replace(/\n/g,"<br>")}})},y=g,w=(s("340a"),s("2877")),C=Object(w["a"])(y,m,p,!1,null,null,null),O=C.exports,S=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.hasUserHistoryData?s("div",{staticClass:"b-amcharts-wrapper"},[s("swiper",{directives:[{name:"swiper-mousewheel",rawName:"v-swiper-mousewheel"}],ref:"swiper",staticClass:"b-amcharts",attrs:{options:t.swiperOptions}},[s("swiper-slide",{style:{width:t.chartDivWidth}},[s("div",{attrs:{id:t.chartDivId}}),s("div",{staticClass:"stream-chart-scale"},t._l(t.monthsLabels,(function(e,r){return s("span",{key:e+"-"+r,staticClass:"stream-chart-scale__item"},[t._v(" "+t._s(e)+" ")])})),0)])],1),t.priceSvgVisible?s("div",{staticClass:"b-amcharts__clone"},[s("svg",{staticClass:"b-amcharts__clone-svg",style:{width:t.priceSvgWidth+"px",left:"-"+(t.priceSvgWidth+5)+"px"}},[s("use",{attrs:{href:"#"+t.priceSvgId}})])]):t._e()],1):t._e()},x=[],D=s("75fc"),k=(s("2439"),s("7d4b"),s("2ef0")),P=s("9df8"),j=s("4ead");function $(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function A(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?$(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var T={name:"SubscriberHistoryChart",mixins:[P["f"],j["a"]],props:{userId:{type:Number,required:!0},offerId:{type:Number,default:0}},data:function(){return{CHART:null,pixelPerMonth:90,priceSvgVisible:!1,priceSvgWidth:0}},computed:A(A({},Object(u["kc"])(["subscriptionHistory"])),{},{swiperOptions:function(){return{slidesPerView:"auto",freeMode:!0,freeModeMomentum:!1}},elementId:function(){return this.offerId||this.userId},chartDivId:function(){return"chart-fan-".concat(this.elementId)},priceSvgId:function(){return"price-axis-".concat(this.elementId)},hasUserHistory:function(){return!!this.subscriptionHistory[this.userId]},userHistory:function(){return this.subscriptionHistory[this.userId]||[]},hasUserHistoryData:function(){return!!this.userHistory.length},firstMonthStart:function(){return this.hasUserHistoryData?c()(this.userHistory[0].subscribeDate).startOf("month").format("YYYY-MM-DD"):""},lastSubscription:function(){if(this.hasUserHistoryData)return this.userHistory[this.userHistory.length-1]},isLastSubscriptionShort:function(){if(!this.hasUserHistoryData)return!1;var t=this.lastSubscription,e=t.subscribeDate,s=t.expireDate;return c()(s).diff(e,"day")<1},lastMonthEnd:function(){return this.hasUserHistoryData?c()(this.lastSubscription.expireDate).endOf("month").format("YYYY-MM-DD"):""},monthCount:function(){return this.hasUserHistoryData?c()(this.lastMonthEnd).diff(this.firstMonthStart,"month")+1:0},currentMonthPosition:function(){var t=c()().diff(this.firstMonthStart,"month");return t*this.pixelPerMonth},chartDivWidth:function(){return"max(100%, ".concat(this.monthCount*this.pixelPerMonth,"px)")},maxPrice:function(){return this.hasUserHistoryData?Math.max.apply(Math,Object(D["a"])(this.userHistory.map((function(t){var e=t.price;return e})))):0},chartMaxPrice:function(){return this.maxPrice?Math.ceil(this.maxPrice)+Math.round(.1*this.maxPrice):1},chartMinPrice:function(){return-.1*this.chartMaxPrice},priceGuides:function(){var t=this,e=Math.max(Math.ceil(this.maxPrice),1),s=e/2;return[e,s,0].map((function(e){return{above:!0,lineAlpha:0,lineThickness:0,color:"#00AFF0",value:e,label:e<=0?t.$t("message.free_placeholder"):t.priceHumanLong(e)}}))},monthsLabels:function(){if(!this.hasUserHistoryData)return[];for(var t=[],e=0;e<this.monthCount;e+=1)t.push(c()(this.firstMonthStart).add(e,"month").format("MMM, YYYY"));return 1===this.monthCount&&t.push(c()(this.firstMonthStart).format("MMM, YYYY")),t},userChartData:function(){if(!this.hasUserHistoryData)return[];var t=this.userHistory.reduce((function(t,e){var s=e.subscribeDate,r=e.expireDate,i=e.price;return[].concat(Object(D["a"])(t),[{price:i,subscribeDate:s},{price:i,subscribeDate:r,expireDate:r}])}),[]);if(this.isLastSubscriptionShort){var e=this.lastSubscription.expireDate;t[t.length-1].subscribeDate=c()(e).add(1,"day").format("YYYY-MM-DD")}return Object(D["a"])(t)},chartConfig:function(){return{type:"serial",theme:"default",addClassNames:!0,autoDisplay:!1,dataDateFormat:"YYYY-MM-DD",marginLeft:0,marginRight:0,marginTop:10,marginBottom:0,valueAxes:[{ignoreAxisWidth:!0,autoGridCount:!1,axisAlpha:0,gridAlpha:0,position:"right",maximum:this.chartMaxPrice,minimum:this.chartMinPrice,strictMinMax:!0,color:"#00AFF0",labelsEnabled:!1,guides:this.priceGuides}],categoryField:"subscribeDate",categoryAxis:{ignoreAxisWidth:!0,autoGridCount:!0,axisAlpha:0,gridAlpha:0,color:"#8A96A3",parseDates:!0,minPeriod:"hh",labelsEnabled:!1},graphs:[{type:"line",forceGap:!0,gapField:"expireDate",lineThickness:2,lineColor:"#2196F3",valueField:"price",fillAlphas:1,fillColors:["#2196F366","#2196F300"]}],zoomOutOnDataUpdate:!1,zoomOutButtonImage:"",zoomOutText:"",dataProvider:this.userChartData,listeners:[{event:"rendered",method:this.onChartRendered}]}}}),mounted:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.hasUserHistory){t.next=3;break}return t.next=3,this.fetchSubscriberHistory(this.userId);case 3:this.hasUserHistoryData&&this.buildChart();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),beforeDestroy:function(){this.CHART&&this.CHART.destroy()},methods:A(A({},Object(u["hc"])(["fetchSubscriberHistory"])),{},{buildChart:function(){this.CHART=AmCharts.makeChart(this.chartDivId,this.chartConfig)},onChartRendered:function(t){var e=t.chart;if(e){var s=e.divRealWidth;this.priceSvgWidth=s;var r=Object(k["get"])(e,"valueAxes[0].labelsSet.node");r&&(r.id=this.priceSvgId,this.priceSvgVisible=!0)}Object(k["get"])(this,"$refs.swiper.$swiper")&&this.$refs.swiper.$swiper.setTranslate(-this.currentMonthPosition)}})},E=T,M=Object(w["a"])(E,S,x,!1,null,null,null),I=M.exports,R=s("bb73"),U=s("3ef6"),F=s("41e7"),H=s("1e89"),N=s("f847"),L=s("8975");function B(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function V(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?B(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):B(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var q={name:"SubscribersItem",components:{SubscribeBtn:l["a"],UsersAction:d["a"],AddToListsBtns:h["a"],Avatar:b["a"],SubscriberNote:O,SubscriberHistoryChart:I,UserNote:R["a"],UserCustomName:U["a"]},mixins:[F["a"],H["a"],P["a"],P["f"],N["c"],j["a"]],props:{userId:{type:Number,default:function(){return null}},offerId:{type:Number,default:function(){return null}},expanded:{type:Boolean,default:!1},active:{type:[String,Boolean],default:!1},needUpdateSwiper:{type:Number,default:0},isModal:{type:Boolean,default:!1},isGrid:{type:Boolean,default:!1}},data:function(){return{activeTabProxy:null,isExpanded:this.expanded,disabledClearDiscount:!1,swiperOptions:{slidesPerView:"auto",watchOverflow:!0,spaceBetween:8,threshold:5}}},computed:V(V(V(V(V(V(V(V({},Object(u["b"])(["isAuth"])),Object(u["ic"])(["getSubscriber"])),Object(u["kc"])(["minDiscountPercent","minSubscriptionPrice"])),Object(u["mc"])(["getSubscribe"])),Object(u["U"])(["getOffer"])),Object(u["E"])(["currentDate"])),Object(u["Cb"])(["userLoginPrefix"])),{},{activeTab:{get:function(){return this.activeTabProxy||this.defaultActiveTab},set:function(t){this.activeTabProxy=t}},offer:function(){return this.getOffer(this.offerId)},user:function(){return this.getUser(this.userId||this.offer.subscriberId)},subscriber:function(){return this.getSubscriber(this.user.id)||{}},isSubscriber:function(){return this.subscriber&&!!Object.keys(this.subscriber).length},subscribe:function(){return this.getSubscribe(this.user.id)||{}},subscribedBy:function(){return this.subscribe&&(this.subscribe.renewedAt||this.subscribe.status)},canReceiveChatMessage:function(){return this.user.canReceiveChatMessage},isFree:function(){return!this.subscriber.subscribePrice},isExpired:function(){return!this.subscriber.renewedAt&&this.subscriber.expiredAt&&+new Date(this.subscriber.expiredAt)-+new Date<=0},canBeProlonged:function(){return this.isFree||this.subscriber.renewedAt},muteTitle:function(){return this.user.isRestricted?this.$t("message.user_unrestrict_button_label_"):this.$t("message.user_restrict_button_label_")},totalSumm:function(){return this.subscriber.totalSumm},canGivePersonalDiscount:function(){var t=this.authUser.subscribePrice*(100-this.minDiscountPercent)/100>=this.minSubscriptionPrice;return!this.isFree&&(this.user.canTrialSend||t)},listSubscription:function(){var t=this,e=[];return this.isSubscriber?(this.isExpired?(this.isExpanded||"expire_date"===this.currentOrderField)&&e.push({label:this.$t("message.previous_subscription_title"),value:this.priceHumanLong(this.subscriber.price),orderField:"expire_date"}):((this.isExpanded||"expire_date"===this.currentOrderField)&&e.push({label:this.$t("message.subscribers_current_subscription_title"),value:this.subscriber.price!==this.subscriber.regularPrice?this.priceHumanLong(this.subscriber.price):'<span class="subscription_price">\n                  '.concat(this.subscriber.subscribePrice!==this.subscriber.regularPrice?'<span class="b-fans__item__regular-price">-'.concat(Math.round(100*(this.subscriber.regularPrice-this.subscriber.subscribePrice)/this.subscriber.regularPrice),"%</span> ").concat(this.priceHumanLong(this.subscriber.subscribePrice)," till ").concat(this.humanDate(this.subscriber.discountFinishedAt)):this.priceHumanLong(this.subscriber.subscribePrice),"</span>"),orderField:"expire_date"}),(this.isExpanded||"new_price"===this.currentOrderField)&&this.subscriber.price!==this.subscriber.regularPrice&&e.push({label:this.$t("message.subscription_new_price_title"),value:'<span class="subscription_price">\n                  '.concat(this.subscriber.subscribePrice!==this.subscriber.regularPrice?'<span class="b-fans__item__regular-price">-'.concat(Math.round(100*(this.subscriber.regularPrice-this.subscriber.subscribePrice)/this.subscriber.regularPrice),"%</span> ").concat(this.priceHumanLong(this.subscriber.subscribePrice)," till ").concat(this.humanDate(this.subscriber.discountFinishedAt)):this.priceHumanLong(this.subscriber.subscribePrice),"</span>"),orderField:"new_price"})),(this.isExpanded||"subscribe_date"===this.currentOrderField)&&e.push({label:this.$t("message.started_date_title"),value:this.humanDate(this.subscriber.subscribeAt),orderField:"subscribe_date"}),(this.isExpanded||this.isExpired||"total_duration"===this.currentOrderField)&&e.push({label:this.$t("message.total_duration_title"),value:this.subscriber.duration||this.$tc("message.count_day_plural",1),orderField:"total_duration"}),e.push({label:this.isExpired?this.$t("message.expired_title"):this.canBeProlonged?this.$t("message.renews_title"):this.$t("message.expires_title"),value:this.humanDate(this.subscriber.expiredAt),orderField:"expires"}),this.isExpired||e.push({label:this.$t("message.rebill_title"),value:this.canBeProlonged?this.$t("message.on"):this.$t("message.off")}),!this.isExpired&&this.canBeProlonged||!this.isExpanded&&"unsubscribes_reasons.sort"!==this.currentOrderField||e.push({label:this.$t("message.subscribers_reason_title"),value:'<span class="g-gray">'.concat(this.subscriber.unsubscribeReason||this.$t("message.reason_no_reason_value"),"</span>"),orderField:"unsubscribes_reasons.sort"}),this.subscriber.recommendations&&this.isExpanded&&e.push({label:this.$t("message.referred_subscribers_title"),value:null,buttons:[{label:this.subscriber.recommendations||"0",click:function(){var e=t.$route,s=e.name,r=e.query,i=e.params,a={name:s,params:i,query:V(V({},r),{},{recommender_id:t.user.username})};t.$router.replace(a),t.$root.$emit("bv::hide::modal","ModalSubscribersItem")}}]})):e.push({label:this.$t("message.subscription_title"),value:this.$t("message.not_subscribed")}),e},listEarnings:function(){var t=[];return this.isSubscriber&&((this.isExpanded||"last_activity"===this.currentOrderField&&"desc"!==this.currentOrderDir)&&t.push({label:this.$t("message.subscribers_activity_last_title"),value:this.humanDate(this.subscriber.lastActivity),orderField:"last_activity"}),(this.isExpanded||"summ_subscribes"===this.currentOrderField)&&t.push({label:this.$t("message.subscribers_activity_subscribes_summ_title"),value:this.amountHumanLong(this.subscriber.subscribesSumm),orderField:"summ_subscribes"}),(this.isExpanded||"summ_post"===this.currentOrderField)&&t.push({label:this.$t("message.subscribers_activity_posts_summ_title"),value:this.amountHumanLong(this.subscriber.postsSumm),orderField:"summ_post"}),(this.isExpanded||"summ_chat_messages"===this.currentOrderField)&&t.push({label:this.$t("message.subscribers_activity_chats_summ_title"),value:this.amountHumanLong(this.subscriber.messagesSumm),orderField:"summ_chat_messages"}),(this.isExpanded||"summ_stream"===this.currentOrderField)&&t.push({label:this.$t("message.subscribers_activity_streams_summ_title"),value:this.amountHumanLong(this.subscriber.streamsSumm),orderField:"summ_stream"}),(this.isExpanded||"summ_tips"===this.currentOrderField)&&t.push({label:this.$t("message.subscribers_activity_tips_summ_title"),value:this.amountHumanLong(this.subscriber.tipsSumm),orderField:"summ_tips"}),t.push({label:this.$t("message.subscribers_activity_total_summ_title"),value:this.amountHumanLong(this.totalSumm),orderField:"summ_total"})),t},listOffers:function(){var t=this,e=[];return this.promoOffers.forEach((function(s){e.push(V({label:t.$t("message.freetrial_title"),value:s.finishedAt?t.humanDate(s.finishedAt):t.currentDate>+new Date(s.expiredAt)?'<span class="g-gray">'.concat(t.$t("message.expired_title"),"</span>"):null},!s.finishedAt&&t.currentDate<=+new Date(s.expiredAt)?{buttons:[{label:t.$t("message.cancel_offer"),click:function(e){e.preventDefault(),e.stopPropagation(),t.$root.$emit("personal::offer::delete",s.id,t.userId)}}]}:{})),(t.isExpanded||"create_date"===t.currentOrderField&&"desc"!==t.currentOrderDir)&&e.push({label:t.$t("message.sent_date_title"),value:t.humanDate(s.createdAt),orderField:"create_date"}),(t.isExpanded||"subscribe_days"===t.currentOrderField)&&e.push({label:t.$t("message.offer_duration_title"),value:t.subscribeDaysHuman(s.subscribeDays),orderField:"subscribe_days"}),(t.isExpanded||"expire_date"===t.currentOrderField)&&e.push({label:s.expiredAt&&t.currentDate>+new Date(s.expiredAt)?t.$t("message.expired_title"):t.$t("message.expires_title"),value:s.expiredAt?t.humanDate(s.expiredAt):t.$t("message.no_expiration_date"),orderField:"expire_date"}),e.push({label:s.finishedAt?t.$t("message.claimed_title"):t.$t("message.unclaimed_title"),value:s.finishedAt?t.humanDate(s.finishedAt):t.currentDate>+new Date(s.expiredAt)?'<span class="g-gray">'.concat(t.$t("message.expired_title"),"</span>"):null,orderField:"finish_date"})})),this.subscriber.discountPercent&&this.subscriber.discountPeriod&&this.isExpanded&&(e.push(V({label:this.$tc("message.subscription_discount_title",this.subscriber.discountPercent,{PERCENT:this.subscriber.discountPercent}),value:+new Date>+new Date(this.subscriber.discountFinishedAt)?'<span class="g-gray">'.concat(this.$t("message.expired_title"),"</span>"):null},+new Date>+new Date(this.subscriber.discountStartedAt)?{buttons:[{label:this.$t("message.cancel_button"),click:function(e){e.preventDefault(),e.stopPropagation(),t.clearDiscount()}},{label:this.$t("message.edit_button"),click:function(e){e.preventDefault(),e.stopPropagation(),t.openDiscountModal()}}]}:{})),(this.isExpanded||"create_date"===this.currentOrderField&&"desc"!==this.currentOrderDir)&&e.push({label:this.$t("message.sent_date_title"),value:this.humanDate(c()(this.subscriber.discountFinishedAt).subtract(this.subscriber.discountPeriod,"months").toISOString()),orderField:"create_date"}),(this.isExpanded||"subscribe_days"===this.currentOrderField)&&e.push({label:this.$t("message.offer_duration_title"),value:this.$tc("message.count_month_plural_new",this.subscriber.discountPeriod,{COUNT:this.subscriber.discountPeriod}),orderField:"subscribe_days"}),(this.isExpanded||"expire_date"===this.currentOrderField)&&e.push({label:this.currentDate>+new Date(this.subscriber.discountFinishedAt)?this.$t("message.expired_title"):this.$t("message.expires_title"),value:this.humanDate(this.subscriber.discountFinishedAt),orderField:"expire_date"})),e},list:function(){var t=[];return"subscription"===this.activeTab?this.listSubscription:"earnings"===this.activeTab?this.listEarnings:"offer"===this.activeTab?this.listOffers:t},promoOffers:function(){return this.offer?[this.offer]:this.user.promoOffers&&this.user.promoOffers.length?[this.user.promoOffers[0]]:[]},defaultActiveTab:function(){return this.active?this.active:"activity"===this.$route.params.type&&this.listEarnings.length?"earnings":"Promotions"===this.$route.name&&this.promoOffers.length?"offer":"subscription"},isProfile:function(){return"Profile"===this.$route.name||"ProfileInner"===this.$route.name},isBlockRestrictLoading:function(){return!(!this.user.disabledBlock&&!this.user.disabledRestrict)},isCurrentChatPage:function(){return"Chat"===this.$route.name&&this.$route.params.chatId&&this.$route.path.includes(this.user.id)},nameEncoded:function(){return Object(L["b"])(this.user.name||"")},displayNameEncoded:function(){return Object(L["b"])(this.user.displayName||this.user.name||"")},isToggleCardDisabled:function(){return"offer"===this.activeTab?!this.list.length:!this.list.length||!this.isSubscriber},isChartVisible:function(){return"subscription"===this.activeTab&&this.isExpanded}}),mounted:function(){this.$root.$on("subscribers::tab::reset",this.onSubscribersTabReset)},beforeDestroy:function(){this.$root.$off("subscribers::tab::reset",this.onSubscribersTabReset)},methods:V(V(V({},Object(u["V"])(["setModalOffer"])),Object(u["hc"])(["clearPersonalDiscount"])),{},{openDiscountModal:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.setModalUser({userId:this.user.id});case 2:this.$nextTick((function(){e.$root.$emit("bv::set::modal::promoType","discount"),e.$root.$emit("bv::show::modal","ModalPersonalOffer")}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setOrder:function(t){var e,s=t!==this.defaultOrderField?t:void 0;t===this.currentOrderField?this.currentOrderDir===this.defaultOrderDir&&(e="asc"):this.currentOrderDir!==this.defaultOrderDir&&(e="asc"),this.$router.replace({query:V(V({},this.$route.query),{},{order_field:s,order_dir:e})})},humanDate:function(t){return c()(t).format("MMM D, YYYY")},setActiveTab:function(t){var e=this;this.expandCard(),this.isGrid?this.activeTab=t:this.$nextTick((function(){e.$root.$emit("subscriberModal::setActiveTab",t)}))},openSubscriberPopup:function(){var t=this;this.setModalUser({userId:this.user.id}),this.setModalOffer(this.offerId),this.$nextTick((function(){t.$root.$emit("bv::show::modal","ModalSubscribersItem")}))},toggleCard:function(){this.isExpanded?this.resetActiveTab():this.expandCard()},expandCard:function(){this.isGrid?this.isExpanded=!0:this.openSubscriberPopup()},collapseCard:function(){this.isGrid?this.isExpanded=!1:this.$root.$emit("bv::hide::modal","ModalSubscribersItem")},resetActiveTab:function(t){this.activeTab=t||this.defaultActiveTab,this.collapseCard()},maybeOpenCard:function(t){!this.isSubscriber||this.$mq.includes("sm")||this.expanded?this.$router.push(t):this.openSubscriberPopup()},canBeOrdered:function(t){return!1},clearDiscount:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.disabledClearDiscount=!0,t.next=3,this.clearPersonalDiscount(this.user.id);case 3:this.resetActiveTab(),this.disabledClearDiscount=!1;case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),clickMessageButton:function(){this.$root.$emit("bv::hide::modal","ModalSubscribersItem")},onSubscribersTabReset:function(t){var e=t.userId,s=t.tab;e===this.userId&&this.resetActiveTab(s)}})},Y=q,W=Object(w["a"])(Y,r,i,!1,null,null,null);e["a"]=W.exports},6334:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isAuth?s("div",[s("modal-subscribers-item")],1):t._e()},i=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("96cf"),s("3b8d")),n=s("bd86"),o=s("d634"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-modal",{attrs:{id:"ModalSubscribersItem","body-class":"m-reset-body-paddings","hide-header":"",size:"lg"===t.$mq?"lg":"md",centered:"","modal-class":{"m-colored-modal":t.isExpired||t.user.isBlocked,"m-subscriber":!0}},on:{shown:t.updateSwiper,hidden:t.onHidden},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[s("button",{staticClass:"g-btn m-flat m-btn-gaps m-reset-width",attrs:{type:"button"},on:{click:t.close}},[t._v(" "+t._s(t.$t("message.close_button"))+" ")])]},proxy:!0}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("subscribers-item",{attrs:{"user-id":t.modalUser,"offer-id":t.modalOffer,expanded:"",active:t.activeTab,"need-update-swiper":t.needUpdateSwiper,"is-modal":""}})],1)},u=[],l=s("483c"),d=s("41e7");function h(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function b(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?h(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var m={name:"ModalSubscribersItem",components:{SubscribersItem:l["a"]},mixins:[d["a"]],data:function(){return{show:!1,activeTab:!1,needUpdateSwiper:0}},computed:b(b(b(b({},Object(o["tc"])(["modalUser"])),Object(o["U"])(["modalOffer"])),Object(o["ic"])(["getSubscriber"])),{},{subscriber:function(){return this.getSubscriber(this.modalUser)||{}},isExpired:function(){return!this.subscriber.renewedAt&&this.subscriber.expiredAt&&+new Date(this.subscriber.expiredAt)-+new Date<=0},user:function(){return this.getUser(this.modalUser)}}),mounted:function(){this.$root.$on("subscriberModal::setActiveTab",this.setActiveTab)},beforeDestroy:function(){this.$root.$off("subscriberModal::setActiveTab",this.setActiveTab)},methods:{close:function(){this.show=!1},setActiveTab:function(t){this.activeTab=t},updateSwiper:function(){this.needUpdateSwiper=+new Date},onHidden:function(){try{this.show||(this.activeTab=!1)}catch(t){}}}},p=m,f=s("2877"),_=Object(f["a"])(p,c,u,!1,null,null,null),v=_.exports;function g(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function y(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?g(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):g(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var w={name:"SubscriberCard",components:{ModalSubscribersItem:v},data:function(){return{offerIdToCancel:null,userIdToCancel:null,disabledDeleteOffer:!1}},computed:y(y(y(y(y({},Object(o["tc"])(["modalUser"])),Object(o["b"])(["isAuth","authUser"])),Object(o["ic"])(["getSubscriber"])),Object(o["rb"])(["route"])),{},{subscriber:function(){return this.getSubscriber(this.modalUser)}}),watch:{route:function(t){var e=t.to,s=t.from;e&&s&&e.name===s.name||this.$root.$emit("bv::hide::modal","ModalSubscribersItem"),e&&"Chat"===e.name&&e.params.chatId&&s&&"Chat"===s.name&&s.params.chatId&&this.$root.$emit("bv::hide::modal","ModalSubscribersItem")}},mounted:function(){this.$root.$on("personal::offer::delete",this.confirmCancelOffer)},beforeDestroy:function(){this.$root.$off("personal::offer::delete",this.confirmCancelOffer)},methods:y(y({},Object(o["T"])(["deleteUnclaimedOffer"])),{},{cancelOfferConfirmShow:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,window.interact(this.$t("message.cancel_offer_confirm"),{confirmText:this.$t("message.yes")});case 2:e=t.sent,e?this.cancelOffer():this.onHide();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),confirmCancelOffer:function(t,e){this.offerIdToCancel=t,this.userIdToCancel=e,this.cancelOfferConfirmShow()},cancelOffer:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.offerIdToCancel&&!this.disabledDeleteOffer){t.next=2;break}return t.abrupt("return");case 2:return e=this.offerIdToCancel,s=this.userIdToCancel,this.disabledDeleteOffer=!0,t.next=6,this.deleteUnclaimedOffer({offerId:e,userId:s});case 6:this.disabledDeleteOffer=!1,this.$root.$emit("subscribers::tab::reset",{userId:s});case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onHide:function(){this.offerIdToCancel=null,this.userIdToCancel=null}})},C=w,O=Object(f["a"])(C,r,i,!1,null,null,null);e["default"]=O.exports},"72a6":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-modal",{attrs:{id:"js-story-stats-modal","hide-footer":"",centered:"","modal-class":"story-stats","dialog-class":"story-stats-dialog","content-class":"story-stats-content","header-class":"m-border-header"},on:{hide:function(){return t.hide()}},scopedSlots:t._u([{key:"modal-header",fn:function(){return[s("button",{staticClass:"g-page__header__btn m-with-round-hover",on:{click:function(){return t.hide()}}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-back"})]),s("h4",{staticClass:"modal-title"},[t._v(" "+t._s(t.$t("message.your_story"))+" ")]),s("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.$t("message.settings_tooltip"),classes:"m-tooltip-higher"},expression:"{ content: $t('message.settings_tooltip'), classes: 'm-tooltip-higher' }"}],staticClass:"story-stats__settings",on:{click:t.goToSettings}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-settings",attrs:{"extra-class":"m-aligned-top"}})])]},proxy:!0}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("div",{staticClass:"modal-body"},[t.stories.items?s("div",{staticClass:"stories-list-preview"},[s("swiper",{key:"viewerModalView",ref:"swiper",staticClass:"m-slide-width-auto",attrs:{options:t.swiperOptions},on:{transitionEnd:t.transitionEnd,imagesReady:t.imagesReady}},t._l(t.stories.items,(function(e,r){return s("swiper-slide",{key:r},[s("div",{staticClass:"story-preview story-preview_viewers"},[e.question?s("div",{staticClass:"b-answer-placeholder"},[s("div",{staticClass:"b-answer-placeholder__avatar"},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-user"})]),s("div",{staticClass:"b-answer-placeholder__form"})]):t._e(),s("img",{staticClass:"story-preview__img",attrs:{src:e.loadingBg,width:t.getGalleryImageWidth(e),height:t.galleryImageHeight+"px",alt:""},on:{contextmenu:function(t){return t.preventDefault(),function(){return!1}()},dragstart:function(t){return t.preventDefault(),function(){return!1}()}}})])])})),1)],1):t._e(),s("div",{staticClass:"stories-stats-data"},[s("div",{staticClass:"b-tabs-switchers"},[s("ul",{staticClass:"b-tabs__nav m-tabs-marks m-size-md"},[s("li",{staticClass:"b-tabs__nav__item",class:{"m-current":"details"===t.tab}},[s("button",{staticClass:"b-tabs__nav__link m-with-rectangle-hover",on:{click:function(e){t.tab="details"}}},[s("span",{staticClass:"b-tabs__nav__text"},[t._v(" "+t._s(t.$t("message.title_details"))+" ")])])]),s("li",{staticClass:"b-tabs__nav__item",class:{"m-current":"viewers"===t.tab}},[s("button",{staticClass:"b-tabs__nav__link m-with-rectangle-hover",on:{click:function(e){t.tab="viewers"}}},[s("span",{staticClass:"b-tabs__nav__text"},[t._v(" "+t._s(t.$t("message.streaming_summary_viewers_title"))+" ")])])]),t.storyAnswers.length?s("li",{staticClass:"b-tabs__nav__item",class:{"m-active":"responses"===t.tab}},[s("button",{staticClass:"b-tabs__nav__link m-with-rectangle-hover",on:{click:function(e){t.tab="responses"}}},[s("span",{staticClass:"b-tabs__nav__text"},[t._v(" "+t._s(t.$t("message.streaming_summary_responses_title"))+" ")])])]):t._e()])]),"details"!==t.tab||t.currentStoryStat?t._e():s("div",{staticClass:"spinner-container"},[s("spinner-loader")],1),"viewers"===t.tab&&!t.storyViewers.length&&t.storyViewersLoading?s("div",{staticClass:"spinner-container"},[s("spinner-loader")],1):t._e(),t.currentStoryStat?s("div",{directives:[{name:"show",rawName:"v-show",value:"details"===t.tab,expression:"tab === 'details'"}],staticClass:"b-tab-stats"},[s("div",{staticStyle:{width:"100%",height:"144px"},attrs:{id:"chart"}}),s("div",{staticClass:"stream-chart-scale m-no-border"},t._l(t.arr,(function(e,r){return s("span",{key:e+r,staticClass:"stream-chart-scale__item"},[t._v(t._s(e))])})),0),s("div",{staticClass:"b-stats-row__content"},[s("div",{staticClass:"b-stats-row__label m-border-line m-tips",class:{"m-current":"look"===t.currentClickedRow},on:{click:function(e){t.currentClickedRow="look"}}},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_viewers_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.currentStoryStat.storyLookCount)+" ")])]),s("div",{staticClass:"b-stats-row__label m-border-line m-posts",class:{"m-current":"like"===t.currentClickedRow},on:{click:function(e){t.currentClickedRow="like"}}},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_likes_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.currentStoryStat.storyLikeCount)+" ")])]),s("div",{staticClass:"b-stats-row__label m-border-line m-messages",class:{"m-current":"tip"===t.currentClickedRow},on:{click:function(e){t.currentClickedRow="tip"}}},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_tips_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" $"+t._s(t.currentStoryStat.storyTipSum)+" "),t.currentStoryStat.storyTipCount?s("span",[t._v("("+t._s(t.currentStoryStat.storyTipCount)+")")]):t._e()])]),void 0!==t.currentStoryStat.storyPurchasedSumm&&void 0!==t.currentStoryStat.storyPurchasedCount?[s("div",{staticClass:"b-stats-row__label m-border-line m-purchases"},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_purchases_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" $"+t._s(t.currentStoryStat.storyPurchasedSumm)+" "),t.currentStoryStat.storyPurchasedCount?s("span",[t._v("("+t._s(t.currentStoryStat.storyPurchasedCount)+")")]):t._e()])])]:t._e(),s("div",{staticClass:"b-stats-row__label m-border-line m-referrals",class:{"m-current":"comment"===t.currentClickedRow},on:{click:function(e){t.currentClickedRow="comment"}}},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_comments_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.currentStoryStat.storyCommentCount)+" ")])])],2)]):t._e(),s("div",{directives:[{name:"show",rawName:"v-show",value:"viewers"===t.tab,expression:"tab === 'viewers'"}],staticClass:"b-tab-stats"},[s("div",{staticClass:"list-viewers m-native-custom-scrollbar m-scrollbar-y",on:{scroll:t.reachEnd}},t._l(t.storyViewers,(function(e){return s("Viewer",{key:e,attrs:{viewer:e,"go-to-profile":t.goToProfile}})})),1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"responses"===t.tab,expression:"tab === 'responses'"}],staticClass:"b-tab-stats"},[s("answer-modal",{attrs:{"close-story":function(){return t.close(!0)}}}),s("div",{staticClass:"list-story-answers m-native-custom-scrollbar m-scrollbar-y",on:{scroll:t.answersReachEnd}},[t._l(t.storyAnswers,(function(e){return s("answer",{key:e.id,attrs:{answer:Object.assign({},e,{question:t.questionText}),"story-id":t.currStoryId,"close-story":function(){return t.close(!0)}}})})),t.storyAnswersLoading?s("div",{staticClass:"b-posts_preloader_container show_more_container"},[s("spinner-loader")],1):t._e()],2)],1)])])])},i=[],a=s("e650"),n=a["a"],o=s("2877"),c=Object(o["a"])(n,r,i,!1,null,null,null);e["default"]=c.exports},bb73:function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.hasNote?s("div",[s("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.noteTooltip,expression:"noteTooltip"}],class:{"b-tabs__nav__item":t.isButtonType,"g-btn m-flat m-reset-width m-no-uppercase m-default-font-weight m-gray":!t.isButtonType},attrs:{type:"button"},on:{click:t.openNoteModal}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-notes"}),t.isButtonType?s("span",{staticClass:"b-tabs__nav__text"},[t._v(" "+t._s(t.noteText)+" ")]):t._e()])]):t._e()},i=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("96cf"),s("3b8d")),n=s("bd86"),o=(s("c5f6"),s("d634"));function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var l={name:"UserNote",props:{userId:{type:[String,Number],required:!0},type:{type:String,default:"button"}},computed:u(u(u({},Object(o["b"])(["authUser"])),Object(o["tc"])(["getUser"])),{},{noteText:function(){return this.userWithNote.notice?this.$t("message.edit_notes"):this.$t("message.add_notes")},noteTooltip:function(){return this.isButtonType?"":this.noteText},hasNote:function(){return this.authUser.isPerformer&&this.isUserWithNoteSubscriber},isButtonType:function(){return"button"===this.type},isUserWithNoteSubscriber:function(){return this.userWithNote.subscribedOn||this.userWithNote.subscribedOnExpiredNow},userWithNote:function(){return this.getUser(this.userId)||{}}}),methods:u(u({},Object(o["yc"])(["setModalUser"])),{},{openNoteModal:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.setModalUser({userId:this.userWithNote.id});case 2:this.$nextTick((function(){e.$root.$emit("bv::show::modal","ModalSubscriberNotes")}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()})},d=l,h=s("2877"),b=Object(h["a"])(d,r,i,!1,null,null,null);e["a"]=b.exports},cb8e:function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-modal",{attrs:{id:"js-story-answer-modal","hide-footer":"",centered:"","modal-class":"story-answer-modal","dialog-class":"story-answer-modal-dialog","content-class":"story-answer-modal-content","header-class":"m-border-header","body-class":1===t.state?"m-reset-body-padding-bottom":"",size:"sm"},on:{hide:t.close},scopedSlots:t._u([{key:"modal-header",fn:function(){return[1===t.state?s("button",{staticClass:"g-page__header__btn m-with-round-hover",on:{click:function(e){t.state=0}}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-back"})]):t._e(),s("h4",{staticClass:"modal-title"},[t._v(" "+t._s(t.$t("message.username_response",{USERNAME:t.user.username}))+" ")]),s("button",{staticClass:"b-modal__close m-with-round-hover",attrs:{type:"button"},on:{click:t.close}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close",attrs:{"extra-class":"m-aligned-top"}})])]},proxy:!0}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[1===t.state?s("form",{staticClass:"b-story-questionnaire__form",attrs:{action:"#"}},[s("div",{staticClass:"b-story-questionnaire__field"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"b-story-questionnaire__input",attrs:{placeholder:"write something..."},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}})]),s("div",{staticClass:"b-story-questionnaire__submit-field"},[s("button",{staticClass:"b-story-questionnaire__submit-btn",attrs:{type:"button"},on:{click:t.sendAnswerResponseTrottled}},[t._v(" "+t._s(t.$t("message.send_button"))+" ")])])]):t._e(),0===t.state?[s("div",{staticClass:"b-choose-answer",domProps:{textContent:t._s(t.answerText)}}),s("div",{staticClass:"b-choose-story-answer"},[s("div",{staticClass:"b-choose-story-answer__item",class:{"m-disabled":t.isAuthUser},on:{click:function(e){t.state=1}}},[s("avatar",{attrs:{"user-id":t.user.id,"is-link":!1,size:50,"hide-online":"","disable-story-functionality":""}}),t._v(" "+t._s(t.$t("message.label_message"))+" "+t._s(t.user.username)+" ")],1),s("add-story-btn",{attrs:{answer:t.answer,user:t.user}}),s("div",{staticClass:"b-choose-story-answer__item m-remove",on:{click:t.deleteAnswer}},[s("div",{staticClass:"b-choose-story-answer__round"},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-delete"})]),t._v(" "+t._s(t.$t("message.delete"))+" ")])],1)]:t._e()],2)},i=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("96cf"),s("3b8d")),n=s("bd86"),o=s("2ef0"),c=s("d634"),u=s("b48d"),l=s("f9e8");function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function h(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){Object(n["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var b={name:"StoryAnswerModal",components:{Avatar:u["a"],AddStoryBtn:l["a"]},props:{closeStory:{type:Function,required:!0}},data:function(){return{show:!1,answer:null,state:0,message:""}},computed:h(h(h({},Object(c["tc"])(["getUser"])),Object(c["b"])(["authUser"])),{},{isAuthUser:function(){return this.authUser.id===this.user.id},user:function(){return this.answer?this.getUser(this.answer.userId):{}},answerText:function(){return this.answer?this.answer.text:""},sendAnswerResponseTrottled:function(){return Object(o["throttle"])(this.sendAnswerResponse,1e3)}}),mounted:function(){var t=this;this.$root.$on("component::story::answerModel::show",(function(e){t.answer=e,t.show=!0,t.state=0,t.message=""}))},methods:h(h({},Object(c["Qb"])(["deleteStoryAnswer","comment"])),{},{close:function(){this.show=!1},deleteAnswer:function(){this.deleteStoryAnswer(this.answer.id),this.close()},sendAnswerResponse:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,s,r,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.comment({id:this.answer.storyId,userId:this.answer.userId,text:this.message});case 2:e=t.sent,e&&(s=this.$createElement("span",{},this.$t("message.your_answer_has_been_sent")),r=this.$createElement("button",{class:"g-btn m-rounded m-sm m-toast-btn",on:{click:function(){i.closeStory(),i.$router.push({name:"Chat",params:{chatId:i.answer.userId}})}}},this.$t("message.view")),this.$bvToast.toast([s,r],{autoHideDelay:3e3,appendToast:!0,toaster:"b-toaster-bottom-left"}),this.message="",this.close());case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()})},m=b,p=s("2877"),f=Object(p["a"])(m,r,i,!1,null,null,null);e["a"]=f.exports},e650:function(t,e,s){"use strict";(function(t){s("8e6e"),s("456d"),s("ac6a");var r=s("75fc"),i=(s("7514"),s("bd86")),a=s("2ef0"),n=s("5a0c"),o=s.n(n),c=s("d772"),u=s.n(c),l=(s("2439"),s("7d4b"),s("d634")),d=s("e528"),h=s("243b5"),b=s("f1dd"),m=s("cb8e"),p=s("0b88"),f=s("4ead"),_=s("fcd9");function v(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function g(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?v(Object(s),!0).forEach((function(e){Object(i["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):v(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}o.a.extend(u.a),e["a"]={name:"StoryStat",components:{SpinnerLoader:d["a"],Viewer:h["a"],AnswerModal:m["a"],Answer:p["a"]},mixins:[f["a"]],props:{ev:{type:Object,required:!0}},data:function(){return{currentClickedRow:"look",stories:[],show:!1,currIndex:0,timer:0,arr:[],timeout:null,tab:"details",initialSlide:0,galleryImageHeight:130}},computed:g(g(g(g({},Object(l["tc"])(["user"])),Object(l["Tb"])(["storyAnswers","storyAnswersLoading","storyAnswersHasMore"])),Object(l["Rb"])(["currentStoryStat","storyViewers","storyViewersLoading","storyViewersLoaded"])),{},{swiperOptions:function(){return{slidesPerView:"auto",spaceBetween:10,centeredSlides:!0,slideToClickedSlide:!0,slideActiveClass:"active",grabCursor:!0,initialSlide:this.initialSlide}},swiper:function(){return this.$refs.swiper.$swiper},current:function(){return Object(a["get"])(this,["stories","items",this.currIndex])},questionText:function(){return Object(a["get"])(this,["stories","items",this.currIndex,"question","entity","text"])},dur:function(){if(this.currentStoryStat){var t=this.currentStoryStat.hasVideo?this.currentStoryStat.videoPlayDuration:this.currentStoryStat.lookDuration;return o.a.duration(t/1e3,"seconds").format(_["a"].getDurationFormat(t/1e3))}return 0},durAv:function(){if(this.currentStoryStat){var t=this.currentStoryStat.hasVideo?this.currentStoryStat.videoPlayDurationAverage:this.currentStoryStat.lookDurationAverage;return o.a.duration(t/1e3,"seconds").format(_["a"].getDurationFormat(t/1e3))}return 0},currStoryId:function(){return this.stories.items&&this.stories.items[this.currIndex]?this.stories.items[this.currIndex].id:void 0},chartSettings:function(){var t=this,e=b["a"].graphs,s=e.filter((function(e){return e.valueField!==t.currentClickedRow})),i=e.find((function(e){return e.valueField===t.currentClickedRow}));return g(g({},b["a"]),{},{graphs:[].concat(Object(r["a"])(s),[g(g({},i),{},{lineThickness:3,lineAlpha:1})])})}}),watch:{currentClickedRow:function(){this.buildChart()},currStoryId:function(){var t=this;this.currStoryId&&(this.tab="details",this.destroy(),this.resetStoryViewers(),this.resetStoryAnswers(),this.fetchStoryStat(this.currStoryId),this.fetchStoryViewers({storyId:this.currStoryId}),this.fetchStoryAnswers({storyId:this.currStoryId}).then((function(){"responses"===t.ev.param&&(t.tab=t.ev.param)})))},currentStoryStat:function(){var t=this;this.currentStoryStat&&(this.arr=[],this.setParams(),this.chartScaleUnits(),setTimeout((function(){t.buildChart()}),100))},"storyAnswers.length":function(t,e){!t&&e&&(this.tab="details")}},mounted:function(){this.stories=this.ev.stories,this.currIndex=this.ev.initialSlide,this.initialSlide=this.ev.initialSlide,this.show=!0,this.$root.$on("story::creation::upload::start",this.close)},beforeDestroy:function(){this.destroy()},methods:g(g({},Object(l["Qb"])(["fetchStoryStat","resetStat","fetchStoryViewers","resetStoryViewers","fetchStoryAnswers","resetStoryAnswers"])),{},{getGalleryImageWidth:function(t){return"".concat(t.originalMediaWidth/t.originalMediaHeight*this.galleryImageHeight,"px")},setParams:function(){var t="sm"===this.$mq?2:4;this.start=new Date(this.currentStoryStat.createdAt).getTime(),this.end=Date.now(),this.duration=this.end-this.start,this.format=this.duration<86400?"hh:mm a":"DD MMM hh:mm a",this.barCount=this.duration/1e3<47?this.duration/1e3:47,this.scale=this.duration<t?this.duration:t,this.streamScaleUnit=this.duration/this.scale,this.streamUnitTime=this.duration/this.barCount},hide:function(t){var e=this;this.show=!1,this.$nextTick((function(){e.$root.$emit("hide::story::stat",{isCloseStory:t})}))},buildChart:function(){var e=this;this.CHART=t.AmCharts.makeChart("chart",this.chartSettings),this.CHART.dataProvider=[];for(var s=0;s<this.barCount;s+=1)this.CHART.dataProvider.push({date:Math.round(this.start+s*this.streamUnitTime),look:0,like:0,tip:0,comment:0});this.timeout=setTimeout((function(){e.prepareData("Comment"),e.prepareData("Like"),e.prepareData("Look"),e.prepareData("Tip"),e.CHART.validateData()}),1e3)},prepareData:function(t){var e=this,s="story".concat(t,"All"),r=this.currentStoryStat?this.currentStoryStat[s]:[],i={};r.forEach((function(t){for(var s=new Date(t).getTime(),r=0,a=0,n=0;n<e.barCount;n+=1){var o=Math.abs(e.CHART.dataProvider[n].date-s);(0===n||r>o)&&(r=o,a=n)}i[a]=(i[a]||0)+1})),Object.keys(i).forEach((function(s){e.CHART.dataProvider[s][t.toLowerCase()]=i[s]})),this.CHART.dataProvider.forEach((function(s,r){r>0&&(e.CHART.dataProvider[r][t.toLowerCase()]+=e.CHART.dataProvider[r-1][t.toLowerCase()])}))},chartScaleUnits:function(){for(var t=0;t<=this.scale;t+=1){var e=o()(this.start+Math.round(t*this.streamScaleUnit)).format(this.format);this.arr=[].concat(Object(r["a"])(this.arr),[e])}},destroy:function(){var t=document.getElementById("chart");clearTimeout(this.timeout),this.CHART&&(t&&(t.innerHTML=""),this.CHART.destroy()),this.resetStat(),this.resetStoryViewers()},reachEnd:function(t){var e=t.srcElement,s=e.scrollHeight,r=e.scrollTop,i=e.offsetHeight,a=s-(i+r)<50;!a||this.storyViewersLoading||this.storyViewersLoaded||this.fetchStoryViewers({storyId:this.currStoryId,offset:this.storyViewers.length})},answersReachEnd:function(t){var e=t.srcElement,s=e.scrollHeight,r=e.scrollTop,i=e.offsetHeight,a=s-(i+r)<50;a&&!this.storyAnswersLoading&&this.storyAnswersHasMore&&this.fetchStoryAnswers({storyId:this.currStoryId})},close:function(t){this.destroy(),this.hide(t)},goToSettings:function(){this.$router.push({name:"SettingsStory"}),this.close(!0)},goToProfile:function(t){this.$router.push({name:"Profile",params:{userId:t}}),this.close(!0)},transitionEnd:function(){this.currIndex=this.swiper.activeIndex},imagesReady:function(){var t=this;this.$nextTick((function(){t.swiper&&(t.swiper.slideTo(t.currIndex),setTimeout((function(){window.dispatchEvent(new Event("resize"))}),5))}))}})}}).call(this,s("c8ba"))},f1dd:function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));var r={type:"serial",categoryField:"date",theme:"default",fontFamily:"Open Sans",color:"#7c8b96",autoDisplay:!1,autoMargins:!1,marginBottom:0,marginTop:0,marginLeft:0,marginRight:0,categoryAxis:{labelsEnabled:!1,axisColor:"#fff",axisAlpha:.2,startOnAxis:!0,gridAlpha:0,tickLength:0},valueAxes:[{labelsEnabled:!1,axisThickness:0,dashLength:6,tickLength:0,gridAlpha:.1,gridColor:"#7c8b96",zeroGridAlpha:0,autoGridCount:!1,gridCount:4}],graphs:[{animationPlayed:!0,fillAlphas:0,lineColor:"#00bcd4",fillColors:["#00bcd4","rgba(0,0,0,0)"],type:"smoothedLine",valueField:"look",lineThickness:1.5,lineAlpha:.5},{animationPlayed:!0,fillAlphas:0,lineColor:"#ff7043",fillColors:["#ff7043","rgba(0,0,0,0)"],type:"smoothedLine",valueField:"tip",lineThickness:1.5,lineAlpha:.5},{animationPlayed:!0,fillAlphas:0,lineColor:"#9575cd",fillColors:["#9575cd","rgba(0,0,0,0)"],type:"smoothedLine",valueField:"comment",lineThickness:1.5,lineAlpha:.5},{animationPlayed:!0,fillAlphas:0,lineColor:"#ec407a",type:"smoothedLine",fillColors:["#ec407a","rgba(0,0,0,0)"],valueField:"like",lineThickness:1.5,lineAlpha:.5}],dataProvider:[]}},f702:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-modal",{ref:"PostStatModal",attrs:{id:"PostStatModal_"+t.postId,"hide-footer":"",centered:"","header-class":"m-border-header",size:"lg"},scopedSlots:t._u([{key:"modal-header",fn:function(){return[s("h4",{staticClass:"modal-title"},[t._v(" "+t._s(t.$t("message.post_stat_modal_title"))+" ")]),s("button",{staticClass:"b-modal__close m-with-round-hover",on:{click:t.close}},[s("svg",{directives:[{name:"svg-sprite",rawName:"v-svg-sprite"}],staticClass:"icon-close",attrs:{"extra-class":"m-aligned-top"}})])]},proxy:!0}]),model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.statsData.loading?s("spinner-loader"):t.statsData.error?s("div",[t._v(" "+t._s(t.statsData.error)+" ")]):t.statsData.isAvailable?t.statsData.hasStats?[s("div",{staticStyle:{"margin-bottom":"15px","font-size":"15px"}},[t._v(" Some statistics may be delayed or approximated ")]),s("div",{staticStyle:{width:"100%",height:"150px"},attrs:{id:"chart"}}),s("div",{staticClass:"stream-chart-scale m-no-border"},t._l(t.arr,(function(e,r){return s("span",{key:r,staticClass:"stream-chart-scale__item"},[t._v(" "+t._s(e)+" ")])})),0),s("div",{staticClass:"b-stats-row__content"},[void 0!==t.statsData.purchasedSumm&&void 0!==t.statsData.purchasedCount?[s("div",{staticClass:"b-stats-row__label m-border-line m-purchases"},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_post_purchases_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.statsData.purchasedSumm.toLocaleString("en-US",{style:"currency",currency:"USD"}))+" "),t.statsData.purchasedCount?s("span",[t._v("("+t._s(t.statsData.purchasedCount)+")")]):t._e()])])]:t._e(),s("div",{staticClass:"b-stats-row__label m-border-line m-viewers m-pointer",class:{"m-current":"look"===t.currentClickedRow},on:{click:function(e){t.currentClickedRow="look"}}},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_views_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.statsData.hasVideo?t.statsData.videoPlayCount:t.statsData.lookCount)+" ")])]),s("div",{staticClass:"b-stats-row__label m-border-line m-viewers"},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_unique-viewers_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.statsData.uniqueLookCount)+" ")])]),s("div",{staticClass:"b-stats-row__label m-border-line m-likes m-pointer",class:{"m-current":"like"===t.currentClickedRow},on:{click:function(e){t.currentClickedRow="like"}}},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_likes_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.statsData.likeCount)+" ")])]),s("div",{staticClass:"b-stats-row__label m-border-line m-comments m-pointer",class:{"m-current":"comment"===t.currentClickedRow},on:{click:function(e){t.currentClickedRow="comment"}}},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_comments_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.statsData.commentCount)+" ")])]),s("div",{staticClass:"b-stats-row__label m-border-line m-tips m-pointer",class:{"m-current":"tip"===t.currentClickedRow},on:{click:function(e){t.currentClickedRow="tip"}}},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_tips_title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.statsData.tipSum.toLocaleString("en-US",{style:"currency",currency:"USD"}))+" "),t.statsData.tipCount?s("span",[t._v("("+t._s(t.statsData.tipCount)+")")]):t._e()])]),s("div",{staticClass:"b-stats-row__label m-border-line m-duration"},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_duration__title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.dur)+" ")])]),s("div",{staticClass:"b-stats-row__label m-border-line m-duration"},[s("span",{staticClass:"b-stats-row__name m-dots"},[t._v(" "+t._s(t.$t("message.streaming_summary_avarage_duration__title"))+" ")]),s("span",{staticClass:"b-stats-row__val"},[t._v(" "+t._s(t.durAv)+" ")])])],2)]:s("div",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("message.post_stat_no_stats"))+" ")]):s("div",{staticClass:"text-center"},[t._v(" "+t._s(t.$t("message.post_stat_unavailable"))+" ")])],2)},i=[],a=(s("8e6e"),s("456d"),s("768b")),n=(s("ac6a"),s("ffc1"),s("6762"),s("2fdb"),s("75fc")),o=(s("7514"),s("bd86")),c=(s("c5f6"),s("d634")),u=(s("2439"),s("7d4b"),s("5a0c")),l=s.n(u),d=s("d772"),h=s.n(d),b=s("e528"),m=s("fcd9");function p(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function f(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?p(Object(s),!0).forEach((function(e){Object(o["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}l.a.extend(h.a);var _={type:"serial",categoryField:"date",theme:"default",fontFamily:"Open Sans",color:"#7c8b96",autoDisplay:!1,autoMargins:!1,marginBottom:0,marginTop:0,marginLeft:0,marginRight:0,categoryAxis:{labelsEnabled:!1,axisColor:"#fff",axisAlpha:.2,startOnAxis:!0,gridAlpha:0,tickLength:0},valueAxes:[{labelsEnabled:!1,axisThickness:0,dashLength:6,tickLength:0,gridAlpha:.1,gridColor:"#7c8b96",zeroGridAlpha:0,autoGridCount:!1,gridCount:4}],graphs:[{animationPlayed:!0,fillAlphas:0,lineColor:"#ffa000",type:"smoothedLine",fillColors:["#ffa000","rgba(0,0,0,0)"],valueField:"like",lineThickness:1.5,lineAlpha:.5},{animationPlayed:!0,fillAlphas:0,lineColor:"#ec407a",fillColors:["#ec407a","rgba(0,0,0,0)"],type:"smoothedLine",valueField:"look",lineThickness:1.5,lineAlpha:.5},{animationPlayed:!0,fillAlphas:0,lineColor:"#00bcd4",fillColors:["#00bcd4","rgba(0,0,0,0)"],type:"smoothedLine",valueField:"tip",lineThickness:1.5,lineAlpha:.5},{animationPlayed:!0,fillAlphas:0,lineColor:"#7cb342",fillColors:["#7cb342","rgba(0,0,0,0)"],type:"smoothedLine",valueField:"comment",lineThickness:1.5,lineAlpha:.5}],dataProvider:[]},v={name:"PostStatModal",components:{SpinnerLoader:b["a"]},props:{postId:{type:Number,required:!0},startTime:{required:!0,type:String},statsData:{required:!0,type:Object},modalShow:{type:Boolean,default:!1}},data:function(){return{timer:0,arr:[],timeout:null,currentClickedRow:"look"}},computed:f(f({},Object(c["tc"])(["modalUser","getUser"])),{},{show:{get:function(){return this.modalShow},set:function(t){this.$emit("update:modalShow",t)}},user:function(){return this.getUser(this.modalUser)},chartSettings:function(){var t=this,e=_.graphs,s=e.filter((function(e){return e.valueField!==t.currentClickedRow})),r=e.find((function(e){return e.valueField===t.currentClickedRow}));return f(f({},_),{},{graphs:[].concat(Object(n["a"])(s),[f(f({},r),{},{lineThickness:3,lineAlpha:1})])})},dur:function(){if(this.statsData){var t=this.statsData.hasVideo?this.statsData.videoPlayDuration:this.statsData.lookDuration;return l.a.duration(t/1e3,"seconds").format(m["a"].getDurationFormat(t/1e3))}return 0},durAv:function(){if(this.statsData){var t=this.statsData.hasVideo?this.statsData.videoPlayDurationAverage:this.statsData.lookDurationAverage;return l.a.duration(t/1e3,"seconds").format(m["a"].getDurationFormat(t/1e3))}return 0}}),watch:{currentClickedRow:function(){this.buildChart()},statsData:function(){var t=this;this.show&&this.statsData.hasStats&&this.statsData.isAvailable&&setTimeout((function(){t.buildChart()}))},show:function(){var t=this;this.show&&this.statsData.hasStats&&this.statsData.isAvailable&&setTimeout((function(){t.buildChart()}))}},mounted:function(){this.setParams(),this.chartScaleUnits()},beforeDestroy:function(){clearTimeout(this.timeout),this.CHART&&this.CHART.destroy()},methods:{close:function(){this.show=!1},setParams:function(){var t=this.$mq.includes("sm")?2:4;this.start=new Date(this.startTime).getTime(),this.end=Date.now(),this.duration=this.end-this.start,this.format=this.duration<86400?"hh:mm a":"DD MMM",this.barCount=this.duration/1e3<47?this.duration/1e3:47,this.scale=this.duration<t?this.duration:t,this.streamScaleUnit=this.duration/this.scale,this.streamUnitTime=this.duration/this.barCount},buildChart:function(){this.CHART=window.AmCharts.makeChart("chart",this.chartSettings),this.CHART.dataProvider=[];for(var t=0;t<this.barCount;t+=1)this.CHART.dataProvider.push({date:Math.round(this.start+t*this.streamUnitTime),look:0,like:0,tip:0,comment:0});this.renderCharts()},renderCharts:function(){this.prepareData("comment"),this.prepareData("like"),this.prepareData("look"),this.prepareData("tip"),this.CHART.validateData()},prepareData:function(t){var e=this,s="".concat(t,"All"),r=this.statsData[s];if(r){for(var i={},n=0,o=Object.entries(r);n<o.length;n++){for(var c=Object(a["a"])(o[n],2),u=c[0],l=c[1],d=new Date(u).getTime(),h=0,b=0,m=0;m<this.barCount;m+=1){var p=Math.abs(this.CHART.dataProvider[m].date-d);(0===m||h>p)&&(h=p,b=m)}i[b]=(i[b]||0)+l}for(var f in i)this.CHART.dataProvider[f]&&(this.CHART.dataProvider[f][t]=i[f]);this.CHART.dataProvider.forEach((function(s,r){r>0&&(e.CHART.dataProvider[r][t]+=e.CHART.dataProvider[r-1][t])}))}},chartScaleUnits:function(){for(var t=0;t<=this.scale;t+=1){var e=l()(this.start+Math.round(t*this.streamScaleUnit)).format(this.format);this.arr=[].concat(Object(n["a"])(this.arr),[e])}}}},g=v,y=s("2877"),w=Object(y["a"])(g,r,i,!1,null,null,null);e["default"]=w.exports}}]);